# 狭义相对论

## 洛伦兹变换

设某个事件在 $K$ 系下的坐标和时间为 $x,y,z,t$，在 $K'$ 系下的坐标和时间为 $x',y',z',t'$

设 $K'$ 惯性系和 $K$ 惯性系坐标轴指向一致，$K'$ 系相对 $K$ 系以 $\vec{v}=v\vec{e}_x $ 运动，且当 $t=0$ 且 $t'=0$ 时刻两坐标轴的原点重合，则这个事件在 $K$ 系和 $K'$ 系之间的变换关系为：

$$
\left\{
\begin{aligned}
&x'
=\frac{x-vt}{\sqrt{1-\frac{v^2}{c^2}}} \\
&y'
=y \\
&z'
=z \\
&t'
=\frac{t-\frac{v}{c^2}x}{\sqrt{1-\frac{v^2}{c^2}}}
\end{aligned}
\right.
$$

## 质量、能量、动量和动量

静质量：$m_0$

设粒子的速度为 $v$，动质量 $m$：

$$
m
=\frac{m_0}{\sqrt{1-\frac{v^2}{c^2}}}
$$

总能量 $E$：

$$
E
=mc^2
$$

动量 $p$：

$$
\vec{p}
=m\vec{v}
$$

动能 $E_k$：

$$
E_k
=E-E_0
=mc^2-m_0c^2
$$

相对论能量-动量关系：

$$
\left\{
\begin{aligned}
&E
=mc^2 \\
&\vec{p}=m\vec{v}
\end{aligned}
\Longrightarrow
E^2-(pc)^2
=(m_0c^2)^2
\right.
$$

# 第1章 牛顿矢量力学

## 质点力学

三维直角坐标系中定义的物理量

$$
\Delta\vec{r}
=\vec{r}_{\rm{final}}-\vec{r}_{\rm{init}}
$$

$$
\vec{v}(t)
=\lim_{\Delta t\to 0}\frac{\vec{r}(t+\Delta t)-\vec{r}(t)}{\Delta t}
=\frac{\mathrm{d}\vec{r}(t)}{\mathrm{d}t}
=\dot{\vec{r}}(t)
$$

$$
\vec{a}(t)
=\lim_{\Delta t\to 0}
\frac{\vec{v}(t+\Delta t)-\vec{v}(t)}{\Delta t}
=\dot{\vec{v}}(t)
$$

平面直角坐标系中定义的物理量的二维极坐标表达

$$
\vec{r}
=r\hat{\theta}
$$

$$
\vec{v}
=\dot{r}\hat{r}+r\dot{\theta}\hat{\theta}
$$

$$
\vec{a}
=(\ddot{r}-r\dot{\theta}^2)\hat{r}+(r\ddot{\theta}+2\dot{r}\dot{\theta})\hat{\theta}
$$

证明：

$$
\hat{r}
=\cos\theta\vec{i}+\sin\theta\vec{j}
$$

$$
\hat{\theta}
=-\sin\theta\vec{i}+\cos\theta\vec{j}
$$

$$
\frac{\mathrm{d}\hat{r}}{\mathrm{d}t}
=(-\sin\theta\vec{i}+\cos\theta\vec{j})\dot{\theta}
=\dot{\theta}\hat{\theta}
$$

$$
\frac{\mathrm{d}\hat{\theta}}{\mathrm{d}t}
=(-\cos\theta\vec{i}-\sin\vec{j})\dot{\theta}
=-\dot{\theta}\hat{r}
$$

显然，

$$
\vec{r}
=r\hat{r}
$$

$$
\vec{v}
=\frac{\mathrm{d}\vec{r}}{\mathrm{d}t}
=\frac{\mathrm{d}(r\hat{r})}{\mathrm{d}t}
=\dot{r}\hat{r}+r\frac{\mathrm{d}\hat{r}}{\mathrm{d}t}
=\dot{r}\hat{r}+r\dot{\theta}\hat{\theta}
$$

$$
\begin{aligned}
\vec{a}
=\frac{\mathrm{d}\vec{v}}{\mathrm{d}t}
=\frac{\mathrm{d}(\dot{r}\hat{r}+r\dot{\theta}\hat{\theta})}{\mathrm{d}t}
&=\ddot{r}\hat{r}+\dot{r}\frac{\mathrm{d}\hat{r}}{\mathrm{d}t}+\dot{r}\dot{\theta}\hat{\theta}+r\ddot{\theta}\hat{\theta}+r\dot{\theta}\frac{\mathrm{d}\hat{\theta}}{\mathrm{d}t} \\
&=\ddot{r}\hat{r}+\dot{r}(\dot{\theta}\hat{\theta})+\dot{r}\dot{\theta}\hat{\theta}+r\ddot{\theta}\hat{\theta}+r\dot{\theta}(-\dot{\theta}\hat{r}) \\
&=(\ddot{r}-r\dot{\theta}^2)\hat{r}+(r\ddot{\theta}+2\dot{r}\dot{\theta})\hat{\theta}
\end{aligned}
$$

例1.2

自然坐标系：沿质点的运动轨迹建立的运动坐标系

运动方程：

$$
s
=s(t)
$$

速度的自然坐标表达：

$$
\vec{v}
=\lim_{\Delta t\to 0}\frac{\Delta \vec{r}}{\Delta t}
=\lim_{\Delta t\to 0}\frac{\Delta s}{\Delta t}\cdot\frac{\Delta \vec{r}}{\Delta s}
=\lim_{\Delta t\to 0}\frac{\Delta s}{\Delta t}\cdot\lim_{\Delta t\to 0}\frac{\Delta\vec{r}}{\Delta s}
=\dot{s}\hat{\tau}
$$

由几何关系：

$$
\frac{\mathrm{d}\hat{\tau}}{\mathrm{d}t}
=\lim_{\Delta t\to 0}\frac{\hat{\tau}(t+\Delta t)-\hat{\tau}(t)}{\Delta t}
=\lim_{\Delta t\to 0}\frac{\frac{\Delta s}{\rho}\cdot 1 \cdot \hat{n}}{\Delta t}
=\frac{1}{\rho}\dot{s}\hat{n}
$$

加速度的自然坐标表达：

$$
\vec{a}
=\frac{\mathrm{d}\vec{r}}{\mathrm{d}t}
=\frac{\mathrm{d}(\dot{s}\hat{\tau})}{\mathrm{d}t}
=\ddot{s}\hat{\tau}+\dot{s}\frac{\mathrm{d}\hat{\tau}}{\mathrm{d}t}
=\ddot{s}\hat{\tau}+\frac{\dot{s}^2}{\rho}\hat{n}
$$

答案：$v=e^{ct}\sqrt{b^2+c^2},a=$

动量：

$$
\vec{p}
=m\vec{v}
$$

冲量：

$$
\vec{I}
=\int\vec{F}\cdot\mathrm{d}t
$$

动量定理：

$$
\mathrm{d}\vec{p}
=\vec{F}\mathrm{d}t \\
\vec{p}_2-\vec{p}_1
=\int\vec{F}\mathrm{d}t
=\vec{I}
$$


动量守恒定律：若 $\vec{F}=0$，则 $\vec{p}=\rm{constant}$，动量守恒

力矩：

$$
\vec{M}
=\vec{r}\times\vec{F}
$$

角动量：

$$
\vec{J}
=\vec{r}\times\vec{p}
$$

角动量定理：

$$
\frac{\mathrm{d}\vec{J}}{\mathrm{d}t}
=\vec{M}
$$

证明：

$$
\begin{aligned}
\frac{\mathrm{d}\vec{J}}{\mathrm{d}t}
&=\frac{\mathrm{d}(\vec{r}\times\vec{p})}{\mathrm{d}t}
=\vec{v}\times\vec{p}+\vec{r}\times\frac{\mathrm{d}\vec{p}}{\mathrm{d}t}
=\vec{r}\times\frac{\mathrm{d}(m\vec{v})}{\mathrm{d}t}
=\vec{r}\times\vec{F} \\
&=\vec{M}
\end{aligned}
$$

角动量守恒定理：若 $\vec{M}=0$，则 $\vec{J}=\rm{constant}$，角动量守恒

功：

$$
W
=\int\limits_{(l)}\vec{F}\cdot\mathrm{d}\vec{r}
$$

功率：

$$
P
=\frac{\mathrm{d}W}{\mathrm{d}t}
=\vec{F}\cdot\vec{v}
$$

动能：

$$
T
=\frac{1}{2}mv^2
$$

动能定理：

$$
T-T_0
=\int\limits_{(l)}\vec{F}\cdot\mathrm{d}\vec{r} \\
\frac{1}{2}mv^2-\frac{1}{2}mv_0^2
=\int\limits_{(l)}\vec{F}\cdot\mathrm{d}\vec{r}
$$

证明：

保守力：

$$
\vec{F}
=-\nabla V(\vec{r})
$$

保守力做功（参数化方法）：

设有向曲线 $l$ 的参数化方程为：$\begin{cases}x=x(t) \\ y=y(t) \\ z=z(t) \end{cases},t:a\to b $

设 $V=V_1(\vec{r})=V_2(t)$

$$
\begin{aligned}
W
&=\int\limits_{(l)}\vec{F}\cdot\mathrm{d}\vec{r} \\
&=\int\limits_{(l)}-\nabla V_1(\vec{r})\cdot\mathrm{d}\vec{r} \\
&=-\int\limits_{(l)}(\frac{\partial V}{\partial x},\frac{\partial V}{\partial y},\frac{\partial V}{\partial z})\cdot\mathrm{d}\vec{r} \\
(链式法则)&=-\int_{t=a}^{t=b}(\frac{\mathrm{d}V}{\mathrm{d}t}\frac{\mathrm{d} t}{\mathrm{d} x},\frac{\mathrm{d}V}{\mathrm{d}t}\frac{\mathrm{d} t}{\mathrm{d} y},\frac{\mathrm{d}V}{\mathrm{d}t}\frac{\mathrm{d} t}{\mathrm{d} z})\cdot(\frac{\mathrm{d}x}{\mathrm{d}t},\frac{\mathrm{d}y}{\mathrm{d}t},\frac{\mathrm{d}z}{\mathrm{d}t})\mathrm{d}t \\
&=-\int_{t=a}^{t=b} V_2'(t)\mathrm{d}t \\
&=-V_2(t)\bigg|_{t=a}^{t=b} \\
&=V_2(t)\bigg|_{t=a}-V_2(t)\bigg|_{t=b} \\
&=V_1(\vec{r})\bigg|_{A}-V_1(\vec{r})\bigg|_{B} \\
&=V_1(\vec{r}_A)-V_1(\vec{r}_B)
\end{aligned}
$$

上面的推导说明，保守力做功与路径无关

保守力情况下的动能定理：

$$
T_1+V_1=T_2+V_2 \\
\frac{1}{2}m_0v_0^2+V(x_0,y_0,z_0)=\frac{1}{2}mv^2+V(x,y,z)
$$

$\vec{F}$ 是保守力 $\Longleftrightarrow$ $\nabla\times\vec{F}=\vec{0}$

证明：

机械能守恒定律：保守力作用下的力学体系机械能守恒

非保守力：做功与路径有关的力

耗散力：总做负功而消耗能量的力

## 质点系力学

质点系：许多相互联系着的质点所组成的系统

内力：质点系中质点的相互作用力

外力：质点系以外的物体对质点系内任意质点的作用力

质心：一个假想点，这个点集中了质点系中所有质点的质量

质点系质心的质量，记作 $m_c$，定义为：

$$
m_c
=\sum\limits_{i}m_i
$$

质点系质心的位矢，记作 $\vec{r}_c$，定义为：

$$
\vec{r}_c
=\frac{\sum\limits_{i}m_i\vec{r}_i}{\sum\limits_{i} m_i}
=\frac{\sum\limits_{i}m_i\vec{r}_i}{m_c}
$$

质点系质心的速度，记作 $\vec{v}_c$，定义为：

$$
\vec{v}_c
=\frac{\mathrm{d}\vec{r}_c}{\mathrm{d}t}
=\frac{\sum\limits_{i}m_i\vec{v}_i}{M}
$$

质点系质心的动量，记作 $\vec{p}_c$，定义为：

$$
\vec{p}_c
=m_c\vec{v}_c
=\sum\limits_{i}m_i\vec{v}_i
$$

质点系质心的加速度，记作 $\vec{a}_c$，定义为：

$$
\vec{a}_c
=\frac{\mathrm{d}\vec{v}_c}{\mathrm{d}t}
=\frac{\sum\limits_{i}m_i\vec{a}_i}{m_c}
$$

质点系的动量定理：

$\vec{F}_i^{(e)}$：第 $i$ 个质点受到的外力

$\vec{F}_{ji} $：第 $j$ 个质点对第 $i$ 个质点的作用力，为方便说明，规定 $\vec{F}_{ii}=0$

$\vec{F}_i^{(i)}=\sum\limits_{\substack{j}}\vec{F}_{ji}$：第 $i$ 个质点受到的内力

对第 $i$ 个质点，有：

$$
m_i\frac{\mathrm{d}^2 \vec{r}_i}{\mathrm{d}t^2}
=\vec{F}_{i}^{(e)}+\sum\limits_{j}\vec{F}_{ji}
$$

所有质点都有如上的方程，把所有的方程相加得：

$$
\sum\limits_{i} m_i\frac{\mathrm{d}^2 \vec{r}_i}{\mathrm{d}t^2}
=\sum\limits_{i}\bigg(\vec{F}_{i}^{(e)}+\sum\limits_{j}\vec{F}_{ji}\bigg)
=\sum\limits_{i}\vec{F}_i^{(e)}+\sum\limits_{i}\sum\limits_{j}\vec{F}_{ji} \tag{1}
$$

注意到：

$$\sum\limits_{i} m_i\frac{\mathrm{d}^2 \vec{r}_i}{\mathrm{d}t^2}
=\sum\limits_{i} m_i\frac{\mathrm{d}v_i}{\mathrm{d}t}
=\sum\limits_{i} \frac{\mathrm{d}(m_i\vec{v}_i)}{\mathrm{d}t}
=\frac{\mathrm{d}}{\mathrm{d}t}\sum\limits_{i}m_i\vec{v}_i
\equiv \frac{\mathrm{d}\vec{p}}{\mathrm{d}t}
$$

其中，质点系的总动量，记为 $\vec{p}$，定义为：$\vec{p}=\sum\limits_{i}m_i\vec{v}_i$. 显然，$\vec{p}=\vec{p}_c$

又注意到，由牛顿第三定律，$\vec{F}_{ji}+\vec{F}_{ij}=0$，于是 $\sum\limits_{i}\sum\limits_{j}\vec{F}_{ij}$ 等于如下矩阵所有元素的代数和：

$$
\begin{bmatrix}
\vec{F}_{11} &\vec{F}_{21} &\vec{F}_{31} &\cdots \\
\vec{F}_{12} &\vec{F}_{22} &\vec{F}_{32} &\cdots \\
\vec{F}_{31} &\vec{F}_{32} &\vec{F}_{33} &\cdots \\
\vdots &\vdots &\vdots &\ddots
\end{bmatrix}
$$

于是显然有 $\vec{F}_{ji}+\vec{F}_{ij}=0$，于是 $\sum\limits_{i}\sum\limits_{j}\vec{F}_{ij}=0$

把注意到的两条等式代回（1） 得到：

$$
\frac{\mathrm{d}\vec{p}}{\mathrm{d}t}
=\sum\limits_{i}\vec{F}_{i}^{(e)}
$$

这就是质点系的动量定理

质心运动定理：质点系的运动就像一个质点的运动，这个质点就是质点系的质心，这个质点的质量，即质心的质量等于质点系所有质点的质量和；这个质点的受力，即质心的受力，等于作用在质点系所有质点的外力的矢量和

质点系的动量守恒定律：若质点系不受外力或所受合外力为零，则由质点系的动量定理可得：$\vec{p}=\rm{const}$，而 $\vec{p}=\vec{p}_c,\vec{p}_c=m_c\vec{v}c,$ 于是 $\vec{v}_c=\rm{const}$

质点系的角动量定理：

$$
\frac{\mathrm{d}\vec{J}}{\mathrm{d}t}
=\vec{M}
$$

质点系的角动量守恒定律：若作用在质点系的外力对某一固定点的合力矩为零，即 $\vec{M}=0$，则 $\vec{J}=\rm{const}$

# 狭义相对论

假设1：所有惯性系平权，任何物理定律在所有惯性系得数学表达式都有相同的形式

假设2：真空中的光速沿任何方向、对任何惯性系都是一个常数 $c$，与光源的运动情况无关

#### 洛伦兹变换

设两个参考系 $K,K'$ 满足最简关联，即满足：

（1）以 $K,K'$ 为原点建立起的两个三维直角坐标系的各坐标轴同向平行

（2）$K'$ 系相对 $K$ 以速率 $v$ 沿 $x$ 轴正方向匀速平动

（3）在 $t=t'=0$ 时，两系空间坐标原点重合

则有洛伦兹变换：

$$
\left\{
\begin{aligned}
&t'
=\gamma(t-\frac{v}{c^2}x) \\
&x'
=\gamma(x-vt) \\
&y'
=y \\
&z'
=z
\end{aligned}
\right. 
,~~
\gamma
=\frac{1}{\sqrt{1-\frac{v^2}{c^2}}}
$$

# 第2章 拉格朗日分析力学

## 基本概念

### 约束以及约束的一些分类

约束（Constraint）：对系统运动的限制。

完全约束（Holonomic Constraints）：形式上可表达为 $f(\vec{r}_1,\vec{r}_2,\cdots,t)=0$ 的约束。

非完全约束（Nonholonomic Constraints）：不可表示为质点坐标和时间方程的约束。

定常约束（Scleronomic Constraints）：约束方程不含时间 $t $ 的完全约束。形式上可表达为 $f(\vec{r}_1,\vec{r}_2,\cdots,\vec{r}_n)=0.$

时变约束（Rheonomic Constraints）：约束方程含时间 $t $ 的完全约束。形式上可表达为 $f(\vec{r}_1,\vec{r}_2,\cdots,\vec{r}_n)=0.$

### 自由度

自由度（Degrees of Freedom）：能完全描述一个力学体系所需要的**独立变量**的个数。

### 广义坐标

设三维空间中的一个质点组由 $N$ 个质点组成。若不存在约束，需要 $3N $ 个独立的变量来描述质点组中各质点的位置，因此系统有 $3N $ 个自由度；若存在 $k$ 个完全约束（由 $k $ 条约束方程表达），则只需要 $s=3N-k$ 个独立的变量来描述质点组中各质点的位置，因此系统剩下 $3N-k $ 个自由度。

一般地，对于 $N $ 个质点组成，且有 $s$ 个自由度的体系，可选择 $s$ 个独立的变量来描述质点组中各个质点的位置，选取的这 $s$ 个独立的变量称为**广义坐标**（Generalized Coordinates）。

由于体系的自由度为 $s $，则可选取一组独立的广义坐标 $q_1,q_2,\cdots,q_s $ 用于描述体系中各质点的位置。对于质点 $i,i=1,2,\cdots,N $，其位置由位矢 $\vec{r}_i $ 描述。因此，$\vec{r}_i $ 应当表达为 $q_1,q_2,\cdots q_s $ 的函数，即形式上有：

$$
\vec{r}_i
=\vec{r}_i(q_1,q_2,\cdots,q_s),\quad i=1,2,\cdots,N
$$



## 达朗贝尔原理和拉格朗日方程

### 基本概念

实位移：质点在 $t\sim t+\mathrm{d}t$ 从 $\vec{r}$ 时间内从 $\vec{r} $ 运动到 $\vec{r}+\mathrm{d}\vec{r}.$ 质点实际运动产生的位移 $\mathrm{d}\vec{r} $ 称为实位移。

虚位移：质点在约束下可能发生的微小位移 $\delta \vec{r}$ 称为虚位移。

虚功：$\delta W=\vec{F}\cdot\delta{\vec{r}}.$

力的分类：主动力 $\vec{F}^{(A)}$ 和约束力 $\vec{F}^{(C)}.$

理想约束：$\displaystyle{\sum\limits_{i} \vec{F}_i^{(C)}\cdot\delta\vec{r}_i=0 }.$ 

虚功原理：受理想约束的力学体系平衡的充要条件是此力学体系的所有**主动力**在任何虚位移中所做的元功**之和**等于零，即 $\delta W=\sum\limits_{i}\vec{F}_i^{(A)}\cdot\delta\vec{r}_i=0.$

## 从虚功原理出发推导受理想约束的力学体系平衡的充要条件

考虑 $N $ 个质点组成的受理想约束的力学系统，设系统的自由度为 $s .$

设所有广义坐标 $\{q_\alpha\}$ 都有一个微小虚变动 $\{\delta q_\alpha\} $，则所有质点的位矢 $\{\vec{r}_i \}$ 也产生一个相应的虚位移 $\{\delta\vec{r}_i \}$：

$$
\delta\vec{r}_i
=\sum\limits_{\alpha=1}^{s} \frac{\partial \vec{r}_i}{\partial  q_\alpha}\delta q_\alpha,\quad
s=1,2,\cdots N
$$

于是可以计算由虚位移导致的虚功 $\delta W $（系统受理想约束，由理想约束的定义，约束力贡献的元功之和为零）：

$$
\begin{aligned}
\delta W
&=\sum_{i=1}^{N} \vec{F}_i\cdot \delta\vec{r}_i \\
&=\sum_{i=1}^{N} \left(\vec{F}_i^{(A)} + \vec{F}_i^{(C)} \right)\cdot \delta\vec{r}_i \\
&=\sum_{i=1}^{N} \vec{F}_i^{(A)}\cdot\delta\vec{r}_i + \sum_{i=1}^{N} \vec{F}_i^{(C)}\cdot\delta\vec{r}_i \\
&=\sum_{i=1}^{N} \vec{F}_i^{(A)}\cdot\delta\vec{r}_i \\
&=\sum_{i=1}^{N} \vec{F}_i^{(A)}\cdot \left(\sum_{\alpha=1}^{s}\frac{\partial \vec{r}_i }{\partial a_\alpha } \delta q_\alpha \right) \\
&=\sum\limits_{i=1}^{N} \sum\limits_{\alpha=1}^{s} \vec{F}_{i}^{(A)}\cdot\frac{\partial \vec{r}_i}{\partial q_\alpha}\delta q_\alpha \\
&=\sum\limits_{\alpha=1}^{s}\sum\limits_{i=1}^{N}  \vec{F}_{i}^{(A)}\cdot\frac{\partial \vec{r}_i}{\partial q_\alpha}\delta q_\alpha \\
&=\sum\limits_{\alpha=1}^{s}\left(\sum\limits_{i=1}^{N}  \vec{F}_{i}^{(A)}\cdot\frac{\partial \vec{r}_i}{\partial q_\alpha} \right)\delta q_\alpha \\
&\equiv\sum\limits_{\alpha=1}^{s} Q_{\alpha}\delta q_{\alpha}
\end{aligned}
$$

上面定义了**广义力**：

$$
Q_{\alpha}
\equiv\sum\limits_{i=1}^{N} \vec{F}_{i}^{(A)}\cdot\frac{\partial \vec{r}_i}{\partial q_{\alpha}}
$$

由虚功原理，受理想约束的力学体系平衡的充要条件是此力学体系的所有**主动力**在任何虚位移中所做的元功**之和**等于零，即有：

$$
\delta W = 0
$$

因此有：

$$
\sum\limits_{\alpha=1}^{s} Q_{\alpha}\delta q_{\alpha}
=0
$$

由于 $\delta q_\alpha $ 独立，上面求和为零，当且仅当：

$$
Q_{\alpha}
=0,\quad \alpha=1,2,\cdots,s
$$

这就是说，受理想约束的力学体系平衡的充要条件是此力学体系的所有广义力均为零。

## 从牛顿力学出发推导达朗贝尔原理

由牛二：

$$
\vec{F}_{i}^{(A)}+\vec{F}_{i}^{(C)}-m_i\ddot{\vec{r}_i}
=0
$$

于是：

$$
(\vec{F}_{i}^{(A)}+\vec{F}_{i}^{(C)}-m_i\ddot{\vec{r}_i})\cdot\delta \vec{r}_i
=0
$$

求和：

$$
\sum\limits_{i}(\vec{F}_{i}^{(A)}+\vec{F}_{i}^{(C)}-m_i\ddot{\vec{r}_i})\cdot \delta \vec{r}_i
=0
$$

若为理想约束，则由虚功原理可得：

$$
\sum\limits_{i}(\vec{F}_{i}^{(A)}-m_i\ddot{\vec{r}_i})\cdot\delta \vec{r}_i \tag{1}
=0
$$

分开看：

对于第一项，之前我们已经得到：

$$
\sum\limits_{i}\vec{F}_i^{(A)}\cdot\delta\vec{r}_i
=\sum\limits_{\alpha}Q_{\alpha}\delta q_{\alpha}
$$

其中，$Q_{\alpha}=\sum\limits_{i}\vec{F}_{i}^{(A)}\cdot\frac{\partial \vec{r}_{i}}{\partial q_{\alpha}} $

对于第二项，注意到：

$$
\vec{r}_{i}
=\vec{r}_i(q_1,q_2,\cdots,t)
$$

于是：

$$
\dot{\vec{r}}_i
=\frac{\partial \vec{r}_i}{\partial t} +\sum\limits_{\alpha} \frac{\partial \vec{r}_i}{\partial q_\alpha}\dot{q}_\alpha
$$

于是：

$$
\frac{\partial \dot{\vec{r}_i}}{\partial \dot{q}_\alpha}
=\frac{\partial \vec{r}_i}{\partial q_\alpha}
$$

还要注意到：

$$
(uv)'=u'v+uv'
$$

于是：

$$
u'v
=(uv)'-uv'
$$

于是第二项可以化为:

$$
\begin{aligned}
\sum\limits_{i} m_i\ddot{\vec{r}}_i\cdot\delta\vec{r}_i
&=\sum\limits_{i} m_i\ddot{\vec{r}}_i\cdot \sum\limits_{\alpha} \frac{\partial \vec{r}_i}{\partial q_\alpha} \delta q_\alpha \\
&=\sum\limits_{i}\sum\limits_{\alpha} m_i\ddot{\vec{r}}_i\cdot\frac{\partial \vec{r}_i}{\partial q_\alpha}\delta q_\alpha \\
&=\sum\limits_{\alpha}\sum\limits_{i} m_i\ddot{\vec{r}}_i\cdot\frac{\partial \vec{r}_i}{\partial q_\alpha}\delta q_\alpha \\
&=\sum\limits_{\alpha}\sum\limits_{i} m_i\ddot{\vec{r}}_i\cdot\frac{\partial\dot{\vec{r}}_i}{\partial \dot{q}_\alpha}\delta q_\alpha \\
&=\sum\limits_{\alpha} \delta q_\alpha \sum\limits_{i} m_i\frac{\mathrm{d}\dot{\vec{r}}_i}{\mathrm{d}t}\cdot\frac{\partial \dot{\vec{r}}_i}{\partial \dot{q}_\alpha} \\
&=\sum\limits_{\alpha} \delta q_\alpha \sum\limits_{i} \bigg[\frac{\mathrm{d}}{\mathrm{d}t}(m_i\dot{\vec{r}}_i\cdot\frac{\partial \dot{\vec{r}}_i}{\partial \dot{q}_\alpha})-m_i\dot{\vec{r}}_i\cdot\frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial \dot{\vec{r}}_i}{\partial \dot{q}_\alpha}\bigg] \\
&=\sum\limits_{\alpha} \delta q_{\alpha} \sum\limits_{i} \bigg[\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial (\frac{1}{2}m_i \dot{\vec{r}}_i^2) }{\partial \dot{q}_\alpha}-m_i\dot{\vec{r}}_i\cdot\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial \vec{r}_i}{\partial q_\alpha}\bigg] \\
&=\sum\limits_{\alpha} \delta q_\alpha \sum\limits_{i} \bigg[\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial (\frac{1}{2}m_i \dot{\vec{r}}_i^2) }{\partial \dot{q}_\alpha} -m_i\dot{\vec{r}}_i\cdot\frac{\partial \dot{\vec{r}}_i}{\partial q_\alpha}\bigg] \\
&=\sum\limits_{\alpha} \delta q_\alpha \sum\limits_{i} \bigg[\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial (\frac{1}{2}m_i \dot{\vec{r}}_i^2) }{\partial \dot{q}_\alpha} -\frac{\partial (\frac{1}{2}m_i\dot{\vec{r}}_i^2)}{\partial q_\alpha}\bigg] \\
&=\sum\limits_{\alpha} (\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial T}{\partial \dot{q}_\alpha}-\frac{\partial T}{\partial q_\alpha})\delta q_\alpha
\end{aligned}
$$

终于，把两项都代回（1） 得：

$$
\sum\limits_{\alpha} Q_\alpha\delta q_\alpha-\sum\limits_{\alpha} (\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial T}{\partial \dot{q}_\alpha}-\frac{\partial T}{\partial q_\alpha})\delta q_\alpha
=0
$$

即：

$$
\sum\limits_{\alpha} (\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial T}{\partial \dot{q}_\alpha}-\frac{\partial T}{\partial q_\alpha}-Q_\alpha)\delta q_\alpha=0
$$

由于 $q_\alpha$ 不独立，于是：

$$
\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial T}{\partial \dot{q}_\alpha}-\frac{\partial T}{\partial q_\alpha}-Q_\alpha
=0
$$

即：

$$
\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial T}{\partial \dot{q}_\alpha}-\frac{\partial T}{\partial q_\alpha}
=Q_\alpha
$$

保守约束系统的动力学方程：

$$
\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial (T-V)}{\partial \dot{q}_\alpha}-\frac{\partial (T-V)}{\partial q_\alpha}
=0
$$

令 $L=T-V$，$L$ 称为拉格朗日量

$$
p_\alpha
\equiv \frac{\partial L}{\partial \dot{q}_\alpha}
$$

$p_\alpha$ 称为广义动量

例子：

1.单摆

达朗贝尔方程分析：

选取 $\theta$ 为广义坐标

$$
\vec{r}
=l\sin\theta\vec{i}+l\cos\theta\vec{j}
$$

$$
\dot{\vec{r}}
=l\dot{\theta}(\cos\theta\vec{i}-\sin\theta\vec{j})
$$

$$
T
=\frac{1}{2}m\dot{\vec{r}}^2
=\frac{1}{2}ml^2\dot{\theta}^2
$$

$$
Q_\theta
=(mg\vec{j})\cdot\frac{\partial\vec{r}}{\partial \theta}
=(mg\vec{j})\cdot l(\cos\theta\vec{i}-\sin\theta\vec{j})
=-mgl\sin\theta
$$

$$
\frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial (\frac{1}{2}ml^2\dot{\theta}^2)}{}
$$

E-L 方程分析：

$$
T
=\frac{1}{2}ml^2\dot{\theta}^2
$$

$$
V
=-mg l\cos\theta
$$

$$
L
=T-V
=\frac{1}{2}ml^2\dot{\theta}^2+mg l\cos\theta
$$

$$
\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial(\frac{1}{2}ml^2\dot{\theta}^2+mg l\cos\theta)}{\partial\dot{\theta}}-\frac{\partial(\frac{1}{2}ml^2\dot{\theta}^2+mg l\cos\theta)}{\partial \theta}
=0
$$

$$
\ddot{\theta}
=-\frac{g}{l}\sin\theta
$$


2.斜面滑块

循环坐标：若拉格朗日量中不含某个广义坐标，则这个广义坐标称为循环变量（存在守恒量，即这个广义坐标对应的广义动量）

$$
E
=T+V
=p_\alpha \dot{q}_\alpha-L
$$

设体系的 $L=L(q(t),\dot{q}(t),t)$，其对时间的导数：

$$
\begin{aligned}
\frac{\mathrm{d}L}{\mathrm{d}t}
&=\frac{\mathrm{d}}{\mathrm{d}t}(\frac{\partial L}{\partial \dot{q}_\alpha}\dot{q}_\alpha)+\frac{\partial L}{\partial t} \\
\end{aligned}
$$

若体系的 $L$ 不显含时间 $t$，定义系统的能量：

$$
H
\equiv \frac{\partial L}{\partial \dot{q}_\alpha}\dot{q}_\alpha-L
$$

则：

$$
\frac{\mathrm{d}H}{\mathrm{d}t}
=0
\Longrightarrow
H=\rm{const}
$$

时间的均匀性导致能量守恒

时间的均匀性意味着 $L$ 不显含时间，即 $\frac{\partial L}{\partial t}=0 $，上面讨论给出此时系统的能量 $H=\rm{const}$，即系统能量不随时间变化

空间的均匀性导致动量守恒

设 $N$ 个质点的所有坐标都有一个无穷小位移 $\delta \vec{r}_i=\vec{\varepsilon}$，选取三维直角坐标作为第 $i$ 个粒子的广义坐标，变分的知识给出：

$$
\begin{aligned}
\delta L
&=\sum_{i=1}^{N}\frac{\partial L}{\partial \vec{r}_i}\cdot\delta \vec{r}_i \\
&=\vec{\varepsilon}\cdot\sum_{i=1}^{N}\frac{\partial L}{\partial \vec{r}_i}
\end{aligned}
$$

空间均匀性要求对于任意 $\vec{\varepsilon}$，都有 $\delta L=0$，故：

$$
\sum_{i=1}^{N}\frac{\partial L}{\partial \vec{r}_i}
=\vec{0} \tag{1}
$$

单个质点的运动应满足欧拉-拉格朗日方程：

$$
\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{\partial \dot{\vec{r}}_i}-\frac{\partial L}{\partial \vec{r}_i}
=\vec{0}
$$

于是$(1)$ 可化为：

$$
\frac{\mathrm{d}}{\mathrm{d}t}\sum_{i=1}^{N}\frac{\partial L}{\partial \dot{\vec{r}}_i}
=0
$$

注意到，选取各质点的三维直角坐标为广义坐标，对应的广义动量其实就是动量，即：

$$
\frac{\partial L}{\partial \dot{\vec{r}}_i}
=\vec{p}_i
$$

整个体系的总动量就是：

$$

$$

空间的各向同性性导致角动量守恒

设系统围绕固定轴做一无穷小旋转 $\delta\vec{\phi}$，旋转造成体系组成的位移 $\delta\vec{r}_i=\delta\vec{\phi}\times\vec{r}_i$，因此引起的拉格朗日量的变化为（选取三维直角坐标为广义坐标）：

$$
\begin{aligned}
\delta L
&=\sum_{i=1}^{N}\bigg[ \frac{\partial L}{\partial \vec{r}_i}\cdot\delta\vec{r}_i+\frac{\partial L}{\partial \dot{\vec{r}}}_i\cdot\dot{\vec{r}}_i \bigg] \\
&=\sum_{i=1}^{N}\bigg[ \frac{\partial L}{\partial \vec{r}_i}\cdot(\delta\vec{\phi}\times\vec{r}_i)+\frac{\partial L}{\partial \dot{\vec{r}}_i}\cdot(\delta\vec{\phi}\times\dot{\vec{r}}_i) \bigg] \\
&=\delta\vec{\phi}\cdot\sum_{i=1}^{N}\bigg[ \vec{r}_i\times\frac{\partial L}{\partial \vec{r}_i}+\dot{\vec{r}}_i\times\frac{\partial L}{\partial\dot{\vec{r}}_i} \bigg] \\
&=\delta\vec{\phi}\cdot\sum_{i=1}^{N}\bigg[ \vec{r}_i\times\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{\partial \dot{\vec{r}}_i}+ \frac{\mathrm{d}\vec{r}_i}{\mathrm{d}t}\times\frac{\partial L}{\partial \dot{\vec{r}}_i} \bigg] \\
&=\delta\vec{\phi}\cdot\sum_{i=1}^{N}\frac{\mathrm{d}}{\mathrm{d}t}\bigg[ \vec{r}_i\times\frac{\partial L}{\partial \dot{\vec{r}}_i} \bigg] \\
&=\delta\vec{\phi}\cdot\frac{\mathrm{d}}{\mathrm{d}t}\sum_{i=1}^{N}\bigg[ \vec{r}_i\times\frac{\partial L}{\partial \dot{\vec{r}}_i} \bigg] \\
&=\delta\vec{\phi}\cdot\frac{\mathrm{d}}{\mathrm{d}t}\sum_{i=1}^{N}\bigg[ \vec{r}_i\times \vec{p}_i \bigg] \\
\end{aligned}
$$

空间各向同性要求对任意 $\delta\vec{\phi}$ 都有 $\delta L=0$，于是系统的总角动量：

$$
\vec{J}
=\sum_{i=1}^{N}[\vec{r}_i\times\vec{p}_i]
=\rm{const}
$$

即系统的总角动量守恒

#### 位力定理

称 $f(\vec{x})$ 为 $k$ 次齐次函数，若 $f(\alpha\vec{x})=\alpha^kf(\vec{x})$

注意到：

$$
\frac{\partial f(\alpha\vec{x})}{\partial\alpha}
=\vec{x}\cdot\frac{\mathrm{d}f(\alpha\vec{x})}{\mathrm{d}(\alpha\vec{x})}
$$

若 $f(\vec{x})$ 为 $k$ 次齐函数，则有：

$$
\begin{aligned}
\frac{\partial f(\alpha\vec{x})}{\partial\alpha} 
&=\frac{\partial(\alpha^kf(\vec{x}))}{\partial\alpha} \\
&=k\alpha^{k-1}f(\vec{x})
\end{aligned}
$$

比较两式，得：

$$
\vec{x}\cdot\frac{\mathrm{d}f(\alpha\vec{x})}{\mathrm{d}(\alpha\vec{x})}
=k\alpha^{k-1}f(\vec{x})
$$

令 $\alpha=1$，得：

$$
\vec{x}\cdot\frac{\mathrm{d}f(\vec{x})}{\mathrm{d}\vec{x}}
=kf(\vec{x})
$$

推导位力定理：

注意到：

$$
\vec{v}\cdot\frac{\partial T}{\partial \vec{v}}
=2T,
\frac{\partial T}{\partial\vec{v}}
=\vec{p}
$$

于是：

$$
2T
=\vec{v}\cdot\vec{p}
=\frac{\mathrm{d}\vec{x}}{\mathrm{d}t}\cdot\vec{p}
=\frac{\mathrm{d}}{\mathrm{d}t}(\vec{x}\cdot\vec{p})-\vec{x}\cdot\dot{\vec{p}}
$$

等式两边同时取对时间的平均：

$$
<2T> 
=\frac{1}{\Delta t}\int (\frac{\mathrm{d}}{\mathrm{d}t}(\vec{x}\cdot\vec{p})-\vec{x}\cdot\dot{\vec{p}}) \mathrm{d}t
$$

假设系统的运动有限，不会出现 $\vec{x}\cdot\vec{p}$ 趋于 $\infty$ 的情况，关注 $\Delta \to +\infty$ 的极限：

$$
\lim_{\Delta t\to +\infty}<2T>
=\lim_{\Delta t\to +\infty}\frac{1}{\Delta t}\int (\frac{\mathrm{d}}{\mathrm{d}t}(\vec{x}\cdot\vec{p})-\vec{x}\cdot\dot{\vec{p}}) \mathrm{d}t
=\lim_{\Delta t\to +\infty} -\frac{1}{\Delta t} \int_{t=0}^{t=\Delta t} \vec{x}\cdot\dot{\vec{p}}\mathrm{d}t
$$

即：

$$
<2T>_{+\infty}
=-<\vec{x}\cdot\vec{p}>_{+\infty}
$$

假设 $\dot{\vec{p}}$ 可以由系统的势能给出：

$$
\dot{\vec{p}}
=-\nabla V(\vec{x})
$$

再假设势能 $V(\vec{x})$ 是 $k$ 次齐函数，利用 $\alpha=1$ 时 $k$ 次齐函数的性质可以得到：

$$
2<T>_{+\infty}
=-<\vec{x}\cdot\vec{p}>_{+\infty}
=<\vec{x}\cdot\nabla V(\vec{x})>
=k<V(\vec{x})>_{+\infty}
$$

### 相空间和相流

### 唯象理解

一个过程称为确定的，如果它的整个过去和整个未来能由它现在的状态唯一确定。一个过程的所有可能状态称为它的**相空间**，相空间的元素称为**相点**。

设 $M$ 是相空间，$x\in M$ 是过程的初始状态，又设 $g^tx$表示初始状态为 $x$ 的过程在时刻 $t$ 的状态

对每一实数 $t$，$g^t $ 确定相空间 $M$ 到它自身的一个映射：

$$
g^t:M\to M
$$

此映射称为推进映射

显然，

$$
g^{t+s}
=g^tg^s
$$

对任一相点 $x\in M$，将它作为过程的初始状态。随着时间的流逝，$\{g^t x|x\in M \}$ 将在相空间描出一条曲线，称为相曲线

$t$ 推进映射族 $g^t:M\to M$ 构成相流

### 严格定义

#### 单参数变化群

一个由所有实数组成的集合$(t\in\R)$ 所标记的，由集合 $M$ 到它自身的映射族 $\{g^t \}$ 称为 $M$ 的单参数变换群，若对所有的 $s,t\in\R$ 满足：

$$
g^{t+s}
=g^tg^s
$$

且 $g^0$ 是恒等映射（它使每点固定）

单参数变换群是个交换的群（即$g^tg^s=g^sg^t$），且每个映射是个双射

由集合 $M$ 和 $M$ 的单参数变换群 $\{g^t \}$ 组成的偶对 $(M,\{g^t \})$ 称为相流。其中，$M$ 称为相流的相空间，$M$ 的元素称为相点。

设 $x\in M$ 是任一相点，则实直线到相空间的映射：

$$
\varphi:\R\to M,~~\varphi(t)=g^tx
$$

称为相流 $(M,\{g^t\})$作用下点 $x$ 的运动

在运动 $\varphi$ 下 $\R$ 的像称为相流 $(M,\{g^t \})$ 的相曲线

相曲线是相空间的子集。

定理1：经过相空间每一点有且只有一条相曲线。

若一相点 $x\in M$ 的相曲线是该点本身，即 $g^t x=x,\forall t\in \R$，则相点 $x$ 称为相流 $(M,\{g^t \})$ 的平衡位置或静止点。

# 第3章 最小作用量原理

任意力学系统的运动由函数 $L(q_1,q_2,\cdots,q_s,\dot{q}_1,\dot{q}_2,\cdots,\dot{q}_s,t)$（记为 $L(q,\dot{q},t)$） 描述，其对时间的积分：

$$
S
=\int_{t_0}^{t_1} L(q,\dot{q},t)\mathrm{d}t
$$

称为作用量

该系统由时空点 $(t_0,q_0)$ 至 $(t_1,q_1)$ 的运动方程定义为使得 $S$ 取极小的路径

设 $q(t)=[q_1(t),q_2(t),\cdots,q_s(t)]$ 使得 $S$ 取极小值，$\delta q(t)=[\delta q_1(t),\delta q_2(t),\cdots,\delta q_s(t)]$ 为 $q(t)$ 附近的微小变化，且满足：$\delta q(t_0)=0,\delta q(t_1)=0$. 由最小作用量原理，有：

$$
\delta S[q(t)]
=0
$$

其中，

$$
\delta S[q(t)]
\equiv S[q(t)+\delta q(t)]-S[q(t)]
$$

根据变分的知识，

$$
\begin{aligned}
\delta S[q(t)]
&=\delta \int_{t_0}^{t_1} L(q(t),\dot{q}(t),t)\mathrm{d}t \\
&=\int_{t_0}^{t_1} \sum_{i=1}^{s}(\frac{\partial L}{\partial q_i}\delta q_i+\frac{\partial L}{\partial \dot{q}_i}\delta \dot{q}_i)\mathrm{d}t \\
&=\int_{t_0}^{t_1}\sum_{i=1}^{s} (\frac{\partial L}{\partial q_i}\delta q_i + \frac{\partial L}{\partial \dot{q}_i}\frac{\mathrm{d}}{\mathrm{d}t}\delta q_i)\mathrm{d}t \\
&= \int_{t_0}^{t_1}\sum_{i=1}^{s} \bigg(\frac{\partial L}{\partial q_i}\delta q_i +\frac{\mathrm{d}}{\mathrm{d}t}(\frac{\partial L}{\partial \dot{q}_i}\delta q_i)- (\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{\partial \dot{q}_i})\delta q_i\bigg)\mathrm{d}t \\
&=\frac{\partial L}{\partial \dot{q}_i}\delta q_i\bigg|_{t_0}^{t_1}+\int_{t_0}^{t_1} \sum_{i=1}^{s} (\frac{\partial L}{\partial q_i}-\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{\partial \dot{q}_i})\delta q_i\mathrm{d}t \\
&=\int_{t_0}^{t_1} \sum_{i=1}^{s} (\frac{\partial L}{\partial q_i}-\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{\partial \dot{q}_i})\delta q_i\mathrm{d}t
\end{aligned}
$$

$\delta S[q(t)]=0$ 要求：

$$
\frac{\partial L}{\partial q_i}-\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{\partial \dot{q}_i}
=0
$$

这就是拉格朗日方程



# 第4章 两体问题

## 两体问题约化为单体问题

考虑由质量为 $m_1$ 和 $m_2$ 的两个质点组成的系统，它们的相互作用为 $U$

系统自由度为 $6$，选取质心坐标：

$$
\vec{R}
=\frac{m_1\vec{r}_1+m_2\vec{r}_2}{m_1+m_2}
$$

和相对坐标：

$$
\vec{r}
=\vec{r}_2-\vec{r}_1
$$

作为广义坐标。上两式用 $\vec{r}_1,\vec{r}_2 $ 表达 $\vec{R},\vec{r} $，从中可反解出：

$$
\vec{r}_1 = \vec{R} - \frac{m_2 }{m_1+m_2 } \vec{r} ,\quad
\vec{r}_2 = \vec{R} + \frac{m_1 }{m_1+m_2 } \vec{r}
$$

用质心位矢 $\vec{R} $ 和相对位矢 $\vec{r} $ 对应的广义速度表达体系动能：

$$
\begin{aligned}
T
&=\frac{1 }{2 } m_1\dot{\vec{r}}_1^2 + \frac{1 }{2 } m_2\dot{\vec{r}}_2^2 \\
&=\frac{1 }{2 } m_1 \left(\dot{\vec{R}} - \frac{m_2 }{m_1+m_2 } \dot{\vec{r}} \right)^2 + \frac{1 }{2 } m_2 \left(\dot{\vec{R}} + \frac{m_1 }{m_1+m_2 } \dot{\vec{r}} \right)^2 \\
&=\frac{1 }{2 } \left(m_1+m_2 \right)\dot{\vec{R}}^2 + \frac{1 }{2 } \cdot \frac{m_1 m_2 }{m_1+m_2 } \dot{\vec{r}}^2 \\
&\equiv \frac{1 }{2 } \left(m_1+m_2 \right)\dot{\vec{R}}^2 + \frac{1 }{2 } \mu \dot{\vec{r}}^2
\end{aligned}
$$

其中，$\displaystyle{\mu\equiv\frac{m_1m_2}{m_1+m_2} }$  称为约化质量。

一般地，体系的势能 $U $ 有如下形式：

$$
U
=U\left(\vec{r},\dot{\vec{r}},\ddot{\vec{r}},\cdots\right)
$$

则体系的拉格朗日量为：

$$
\mathcal{L}
=T-U
=\frac{1}{2}(m_1+m_2)\dot{\vec{R}}^2 + \frac{1}{2}\mu\dot{\vec{r}}^2 - U\left(\vec{r},\dot{\vec{r}},\ddot{\vec{r}},\cdots\right)
$$

拉格朗日量中没有出现 $\vec{R}$，于是 $\vec{R}$ 是循环坐标，其对应的广义动量 $\displaystyle{\vec{p} \equiv  \partial\mathcal{L}/\partial\dot{\vec{R}} = (m_1+m_2)\dot{\vec{R}} }$  是守恒量（或者代入E-L方程也可以得到守恒量），即两体问题体系**质心**静止或做匀速直线运动。

$\vec{r} $ 代表相对运动，其与 $\vec{R} $ 所代表的整体运动无耦合，故可以放弃平凡的整体运动项，此时体系的拉格朗日量为：

$$
L
=\frac{1}{2}\mu\dot{\vec{r}}^2-U\left(\vec{r},\dot{\vec{r}},\cdots\right)
$$

它与一个质量为 $\mu$ 的质点在外场 $U$ 中的拉格朗日量具有相同形式。

## 中心力场运动

若运动质点所受的力的作用线始终通过某个定点，则称该质点受中心力作用，定点为力心。

### 拉格朗日量

体系拉格朗日量：

$$
\begin{aligned}
L
&=T-V \\
&=\frac{1}{2}m\dot{\vec{r}}^2-U(r) \\
&=\frac{1}{2}m\left(\dot{r}\vec{\mathrm{e}}_r + r\dot{\theta}\vec{\mathrm{e}}_\theta \right)^2  - U(r) \\
&=\frac{1}{2}m\left(\dot{r}^2+r^2\dot{\theta}^2 \right) - U(r)
\end{aligned}
$$

### 运动方程

体系拉格朗日量：

$$
L
=\frac{1}{2}m\left(\dot{r}^2+r^2\dot{\theta}^2 \right) - U(r)
$$

代入 E-L 方程

$$
\frac{\partial L }{\partial q_i } - \frac{\mathrm{d} }{\mathrm{d}t } \frac{\partial L }{\partial \dot{q}_i } 
=0
$$

可得体系运动方程：

$$
m\ddot{r}-mr\dot{\theta}^2+\frac{\mathrm{d} U(r)}{\mathrm{d} r}
=0
$$

$$
\frac{\mathrm{d}}{\mathrm{d}t}\left(mr^2\dot{\theta}\right)
=0
$$

由于角动量为 $l=m r^2 \dot{\theta} $，因此上面第二条方程就是说角动量守恒。

由于角动量 $l $ 是个守恒量，利用这个守恒量把 $\dot{\theta}=l/\left(m r^2 \right) $ 代入第一条运动方程可简化之：

$$
m\ddot{r} - \frac{l^2 }{m r^3 } + \frac{\mathrm{d}U(r) }{\mathrm{d}r } 
=0
$$

### 守恒量

中心力场运动体系角动量守恒、能量守恒。

#### 根据诺特定理由对称性分析守恒量

（1）角动量守恒

体系拉格朗日量

$$
L
=\frac{1}{2}m\left(\dot{r}^2+r^2\dot{\theta}^2 \right) - U(r)
$$

只取决于 $\vec{r}$ 的大小 $r $，故 $L$ 具有空间旋转对称性，故角动量守恒。

由于角动量守恒，于是质点在做平面运动，采用极坐标系。

角动量定义为：

$$
\vec{l}
\equiv \vec{r}\times\vec{p}
=m\vec{r}\times\dot{\vec{r}}
$$

其大小为：

$$
\begin{aligned}
l
&=m\left|\vec{r}\times\dot{\vec{r}} \right| \\
&=m\left|r\vec{\mathrm{e}}_r\times\left(\dot{r}\vec{\mathrm{e}}_r+r\dot{\theta} \vec{\mathrm{e}}_\theta\right) \right| \\
&=mr^2\dot{\theta}
\end{aligned}
$$

（2）能量守恒

体系拉格朗日量

$$
L
=\frac{1}{2}m\left(\dot{r}^2+r^2\dot{\theta}^2 \right) - U(r)
$$

不显含时间，拉格朗日量具有时间平移对称性，因此体系能量守恒。

#### 由运动方程分析守恒量

（1）角动量守恒

$\theta$ 为循环坐标，其相应的广义动量是个守恒量，而 $\theta$ 对应的广义动量恰为角动量：

$$
p_\theta
=\frac{\partial L}{\partial \dot{\theta}}
=mr^2\dot{\theta}
=l
$$

角动量守恒导致开普勒第二定律：质点径矢单位时间扫过的面积相等：

设位矢在 $\mathrm{d}t$ 时间内转过 $\mathrm{d}\theta$ 角度，扫过的面积为：

$$
\mathrm{d}A
=\frac{1}{2} r^2 \mathrm{d}\theta
$$

于是单位时间内扫过的面积为：

$$
\frac{\mathrm{d}A}{\mathrm{d}t}
=\frac{1}{2}r^2\frac{\mathrm{d}\theta}{\mathrm{d}t}
=\frac{1}{2}r^2\dot{\theta}
=\frac{l}{2m}
$$

（2）能量守恒

体系能量：

$$
\begin{aligned}
E
&=T+V \\
&=\frac{1}{2}m\left(\dot{r}^2+r^2\dot{\theta}^2 \right) + U(r)
\end{aligned}
$$

利用角动量这个守恒量 $l=m r^2 \dot{\theta} $ 可把能量简化为：

$$
\begin{aligned}
E
&=\frac{1}{2}m\left(\dot{r}^2+r^2\dot{\theta}^2 \right) + U(r) \\
&=\frac{1}{2}m\left[\dot{r}^2+r^2\left(\frac{l }{m r^2 } \right)^2 \right] + U(r) \\
&=\frac{1 }{2 } m \dot{r}^2 + \frac{l^2 }{2m r^2 } + U(r)
\end{aligned}
$$

利用运动方程

$$
m\ddot{r} - \frac{l^2 }{m r^3 } + \frac{\mathrm{d}U(r) }{\mathrm{d}r } 
=0
$$

可计算能量对时间的全微商：

$$
\begin{aligned}
\frac{\mathrm{d}E }{\mathrm{d}t } 
&=m \dot{r} \ddot{r} - \frac{l^2 }{m r^3} \dot{r} + \frac{\mathrm{d}U(r) }{\mathrm{d}r } \dot{r} \\
&=\dot{r}\left(m\ddot{r} - \frac{l^2 }{m r^3 } + \frac{\mathrm{d}U(r) }{\mathrm{d}r }  \right) \\
&=0
\end{aligned}
$$

从上式可见，体系能量守恒。

#### 中心力场轨道微分方程（比耐公式）

中心力场的微分轨道方程：

$$
\frac{\mathrm{d}^2 u}{\mathrm{d}\theta^2}+u+\frac{m}{l^2}\frac{\mathrm{d}U}{\mathrm{d}u}
=0
$$

其中，$u=1/r $，上面方程称为**比耐公式**。

证明：

第一条运动方程：

$$
m\ddot{r} - \frac{l^2 }{m r^3 } + \frac{\mathrm{d}U(r) }{\mathrm{d}r } 
=0 \tag{1}
$$

$(1) $ 中出现了 $r $ 对时间的二阶微商。但我们想要轨道方程，即 $r $ 与 $\theta $ 的关系，为此，利用角动量这个守恒量把对时间 $t $ 的微商转化为对角度 $\theta $ 的微商。

$$
l
=mr^2\dot{\theta}
\Longrightarrow
\frac{\mathrm{d}}{\mathrm{d}t}
=\frac{\mathrm{d}\theta}{\mathrm{d}t} \frac{\mathrm{d}}{\mathrm{d}\theta}\
=\frac{l}{mr^2}\frac{\mathrm{d}}{\mathrm{d}\theta}
$$

$$
\frac{\mathrm{d}^2}{\mathrm{d}t^2}
=\frac{l}{mr^2}\frac{\mathrm{d}}{\mathrm{d}\theta}\left(\frac{l}{mr^2}\frac{\mathrm{d}}{\mathrm{d}\theta}\right)
$$

于是 $(1)$ 可以表示为：

$$
\frac{l}{r^2}\frac{\mathrm{d}}{\mathrm{d}\theta}\left(\frac{l}{mr^2}\frac{\mathrm{d}r}{\mathrm{d}\theta}\right)-\frac{l^2}{mr^3} + \frac{\mathrm{d}U }{\mathrm{d}r } 
=0 \tag{2}
$$

令：

$$
r = 1/u
$$

$$
\mathrm{d}r
=-\frac{1 }{u^2 } \mathrm{d}u
$$

代入 $(2) $ 整理得到用 $u=1/r $ 表达的中心力场轨道微分方程（比耐公式）：

$$
\frac{\mathrm{d}^2 u}{\mathrm{d}\theta^2}+u+\frac{m}{l^2}\frac{\mathrm{d}U}{\mathrm{d}u}
=0
$$

#### 中心力场轨道积分方程

注意到，角动量 $l$ 和能量 $E$ 是两个守恒量：

$$
E
=\frac{1}{2}m\dot{r}^2 + \frac{l^2}{2mr^2} + U(r)
\Longrightarrow
\mathrm{d}t
=\frac{\mathrm{d}r}{\sqrt{\frac{2}{m}\left[E-U(r)-\frac{l^2}{2mr^2}\right]}}
$$

$$
l
=mr^2\dot{\theta}
\Longrightarrow
\mathrm{d}t
=\frac{mr^2}{l}\mathrm{d}\theta
$$

消去 $\mathrm{d}t$，积分得：

$$
\theta
=\theta_0 + \int_{r_0}^{r} \frac{l\mathrm{d}r/r^2}{\sqrt{2m[E-U(r)]-(l/r)^2}}
$$

这就是轨道方程，其中，$E,l,r_0,\theta_0$ 是常数。

## 等效势分析法

中心力场运动问题可以等效为一个质点在一等效势场中的运动，令：

$$
U_{eff}
=\frac{l^2}{2mr^2}+U(r)
$$

则哈密顿量可表达为：

$$
E=\frac{m\dot{r}^2}{2}+U_{eff}
$$

第一项始终对应斥力势，称作离心势

质点的运动只能在满足 $E\geqslant U_{eff}$ 的区域

#### $U=-\frac{\alpha}{r}$ 吸引场

1）$E\geqslant 0$

2）$U_{eff}<E<0$

质点从 $r_{\max}$ 运动至 $r_{\min}$ 再运动回 $r_{\max}$ 的时间间隔内，矢量转过的角度为：

$$
\Delta \theta
=2\int_{r_{\min}}^{r_{\max}} \frac{\frac{l}{r^2}\mathrm{d}r}{\sqrt{2m[E-U(r)]-(\frac{l}{r})^2}}
$$

轨道闭合的充要条件是 $\Delta \theta$ 是 $2\pi$ 的有理数倍，即 $\Delta\theta$ 可以表示为 $\Delta \theta=2\pi\frac{m}{n},m,n\in Z $

对于反比吸引势，可以证明束缚运动的轨道是一个闭合的椭圆

3）$E=U_{\mathrm{eff}}$

此时 $r=\rm const$，运动轨道是个闭合的圆

此时轨道半径 $r_m$ 由下式确定：

$$
\frac{\mathrm{d}U_{\mathrm{eff}}}{\mathrm{d}r}\bigg|_{r=r_m}
=0
$$

#### $U=-\frac{\alpha}{r^3}$ 吸引场

#### 圆形闭合轨道的稳定条件

圆形轨道条件：

（1）质点等效势能具有极值

（2）质点能量恰好等于等效势能的极值

圆形轨道稳定性条件：

当 $U_{eff}(r_m)=(U_{eff})_{\min} $ 为极小值，能量稍增大，轨道仍然在轨道区域，运动是有界的

当 $U_{eff}(r_m)=(U_{eff})_{\max} $ 为极大值，能量稍增大，轨道可以在无穷远处，运动是无界的

## 开普勒运动问题：平方反比吸引力

### 开普勒三定律

#### 标准积分公式

$$
\begin{aligned}
\int \frac{\mathrm{d}x}{\sqrt{ax^2+bx+c}}
&=\frac{1}{\sqrt{-a}}\arccos\frac{-(b+2ax)}{\sqrt{b^2-4ac}}
\end{aligned}
$$

#### 开普勒运动轨迹

万有引力：

$$
F
=-\frac{GMm}{r^2}
=-\frac{k}{r^2}
\Longleftrightarrow
U(r)
=-\frac{k}{r}
$$

此时轨道具有圆锥曲线方程的形式：

$$
r
=\frac{p}{1+e\cos(\theta-\theta_0)},~~
p
=\frac{l^2}{mk},~~
e
=\sqrt{1+\frac{2El^2}{mk^2}}
$$

该圆锥曲线的焦点即为力心，$p$ 为正焦弦长度的一半，$e$ 为偏心率。

证明：

令 $r=\frac{1}{u}$

$$
\theta
=\theta_0-\int\frac{\mathrm{d}u}{\sqrt{\frac{2mE}{l^2}+\frac{2mku}{l^2}-u^2}}
$$

标准积分公式给出：

$$
\int\frac{\mathrm{d}x}{\sqrt{\alpha+\beta x+\gamma x^2}}
=\frac{1}{\sqrt{-\gamma}}\arccos\frac{-(\beta+2\gamma x)}{\sqrt{\beta^2-4\alpha \gamma}}
$$

令 $\alpha=\frac{2mE}{l^2},\beta=\frac{2mk}{l^2},\gamma=-1 $ 得到：

$$
\theta
=\theta_0-\arccos\frac{\frac{l^2 u}{mk}-1}{\sqrt{1+\frac{2El^2}{mk^2}}}
$$

最后得到：

$$
\frac{1}{r}
=\frac{mk}{l^2}(1+\sqrt{1+\frac{2El^2}{mk^2}}\cos(\theta-\theta_0))
$$

$e$ 不同，圆锥曲线可以分为椭圆、抛物线和双曲线，而 $e$ 又取决于体系的能量，故：

（1）当 $E=-\frac{mk^2}{2l^2} $ 时，$e=0$，轨迹为圆

（2） 当 $E<0$ 时，$e<1$，轨迹为椭圆，此时可证：

椭圆的半长轴 $a$ 只与能量有关：$a=\frac{r_{\min}+r_{\max}}{2}=\frac{p}{1-e^2}=-\frac{k}{2E}$

给定能量 $E$ 后，椭圆的偏心率 $e$ 由角动量 $l$ 决定：$e=\sqrt{1-\frac{l^2}{mka}} $

（3）当 $E=0$ 时，$e=1$，轨迹为抛物线 

（4）当 $E>0$ 时，$e>1$，轨迹为双曲线

#### 椭圆轨道 $(E<0)$ 运动周期

在一般中心吸引力场的作用下，束缚运动的轨道不一定是闭合的。椭圆运动周期，记为 $\tau$，定义为质点从近日点出发到再次返回近日点所需的时间。可以求出：

$$
\tau
=2\pi a^{\frac{3}{2}}\sqrt{\frac{m}{k}}
$$

证明：

将万有引力场 $U(r)=-\frac{k}{r} $，代入得：

$$
t
=\sqrt{\frac{m}{2}}\int_{r_0}^{r}\frac{\mathrm{d}r}{\sqrt{\frac{k}{r}-\frac{l^2}{2mr^2}+E}}
=\sqrt{\frac{ma}{k}}\int_{r_0}^{r}\frac{r\mathrm{d}r}{\sqrt{-(r-a)^2+e^2a^2}}
$$

令 $r=a(1-e\cos\psi)$，结合轨道方程可看出，$\theta$ 经历一周，$\psi$ 将通过

$$
t
=\sqrt{\frac{ma^3}{k}}\int_{\psi_0}^{\psi}(1-e\cos\psi)\mathrm{d}\psi
$$

#### 椭圆轨道 $(E<0)$ 的闭合性

可以证明，当质点的势能具有 $\frac{1}{r} $ 与 $r^2$ 的形式时，此时 $\Delta \theta$ 分别为 $2\pi$ 和 $\pi$，即此时的束缚运动的轨道是闭合的

证明：

将 $U=-\frac{k}{r}$ 代入，并令 $r=\frac{1}{u}$ 得：

$$
\Delta \theta
=-2\arccos\frac{pu-1}{e}\bigg|_{u=\frac{1}{r_{\min}}}^{u=\frac{1}{r_{\max}}}
=2\pi
$$

其中已经应用 $r_{\min}=\frac{p}{1+e},r_{\max}=\frac{p}{1-e} $

两体效应对开普勒第三定律的修正：

开普勒第三定律：行星公转周期的平方和轨道半长轴 的立方成正比

该定律只是近似成立

实际上，行星绕太阳运动是一个两个问题，可以等价于一个具有折合质量的质点的等效中心力场运动

$$
r
=\frac{2\pi a^\frac{3}{2}}{\sqrt{G(M+m)}}
$$

此时：

$$
\frac{a_1^3}{\tau_1^2}:\frac{a_2^3}{\tau_2^2}
=\frac{1+\frac{m_1}{M}}{1+\frac{m_2}{M}}
=\frac{M+m_1}{M+m_2}
$$

## LRL 矢量（龙格-楞次矢量）

平方反比有心力可以表达为：

$$
\vec{F}
=-\frac{k}{r^2}\vec{e}_r
$$

感受到此力的作用，一个粒子的轨道运动，其LRL向量，记为 $\vec{A} $，定义为：

$$
\vec{A}
\equiv  \vec{p}\times\vec{L}-mk\vec{e}_r
$$

能量 $E=\frac{p^2}{2m}-\frac{k}{r} $ 是个运动积分

定义离心率向量，记为 $\vec{e} $，定义为：

$$
\vec{e}
=\frac{\vec{A}}{mk}
=\frac{\vec{p}\times\vec{L}}{mk}-\vec{e}_r
$$

$$
\vec{A}\cdot\vec{r}
=\vec{L}\cdot(\vec{r}\times\vec{p})-mkr
=\vec{L}\cdot\vec{L}-mkr
=L^2-mkr
$$

于是：

$$
Ar\cos\theta
=L^2-mkr
$$

离心率为：

$$
e
=\frac{|\vec{A}|}{mk}
$$

注意到：

$$
\vec{A}\cdot\vec{A}
=(\vec{p}\times\vec{L}-mk\vec{e}_r)\cdot(\vec{p}\times\vec{L}=mk\vec{e}_r)
=(2mE+\frac{2mk}{r})L^2+m^2k^2-\frac{2mk}{r}L^2
$$

于是：

$$
A^2
=m^2k^2+2mEL^2
$$

$$
e^2
=1+\frac{2L^2}{mk^2}E
$$

## 卢瑟福散射问题：平方反比排斥力

#### 散射问题的描述

束流强度 $N_0$：单位时间内穿过垂直于束流方向单位面积的质点数

瞄准距离 $b$： 力心到入射方向上的距离

入射速度 $v_0$： 标记了粒子束流的入射能量 $E=\frac{mv_0^2}{2}$

散射角 $\Theta$：束流入射方向与出射方向之间的夹角

#### 质点轨道方程

双曲线的一支

$$
r
=\frac{-|p|}{1-\varepsilon \cos(\theta-\theta_0)}
$$

$$
p
=\frac{l^2}{mk},~~
\varepsilon
=\sqrt{1+\frac{2El^2}{mk^2}}
=\sqrt{1+(\frac{2Eb}{Z'Ze^2})^2}
$$

选择 $\theta_0=0$，则离力心最近点 $r_m$ 对应 $\theta=0$，此时轨道方程变为：

$$
r
=\frac{l^2}{mZ'Ze^2}\frac{1}{\varepsilon\cos\theta-1}
$$

入射方向极角 $\chi_0$ 对应 $r=+\infty$，可得：

$$
\cos\chi_0
=\frac{1}{\varepsilon}
$$

散射角 $\Theta$ 与入射方向极角满足：

$$
\Theta
=\pi -2\chi_0
$$

于是：

$$
\sin\frac{\Theta}{2}
=\sin(\frac{\pi}{2}-\chi_0)
=\cos\chi_0
=\frac{1}{\varepsilon}
\Longrightarrow
\cot\frac{\Theta}{2}
=\sqrt{\varepsilon^2-1}
=\frac{2Eb}{Z'Ze^2}
$$

#### 散射截面

不同的瞄准距离 $b$ 具有不同的散射角

单位时间内进入到 $b$ 到 $b+\mathrm{d} b$ 的环状区域内的束流 $\mathrm{d} N$ 将被散射到 $\Theta$ 到 $\Theta+\mathrm{d}\Theta$ 之间的立体角 $\mathrm{d} \Omega$ 内（空间锥体区域）

$$
\mathrm{d} N
=2\pi b|\mathrm{d} b|N_0
$$

定义单位时间内进入到单位立体角内的质点数与入射粒子束流强度 $N_0$ 的比为微分散射截面

$$
\sigma \mathrm{d} \Omega
=\frac{\mathrm{d}N}{N_0}
$$

立体角的定义为：

$$
\mathrm{d}\Omega
\equiv \frac{\mathrm{d}S}{r^2}
$$

$$
2\pi R\sin \Theta R|\mathrm{d}\Theta|
=R^2\mathrm{d}\Omega
\Longrightarrow
\mathrm{d} \Omega
=2\pi \sin\Theta |\mathrm{d}\Theta|
$$

于是：

$$
\sigma
=\frac{b}{\sin\Theta}|\frac{\mathrm{d} b}{\mathrm{d} \Theta} |
=\frac{1}{4}(\frac{Z'Ze^2}{2E})^2\csc^4\frac{\Theta}{2}
$$

#### 两体效应对卢瑟福散射的修正

实验室可以直接观测的通常是散射粒子的出射角相对于入射角的偏转 $\vartheta$

选择实验室系：

碰撞前：质点 $1$ 的速度 $\vec{v}_1$，质点 $2$ 的速度 $0$

碰撞后：质点 $1$ 的速度 $\vec{v}_1'$，质点 $2$ 的速度 $\vec{v}_2' $

$\vartheta$ 为 $\vec{v}_1 $ 和 $\vec{v}_1'$ 的夹角

动量守恒：

$$
m_1\vec{v}_1
=m_1\vec{v}_1'+m_2\vec{v}_2' \tag{1}
$$

能量守恒：

$$
\frac{m_1v_1^2}{2}
=\frac{m_1v_1'^2}{2}+\frac{m_2v_2'^2}{2} \tag{2}
$$

$(1)$ 式两边平方，结合 $(2)$ 得：

$$
\vec{v}_1'\cdot\vec{v}_2'
=0
$$

由质心的动量等于质点组的动量之和，有：

$$
m_1\vec{v}_1
=(m_1+m_2)\vec{v}_C
\Longrightarrow
\vec{v}_C
=\frac{m_1\vec{v}_1}{m_1+m_2}
\equiv \vec{V}
$$

其中，$\vec{v}_C $ 是质心在实验室系中的速度



选择质心系：

碰撞前：质点 $1$ 的速度 $\vec{V}_1=\vec{v}_1-\vec{V}=\frac{m_2\vec{v_1}}{m_1+m_2} $，质点 $2$ 的速度 $\vec{V}_2=0-\vec{V}=-\frac{m_1\vec{v}_1}{m_1+m_2} $

碰撞后：质点 $1$ 的速度为 $\vec{V}_1'$，质点 $2$ 的速度为 $\vec{V}_2' $

$$
m_1\vec{V}_1+m_2\vec{V}_2
=m_1\vec{V}_1'+m_2\vec{V}_2'
=\vec{0}
$$

$$
\frac{m_1V_1^2}{2}+\frac{m_2V_2^2}{2}
=\frac{m_1V_1'^2}{2}+\frac{m_2V_2'^2}{2}
$$

可得：

$$
V_1'
=V_1,V_2'=V_2
$$

$\Theta$ 为 $\vec{V}_1$ 和 $\vec{V}_1' $ 的夹角

$\vec{V}_1'+\vec{V}=\vec{v}_1 $

注意到：

$$
\vec{V}
\equiv\vec{v}_C
=\frac{m_1\vec{v}_1}{m_1+m_2}
$$

$$
|\vec{V}_1'|
=|\vec{V}_1|
=|\frac{m_2\vec{v}_1}{m_1+m_2}|
$$

于是：

$$
\frac{V}{V_1'}
=\frac{m_1}{m_2}
$$

于是：

$$
\left\{
\begin{aligned}
V_1'\cos\Theta +V = v_1'\cos\theta \\
V_1'\sin\Theta = v_1'\sin\theta
\end{aligned}
\right.
\Longrightarrow
\tan \theta
=\frac{V_1'\sin\Theta}{V_1'\cos\Theta+V}
=\frac{\sin \Theta}{\cos\Theta+\frac{m_1}{m_2}}
$$

# 第5章 刚体

## 刚体运动学

刚体是一种特殊的质点组，其任何两个质点间的距离不因力的作用而发生改变，刚体在运动过程中大小形状不变

确定刚体运动只需要 $6$ 个变量

#### 刚体运动分类

平动：运动过程中刚体上任意两点连线始终平行；可看作单质点运动；$3$ 个独立变量

定轴转动：刚体中两质点不动的运动叫定轴转动；由该两点确定的直线叫转动轴；$1$ 个独立变量

平面平行运动：运动中任一点始终在平行于某固定平面的平面运动；运动可分解为平面内任意一点的平动（$2$ 个自由变量）和绕此点且垂直于该平面的转动（$1$ 个自由变量）

定点转动：运动中仅一点不动，$3$ 个自由变量

一般运动：刚体在空间任意运动，可分解为质心平动（$3$ 个自由变量）和绕质心的定点转动（$3$ 个自由度）

刚体的任意运动可分解为其上某点的平动和绕该点的转动两种模式的合成。选定的点称为基点。

**基点的选取具有任意性**。

#### 角速度

角位移：

$$
\Delta \vec{n}
=\Delta\theta \vec{e}_n
$$

$$
\delta \vec{r}
=\delta \vec{n}\times\vec{r}
$$

角速度：

$$
\vec{\omega}
\equiv \lim_{\Delta t\to 0}\frac{\Delta \vec{n}}{\Delta t}
=\frac{\mathrm{d}\vec{n}}{\mathrm{d}t}
=\frac{\mathrm{d}\theta}{\mathrm{d}t}\vec{e}_n
$$

转动导致的线速度 $\vec{v}_r $ 与角速度的关系：

$$
\vec{v}_r
=\frac{\mathrm{d}\vec{r}}{\mathrm{d}t}
=\vec{\omega}\times\vec{r}
$$

#### 欧拉角 

为了描述刚体的转动，选取一个静止坐标系 $XYZ$ 和一个固定在刚体上的运动坐标系 $xyz$，用运动坐标系 $xyz$ 各轴相对固定坐标系 $XYZ$ 各轴方向角度的变化来描述

取初始时刻静止系 $XYZ$ 和运动系 $xyz$ 重合

- 将 $xyz$ 系绕 $z$ 轴旋转 $\phi(0\leqslant \phi\leqslant 2\pi)$ 得 $x'y'z$ 系；$\phi$ 称为进动角

- 将 $x'y'z$ 绕 $x'$ 轴旋转 $\theta(0\leqslant \theta\leqslant \pi)$ 得 $x'y''z'$ 系；$\theta$ 称为章动角

- 将 $x'y''z'$ 绕 $z'$ 轴旋转 $\psi(0\leqslant \psi\leqslant 2\pi)$ 得 $x''y'''z'$ 系；$\psi$ 称为自转角

$(\theta,\phi,\psi)$ 称为欧拉角

各欧拉角相应变化率为：

- $\angle XON=\phi$，$\dot{\phi} \vec{e}_Z $ 在 $xyz$ 系中的坐标为 $\dot{\phi}(\sin\theta\sin\psi,\sin\theta\cos\psi,\cos\theta) $

- $\angle zOZ=\theta$，$\dot{\theta}\vec{e}_{ON} $ 在 $xyz$ 系坐标为 $\dot{\theta}(\cos\psi,-\sin\psi,0) $

- $\angle xON=\psi$，$\dot{\psi}\vec{e}_z $ 在 $xyz$ 系的坐标为 $\dot{\psi}(0,0,1)$

$\vec{\omega} $ 在运动系 $xyz$ 中的分量 $\vec{\omega}=\omega_x\vec{e}_x+\omega_y\vec{e}_y+\omega_z\vec{e}_z $

$$
\omega_x
=\dot{\phi}\sin\theta\sin\psi+\dot{\theta}\cos\psi
$$

$$
\omega_y
=\dot{\sin\theta}\cos\psi-\dot{\theta}\sin\psi
$$

$$
\omega_z
=\dot{\phi}\cos\theta+\dot{\psi}
$$

#### 刚体里各点的运动

刚体内 $P $ 点的运动可以分解为：基点 $A$ 的平动与 $P$ 绕 $A$ 点的转动

$$
\frac{\mathrm{d}\vec{r}'}{\mathrm{d}t}
=\vec{\omega}\times\vec{r}'
$$

$$
\vec{r}
=\vec{r}_A+\vec{r}'
$$

$$
\vec{v}
=\vec{v}_A+\vec{\omega}\times\vec{r}'
$$

$$
\vec{a}
=\vec{a}_A+\frac{\mathrm{d}\vec{\omega}}{\mathrm{d}t}\times\vec{r}'+\vec{\omega}\times(\vec{\omega}\times\vec{r}')
$$

平动：$\vec{\omega}=0 $

定轴转动：$\vec{v}_A=0 $

平面平行运动：$\vec{v}\perp \vec{\omega} $

定点运动：$\vec{v}_A=0,\vec{a}_A=0 $

#### 转动瞬心

某一时刻，刚体上速度为零的质点称为转动瞬心

若 $\vec{r}_s $ 是瞬心，则刚体上任意一点的速度可以写成：

$$
\vec{v}
=\vec{\omega}\times(\vec{r}-\vec{r}_s)
$$

假设瞬心位置为 $\vec{r}_s $，基点为 $\vec{r}_A $

$$
\left\{
\begin{aligned}
&\vec{v}_s
=\vec{v}_A+\vec{\omega}\times(\vec{r}_s-\vec{r}_A) \\
&\vec{v}_s
=\vec{0}
\end{aligned}
\right.
\Longrightarrow
\vec{v}_A+\vec{\omega}\times(\vec{r}_s-\vec{r}_A)
=\vec{0}
$$

两边同时点乘 $\vec{\omega}$ 得：

$$
\vec{v}_A\cdot\vec{\omega}
=0
$$

存在转动瞬心的必要条件为 $\vec{v}_A\cdot\vec{\omega}=0$

平面平行运动恒满足该条件，可求转动瞬心坐标：

$$
\vec{r}_s
=\vec{r}_A+\frac{\vec{\omega}\times\vec{v}_A}{\omega^2}
$$

特别地，对于平面运动，令 $\vec{\omega}=\omega\vec{e}_z,\vec{r}_s=x_s\vec{e}_x+y_s\vec{e}_y,\vec{r}_A=x_A\vec{e}_x+y_A\vec{e}_y $，可求出瞬心坐标：

$$
x_s
=x_A-\frac{v_{Ay}}{\omega}
$$

$$
y_s
=y_A+\frac{v_{Ax}}{\omega}
$$

不同时刻有不同瞬心

瞬心速度为零，但加速度不为零，否则刚体做定点转动

瞬心可以在刚体上，也可以在刚体外

对瞬心而言，刚体上任一点 $P$ 的速度 $\vec{v}=\vec{\omega}\times\vec{sP} $ 都垂直于瞬心 $s$ 与该点 $P$ 的连线 $sP$

瞬心的确定：

观测法：凡滚而不滑的刚体与另一物体的接触点就是瞬心

作图法：刚体中任意两点速度 $\vec{v}_A,\vec{v}_B $ 垂线的交点 $s$ 就是瞬心

空间极迹：$s$ 在固定平面上所描的轨迹

本体极迹：$s$ 在薄片上所描绘的轨迹

薄片运动是本体极迹在空间极迹上无滑动的滚动

## 刚体动力学

刚体的动量：

$$
\vec{p}
\equiv \sum_{i} m_i\vec{v}_i
=m\vec{v}_C
$$

其中，$m\equiv \sum\limits_{i} m_i$ 是刚体总质量，$\vec{v}_C $ 是刚体质心速度

刚体的角动量：

设刚体绕定点 $O$ 做角速度为 $\vec{\omega} $ 的转动，其内质点 $P$ 速度为 $\vec{v}_i $，位矢 $\vec{r}_i $，则 $P$ 对 $O$ 的角动量为：

$$
\vec{J}_i
\equiv \vec{r}_i\times m_i\vec{v}_i
=m_i \vec{r}_i\times(\vec{\omega}\times\vec{r}_i)
$$

整个刚体对 $O$ 的角动量为：

$$
\vec{J}
=\sum_{i} \vec{J}_i
=\sum_{i} m_i[\vec{\omega} r_i^2-\vec{r}_i(\vec{\omega}\cdot\vec{r}_i)]
$$

分量形式为：

$$
\begin{aligned}
J_x
&=\sum_{i} m_i[\omega_x (x_i^2+y_i^2+z_i^2)-x_i(\omega_xx_i+\omega_y y_i+\omega_z z_i)] \\
&=\omega_x\sum_{i} m_i(y_i^2+z_i^2)-\omega_y\sum_{i} m_i x_i y_i-\omega_z\sum_{i} m_i x_iz_i
\end{aligned}
$$

$$
\begin{aligned}
J_y
&=\sum_{i} m_i[\omega_y (x_i^2+y_i^2+z_i^2)-y_i(\omega_xx_i+\omega_y y_i+\omega_z z_i)] \\
&=-\omega_x\sum_{i} m_i y_i x_i+\omega_y\sum_{i} m_i(x_i^2+z_i^2)-\omega_z\sum_{i} m_iy_i z_i
\end{aligned}
$$

$$
\begin{aligned}
J_z
&=\sum_{i} m_i[\omega_z (x_i^2+y_i^2+z_i^2)-z_i(\omega_xx_i+\omega_y y_i+\omega_z z_i)] \\
&=-\omega_x\sum_{i} m_i z_i x_i-\omega_y\sum_{i} m_i z_i y_i+\omega_z\sum_{i} m_i(x_i^2+y_i^2)
\end{aligned}
$$

角动量可以写成矩阵乘法的形式的形式：

$$
\vec{J}
=\bold{I}\vec{\omega}
$$

$$
\bold{I}
\equiv \begin{bmatrix}
\sum\limits_{i}m_i(y_i^2+z_i^2) &-\sum\limits_{i} m_ix_iy_i &-\sum\limits_{i} m_i x_i z_i \\
-\sum\limits_{i} m_i y_i x_i &\sum\limits_{i}m_i(x_i^2+z_i^2) &-\sum\limits_{i}m_i y_i z_i \\
-\sum\limits_{i} m_i z_i x_i &-\sum_{i} m_i z_i y_i &\sum\limits_{i} m_i (x_i^2+y_i^2)
\end{bmatrix}
$$

$I$ 称为惯量张量，其对角元 $I_{\alpha\alpha}$ 为转动惯量，非对角元 $I_{\alpha\beta}$ 为惯量积

若组成刚体的质点是连续的，则惯量张量中的求和变为积分：

$$
I_{\alpha\beta}
=\int \rho(\vec{r})(r^2\delta_{\alpha\beta}-r_\alpha r_\beta)\mathrm{d}V
$$
其中，$\rho(\vec{r})$ 是刚体的体密度

刚体的动能：

$$
\begin{aligned}
T
&\equiv \frac{1}{2}\sum_{i} m_i\dot{\vec{r}}_i^2 \\
&\equiv \frac{1}{2}\sum_{i} m_i\vec{v}_i\cdot(\vec{\omega}\times\vec{r}_i) \\
&=\frac{1}{2}\vec{\omega}\cdot\sum_{i} \vec{r}_i\times(m_i\vec{v}_i) \\
&=\frac{1}{2}\vec{\omega}\cdot\vec{J} \\
&=\frac{1}{2}\vec{\omega}\cdot (\bold{I}\vec{\omega}) \\
&=\frac{1}{2}\vec{\omega}^{\mathrm{T}}\bold{I}\vec{\omega} \\
&=\frac{1}{2}(I_{xx}\omega_x^2+I_{yy}\omega_y^2+I_{zz}\omega_z^2+2I_{xy}\omega_{x}\omega_{y}+2I_{yz}\omega_{y}\omega_{z}+2I_{zx}\omega_{z}\omega_{x})
\end{aligned}
$$

惯量张量的取值与参考点 $O$ 的选择有关

相对于某定点的惯量张量 $\bold{I}$ 可以分解为两部分：

$$
I_{\alpha\beta}
=I_{\alpha\beta}^{C}+I_{\alpha\beta}'
$$

其中，$\bold{I}^C$ 是质心 $C$ 相对于 $O$ 的转动惯量张量，$\bold{I}' $ 是刚体相对于质心 $O$ 的转动惯量张量，即：

$$
I_{\alpha\beta}^{C}
\equiv (\sum_{i} m_i)(r_C^2\delta_{\alpha\beta}-r_{C\alpha}r_{C\beta})
$$

$$
I_{\alpha\beta}'
\equiv \sum_{i} m_i(r_i'^2\delta_{\alpha\beta}-r_{i\alpha}'r_{i\beta}')
$$

其中，$\vec{r}_C $ 是质心相对于定点 $O$ 的位矢 $\overrightarrow{OC} $，$\vec{r}' $ 为质点 $i$ 相对于质心 $C$ 的位矢

主转动惯量：

适当选择坐标系可以使得惯量张量为对角的，此时的转动惯量称为主转动惯量，$I_1=I_{11},I_2=I_{22},I_3=I_{33} $，相应的坐标轴称为惯量主轴，此时：

$$
\vec{J}
=I_1\omega_x\vec{e}_x+I_2\omega_y\vec{e}_y+I_3\omega_z\vec{e}_z
$$

$$
T
=\frac{1}{2}(I_1\omega_x^2+I_2\omega_y^2+I_3\omega_z^2)
$$

惯量主轴的选择：

坐标原点选在质心上

坐标轴选在对称性高的轴上

有用的公式：

对于共线的多质点系统，垂直于该线方向上的两个非零的主转动惯量（相对于质心）为：

$$
I_1=I_2=
\frac{1}{M}\sum\limits_{i,j;i<j} m_i m_j l_{ij}^2 
$$ 

其中，$l_{ij}$ 是质点 $i,j$ 之间的距离

证明：

$$
\begin{aligned}
\sum\limits_{i,j;i<j} m_i m_j l_{ij}^2 
&=\frac{1}{2} \sum_{i,j} m_i m_j [(z_i-z_C)-(z_j-z_C)]^2 \\
&=\sum_{i,j} m_i m_j(z_i-z_C)^2-\sum_{i,j} m_i m_j(z_i-z_C)(z_j-z_C) \\
&=M\sum_{i} m_i(z_i-z_C)^2 \\
&=M I_1 \\
&=M I_2
\end{aligned}
$$

例：

求双原子分子的主转动惯量

解：

以 $m_1$ 为原点，$m_1,m_2$ 所在直线为 $x$ 轴，找出质心：

$$
\vec{R}_C
=\frac{m_2 l}{m_1+m_2}\vec{e}_x
$$

以质心为坐标原点，重新建系

$$
\vec{r}_1
=(\frac{-m_2 l}{m_1+m_2},0,0),~~
\vec{r}_2
=(\frac{m_1 l}{m_1+m_2},0,0)
$$

计算惯量张量：

非零元为：

$$
I_{22}
=I_{33}
=\frac{1}{m_1+m_2}\cdot m_1m_2l^2
$$

求组成等腰三角形的三原子分子的主转动惯量（底长 $a$，高 $h$）

先找质心坐标

以质心为坐标原点建系，

$$
\vec{r}_1
=(-\frac{a}{2},-\frac{m_2h}{2m_1+m_2},0),~~
\vec{r}_2
=(\frac{a}{2},-\frac{m_2h}{2m_1+m_2},0),~~
\vec{r}_3
=(0,\frac{2m_1 h}{2m_1+m_2},0)
$$

计算惯性张量：

$$
I_{11}
=\frac{2m_1m_2 h^2}{2m_1+m_2},~~
I_{22}
=\frac{m_1 a^2}{2},~~
I_{33}
=I_{11}+I_{22}(几何关系)
$$

求组成平行四面体的四原子分子的主转动惯量（底长 $a$，高 $h$）

找到质心坐标

以质心为坐标原点建系

求均匀圆柱体主转动惯量

解：

用柱坐标 $r,\theta,z$，密度设为 $\rho$

体积元：$r\mathrm{d}r\mathrm{d}\theta\mathrm{d}z$

质元：$\rho r\mathrm{d}r\mathrm{d}\theta\mathrm{d}z$

求主转动惯量：

$$
I_{xx}
=I_{yy}
=\int_{z=-\frac{h }{2}}^{z=\frac{h}{2}}\int_{\theta=0}^{\theta=2\pi}\int_{r=0}^{r=R} (r\sin\theta)^2 \cdot\rho r\mathrm{d}r\mathrm{d}\theta\mathrm{d}z
=
$$

例：求底面半径为 $R$，高为 $h$ 的圆锥的主转动惯量

解：

以为圆锥顶点为原点建系，$z$ 轴垂直底面向上

先求质心坐标：

质元：

$$
\mathrm{d}m
=\rho r\mathrm{d}r\mathrm{d}\theta\mathrm{d}z
$$

积分区域：

$$
\left\{
\begin{aligned}
&r\in [0,\frac{R}{h}z] \\
&\theta\in[0,2\pi] \\
&z\in[0,h]
\end{aligned}
\right.
$$

质心高度：

$$
\begin{aligned}
z_C
&=\frac{1}{M}\int_{z=0}^{z=h}\int_{\theta=0}^{\theta=2\pi}\int_{r=0}^{r=\frac{R}{h}z} z \rho r \mathrm{d}r\mathrm{d}\theta\mathrm{d}z \\
&=\frac{3h}{4}
\end{aligned}
$$

再以质心为原点建系，积分区域变为：

$$
\left\{
\begin{aligned}
&r\in [0,\frac{R}{h}(z+\frac{3h}{4})] \\
&\theta\in[0,2\pi] \\
&z\in[-\frac{3h}{4},\frac{h}{4}]
\end{aligned}
\right.
$$

计算惯量张量：

$$
\begin{aligned}
I_{zz}
&=\int (x^2+y^2) \mathrm{d}m \\
&=\rho\int_{z=-\frac{3h}{4}}^{z=\frac{h}{4}}\int_{\theta=0}^{\theta=2\pi}\int_{r=0}^{r=\frac{R}{h}(z+\frac{3h}{4})} r^3\mathrm{d}r\mathrm{d}\theta\mathrm{d}z \\
&=\frac{3R^2 M}{2h^5}\int_{z=-\frac{3h}{4}}^{z=\frac{h}{4}} (z+\frac{3h}{4})^4\mathrm{d}z \\
(z'=z+\frac{3h}{4})&=\frac{3R^2 M}{2h^5}\int_{z'=0}^{z'=h} z'^4\mathrm{d}z' \\
&=\frac{3}{10}MR^2
\end{aligned}
$$

$$
\begin{aligned}
I_{xx}
&=I_{yy} \\
&=\int (x^2+z^2)\mathrm{d}m \\
&=\rho\int_{z=-\frac{3h}{4}}^{z=\frac{h}{4}}\int_{\theta=0}^{\theta=2\pi}\int_{r=0}^{r=\frac{R}{h}(z+\frac{3h}{4})} (r^3\cos^2\theta+z^2 r)\mathrm{d}r\mathrm{d}\theta\mathrm{d}z \\
&=\frac{3M}{20}(R^2+\frac{h^2}{4})
\end{aligned}
$$

### 刚体动力学方程

平动

定轴转动

$$
T
=\frac{1}{2}I_{zz}\dot{\varphi}^2
$$

$$
I_{zz}\ddot{\varphi}
=-\frac{\mathrm{d}V}{\mathrm{d}\varphi}
$$

非保守力：

$$
I_{zz}\ddot{\varphi}
=Q_{\varphi},~~
Q_{\varphi}
=\sum_{i} \vec{F}_i\cdot\frac{\partial \vec{r}_i}{\partial \varphi}
$$

平面平行运动

定点转动

刚体内任一点的虚位移：

$$
\delta\vec{r}_i
=\delta\vec{r}_C+\delta \theta\vec{e}_n\times(\vec{r}_i-\vec{r}_C)
$$

$$
\frac{\mathrm{d}\vec{J}'}{\mathrm{d}t}
=\vec{M}'
$$

$$
\vec{J}'
\equiv \sum_{i} (\vec{r}_i-\vec{r}_C)\times m_i\dot{\vec{r}}_i,~~
\vec{M}'
\equiv \sum_{i}(\vec{r}_i-\vec{r}_C)\times\vec{F}_i
$$

用运动坐标系 $xyz$ 表示绝对角动量：

$$
\vec{J}
\equiv \sum_{i=x,y,z}I_{xi}\omega_i\vec{e}_x+\sum_{i=x,y,z} I_{yi}\omega_i\vec{e}_y+\sum_{i=x,y,z}I_{zi}\omega_i\vec{e}_z
$$

$$
\dot{\vec{e}}_i
=\vec{\omega}\times\vec{e}_i
$$

$$
\frac{\mathrm{d}\vec{J}}{\mathrm{d}t}
=\vec{M}
$$

欧拉动力学方程：

$$
\left\{
\begin{aligned}
I_x\dot{\omega}_x-(I_y-I_z)\omega_y\omega_z
=M_x \\
I_y\dot{\omega}_y-(I_z-I_x)\omega_z\omega_x
=M_y \\
I_z\dot{\omega}_z-(I_x-I_y)\omega_x\omega_y
=M_z \\
\end{aligned}
\right.
$$

刚体定轴转动实例：

#### 欧拉陀螺

刚体不受任何净力或净力矩

$$
\left\{
\begin{aligned}
I_x\dot{\omega}_x
=(I_y-I_z)\omega_y\omega_z\\
I_y\dot{\omega}_y
=(I_z-I_x)\omega_z\omega_x \\
I_z\dot{\omega}_z
=(I_x-I_y)\omega_x\omega_y \\
\end{aligned}
\right.
$$

若刚体对称，将对称轴选为 $z$ 轴，$I_x=I_y=I_1$

$$
\left\{
\begin{aligned}
&I_1\dot{\omega}_x
=(I_1-I_z)\omega_y\omega_z \\
&I_1\dot{\omega_y}
=-(I_1-I_z)\omega_z\omega_x \\
&I_z\dot{\omega}_z
=0
\end{aligned}
\right.
$$

$\Omega_z$ 是一个常数

$$
\left\{
\begin{aligned}
&\dot{\omega}_x
=-\Omega \omega_y \\
&\dot{\omega}_y
=\Omega\omega_x
\end{aligned},~~
\Omega
\equiv \frac{I_z-I_1}{I_1}\omega_z
\right.
$$

$$
\omega_x
=A\cos\Omega t,~~
\omega_y 
=A\sin\Omega t
$$

$$
\vec{\omega}
=A\cos\Omega t\vec{e}_x+A\sin\Omega t\vec{e}_y+\omega_z\vec{e}_z
$$

总角速度大小为 $\sqrt{\omega_z^2+a^2} $ 为常数

角动量和动能守恒


# 第6章 非惯性参考系

# 第7章 微振动

## 一维谐振子

微小振动意味着：

质点运动方程为线性微分方程：$\ddot{x}=f(x,\dot{x}) $，其中 $f(x,\dot{x})$ 是 $x,\dot{x}$ 的线性函数

在平衡点附近的微小振动意味着势能函数 $V(x)$ 满足：

$$
\frac{\partial V}{\partial x}\bigg|_{x=x_0}
=0,~~
\frac{\partial^2 V}{\partial x^2}\bigg|_{x=x_0}
>0
$$

此时 $x_0$ 是系统的稳定平衡点

设一质点在平衡位置 $q_0$ 附近做微振动，其拉氏量为：

$$
L
=\frac{1}{2}a(q)\dot{q}^2-U(q)
$$

对 $U(q)$ 在平衡点 $q_0$ 处展开：

$$
U(q)
=U(q_0)+U'(q)\bigg|_{q=q_0}(q-q_0)+\frac{1}{2}U''(q)\bigg|_{q=q_0}(q-q_0)^2
$$

$q_0$ 是平衡点，于是 $U'(q)\bigg|_{q=q_0}=0,U''(q)\bigg|_{q=q_0}>0$

再认为 $a(q)\approx q(q_0)$，并且选取 $q_0$ 处为零势能点，即 $U(q_0)=0$，统统代回 $L$ 的表达式，得：

$$
L
=\frac{1}{2}a(q_0)\bigg[ \frac{\mathrm{d}}{\mathrm{d}t}(q-q_0) \bigg]^2-\frac{1}{2}U''(q)\bigg|_{q=q_0}(q-q_0)^2
$$

对于一维微振动，

$$
q-q_0
=x
$$

$$
L
=\frac{1}{2}m\dot{x}^2-\frac{1}{2}kx^2
$$

运动方程为：

$$
\ddot{x}+\omega^2 x
=0,~~
\omega^2=\frac{k}{m}
$$

其解为：

$$
x
=C_1\cos\omega t+C_2\sin\omega t
=A\cos(\omega t+\varphi)
$$

运用了辅助角公式

$A,\varphi$ 由初始条件确定

质点能量：

$$
E
=\frac{1}{2}m\omega^2 A^2
$$

能量守恒

$$
x
=A\cos(\omega t+\varphi) 
$$

可表达为：

$$
x
=\mathrm{Re}\{  Xe^{\mathrm{i}\omega t} \}
$$

$X=Ae^{\mathrm{i}\varphi}$ 称为复振幅

## 耦合谐振子

图见讲义

体系动能：

$$
T
=\frac{1}{2}m(\dot{x}_1^2+\dot{x}_2^2)
$$

体系势能：

$$
U
=\frac{1}{2}kx_1^2+\frac{1}{2}\chi(x_1-x_2)^2+\frac{1}{2}kx_2^2
$$

体系拉氏量为：

$$
L
=T-U
=\frac{1}{2}m(\dot{x}_1^2+\dot{x}_2^2)-\frac{1}{2}k_0(x_1^2+x_2^2)+\chi x_1x_2
$$

其中，$k_0\equiv k+\chi$

运动方程为：

$$
\ddot{x}_1+\omega_0^2x_1
=\eta x_2,~~
\ddot{x}_2+\omega_0^2 x_2
=\eta x_1
$$

其中，$\omega_0^2=\frac{k_0}{m},\eta=\frac{\chi}{m} $

设 $x_1(t)=\mathrm{Re}\{ C_1e^{\mathrm{i}\omega t} \},x_2(t)=\mathrm{Re}\{ C_2e^{\mathrm{i}\omega t} \}$，运动方程可表达为：

$$
\begin{bmatrix}
\omega_0^2-\omega^2 &-\eta \\
-\eta &\omega_0^2-\omega^2
\end{bmatrix}
\begin{bmatrix}
C_1 \\
C_2
\end{bmatrix}
=\begin{bmatrix}
0 \\
0
\end{bmatrix}
$$

其有非平凡解的条件为：

$$
\begin{vmatrix}
\omega_0^2-\omega^2 &-\eta \\
-\eta &\omega_0^2-\omega^2
\end{vmatrix}
=0
\Longrightarrow
\omega_{\pm}
=\sqrt{\omega_0^2\pm \eta}
$$

相应的本征向量为：

$$
u_\pm
=\begin{bmatrix}
\frac{1}{\sqrt{2}} \\
\mp \frac{1}{\sqrt{2}}
\end{bmatrix}
$$

分别对应体系的二本征集体振动模式：

$$
\begin{bmatrix}
x_1(t) \\
x_2(t)
\end{bmatrix} 
=\mathrm{Re}
\bigg\{ \begin{bmatrix}
\frac{1}{\sqrt{2}} \\
\mp \frac{1}{\sqrt{2}}
\end{bmatrix} e^{\mathrm{i} \omega_{\pm} t} \bigg\}
$$

体系的一般解可以表示为此二本征解的线性组合：

$$
\begin{bmatrix}
x_1(t) \\
x_2(t)
\end{bmatrix}
=c_+\begin{bmatrix}
x_1(t) \\
x_2(t)
\end{bmatrix}
+c_-\begin{bmatrix}
x_1(t) \\
x_2(t)
\end{bmatrix}
$$

整理得：

$$
\begin{bmatrix}
x_1(t) \\
x_2(t)
\end{bmatrix}
=\begin{bmatrix}
\frac{1}{\sqrt{2}} &\frac{1}{\sqrt{2}} \\
\frac{1}{\sqrt{2}} &\frac{1}{\sqrt{2}}
\end{bmatrix}
\begin{bmatrix}
Q_+ \\
Q_-
\end{bmatrix}
$$

$Q_{\pm}=\mathrm{Re}\{ c_{\pm} e^{\mathrm{i}\omega_{\pm }t} \}$ 称为简正坐标

拉氏量可用简正坐标表达为：

$$
L
=\frac{1}{2}m\dot{Q}_+^2-\frac{1}{2}(k_0+\chi)Q_+^2+\frac{1}{2}\dot{Q}_-^2-\frac{1}{2}(k_0-\chi)Q_-^2
$$

此时运动方程退耦：

$$
\ddot{Q}_{+} +\omega_{+}^2 Q_{+}
=0,~~
\ddot{Q}_{-} +\omega_{-}^2Q_{-}
=0
$$

$$
U(q)
\equiv U(q_1,\cdots,q_s)
$$

设 $U(q_1,\cdots,q_s)$ 在 $(q_{10},q_{20},\cdots,q_{s0})$ 点为势能零点

把一系列自变量 $(q_1,\cdots,q_s)$ 简记为变量 $q$，把点 $(q_{10},q_{20},\cdots,q_{s0})$ 简记为点 $q_0$， 

多元函数泰勒展开：

$$
\begin{aligned}
U(q_1,q_2,\cdots,q_s)
&=U(q_{10},q_{20},\cdots,q_{s0})+\sum_{i=1}^{s} \frac{\partial U(q)}{\partial q_i}\bigg|_{q=q_{0}} (q_i-q_{i0})+\frac{1}{2}\sum_{i,j} \frac{\partial^2 U(q)}{\partial q_i q_j}\bigg|_{q=q_0}(q_i-q_{i0})(q_j-q_{j0}) \\
&=0+\frac{1}{2}\sum_{i,j} V_{ij} x_i x_j \\
&=\frac{1}{2}\sum_{i,j} V_{ij} x_i x_j
\end{aligned}
$$

动能一定可以表达为广义速度的二次型：

$$
\begin{aligned}
T
&=\sum_{i,j} \frac{1}{2}a_{ij}(q)\dot{q}_i\dot{q}_j \\
&=\sum_{i,j} \frac{1}{2}m_{ij} \dot{x}_i\dot{x}_j
\end{aligned}
$$

其中 $m_{ij}\equiv a_{ij}(q_0) $


$$
L
=\frac{1}{2}\sum_{i,j}(m_{ij}\dot{x}_i\dot{x}_j-V_{ij}x_ix_j)
$$

物理的稳定性要求 s 阶对称矩阵 $M$ 和 $V$ 为（半）正定矩阵

运动方程：

$$
\sum_{j=1}(m_{ij}\ddot{x}_j+V_{ij}x_j )
=0
$$

设 $\tilde{x}_i(t)=C_ie^{\mathrm{i}\omega t} $

$$
\sum_{j} (-\omega^2 m_{ij}+V_{ij})C_j
=0
$$

$$
[-\omega^2 M+V]\eta(\omega^2)
=0
$$

$$
\eta(\omega^2)
\equiv
\begin{bmatrix}
C_1 \\
C_2 \\
\vdots
\end{bmatrix}
$$

方程有非平凡解的条件为：

$$
|-m_{ij}\omega^2+V_{ij} |
=0
\Longleftrightarrow
|-M\omega^2 +V|
=0
$$

这个方程叫久期方程，满足该方程的 $\omega$ 的解称为简正频率

$$
\omega_\alpha^2>0,~~\alpha = 1,\cdots, s
$$

解向量 $\eta_\alpha$ 的正交性

$$
\begin{bmatrix}
x_1(t) \\
x_2(t) \\
\vdots
\end{bmatrix}
=\begin{bmatrix}
\eta_1 &\eta_2 &\cdots &\eta_s
\end{bmatrix}
\begin{bmatrix}
Q_1(t) \\
Q_2(t) \\
\vdots
\end{bmatrix}
$$

其中简正坐标 

在简正坐标下，拉氏量变为：

$$
L
=\sum_{\alpha=1}^{s} \frac{1}{2}(\dot{Q}_\alpha^2-\omega_\alpha^2 Q_\alpha^2)
$$



## 多自由度耦合谐振子

# 第8章 哈密顿正则力学

## 勒让德变换

### 多变量勒让德变换

考虑一个多变量函数 $f(q_1,\cdots,q_n;v_1,\cdots,v_m) $，设 $f $ 是变量 $v_1,\cdots,v_m $ 的凸函数，定义：

$$
p_i\equiv \frac{\partial f }{\partial v_i },\quad i=1,\cdots,m 
$$

由于 $f $ 是变量 $v_1,\cdots,v_m $ 的凸函数，因此 $p_i\equiv \partial f/\partial v_i $ 是关于 $v_i $ 的单调递增函数，于是从上式中必定可反解出

$$
v_i=v_i(p_i)
$$

则函数 $f $ 关于变量 $v_1,\cdots,v_n $ 的勒让德变换，记为 $f^\star(q_1,\cdots,q_n;p_1,\cdots,p_m) $，定义为：

$$
f^\star(q_1,\cdots,q_n;p_1,\cdots,p_m)
\equiv \sum_{i=1}^{m} p_i v_i(p_i) - f\left(q_1,\cdots,q_n;v_1(p_1),\cdots,v_n(p_n) \right)
$$

其中，$v_i(p_i) $ 是指用 $p_i $ 表达 $v_i $

#### 勒让德变换的性质

设 $f_i(t)$ 的勒让德变换是 $g_i(s)$

标度性质：

若 $f_2(t)=af_1(t)$，则 $g_2(s)=ag_1(\frac{s}{a})$

若 $f_2(t)=f_1(at)$，则 $g_2(s)=g_1(\frac{s}{a})$

平移性质：

若 $f_2(t)=f_1(t)+c$，则 $g_2(s)=g_1(s)-c$

若 $f_2(t)=f_1(t+c)$，则 $g_2(s)=g_1(s)-cs$

反函数性质：

若 $f_2(t)=f^{-1}(t)$，则 $g_2(s)=-sg_1(\frac{1}{p})$

若以广义坐标 $q$ 和广义速度 $\dot{q}$ 为自变量，力学体系的拉格朗日量 $L=L(q,\dot{q})$

### 拉格朗日量关于广义速度的勒让德变换——哈密顿量

一般地，拉格朗日量 $\mathcal{L} $ 是广义坐标、广义速度和时间的函数：

$$
\mathcal{L}
=\mathcal{L}\left(q_1,\cdots,q_n;\dot{q}_1,\cdots,\dot{q}_n;t \right)
$$

现在考虑拉格朗日量关于广义速度 $\dot{q}_1,\cdots,\dot{q}_n $ 的勒让德变换。

定义广义动量：

$$
p_i
\equiv \frac{\partial \mathcal{L} }{\partial \dot{q}_i } ,\quad i=1,2,\cdots,n
$$

拉格朗日量关于广义速度 $\dot{q}_1,\cdots,\dot{q}_n $ 的勒让德变换称为哈密顿量 $\mathcal{H}(q_1,\cdots,q_n;p_1,\cdots,p_n;t) $，定义为：

$$
\mathcal{H}\left(q_1,\cdots,q_n;p_1,\cdots,p_n;t \right)
\equiv \sum_{i=1}^{n} p_i \dot{q}_i(p_i) - \mathcal{L}\left(q_1,\cdots,q_n;\dot{q}_1(p_1),\cdots,\dot{q}_n(p_n);t \right),\quad
p_i\equiv \frac{\partial\mathcal{L} }{\partial \dot{q}_i } 
$$

### 哈密顿量正则运动方程

一方面，哈密顿量作为广义坐标和广义动量的函数，其微分在形式上可写为：

$$
\mathrm{d}\mathcal{H}\left(q_1,\cdots,q_n;p_1,\cdots,p_n;t \right)
=\frac{\partial\mathcal{H} }{\partial q_i } \mathrm{d}q_i + \frac{\partial\mathcal{H} }{\partial p_i } \mathrm{d}p_i + \frac{\partial \mathcal{H} }{\partial t } \mathrm{d}t
$$

另一方面，利用哈密顿量的定义

$$
\mathcal{H}\left(q_1,\cdots,q_n;p_1,\cdots,p_n;t \right)
\equiv \sum_{i=1}^{n} p_i \dot{q}_i(p_i) - \mathcal{L}\left(q_1,\cdots,q_n;\dot{q}_1(p_1),\cdots,\dot{q}_n(p_n);t \right),\quad
p_i\equiv \frac{\partial\mathcal{L} }{\partial \dot{q}_i } 
$$

以及广义动量的定义

$$
p_i\equiv \frac{\partial\mathcal{L} }{\partial \dot{q}_i }
$$

有：

$$
\begin{aligned}
\mathrm{d}\mathcal{H}\left(q_1,\cdots,q_n;p_1,\cdots,p_n;t \right)
&=\sum_{i=1}^{n} \left[\dot{q}_i(p_i)\mathrm{d}p_i + p_i\mathrm{d}\dot{q}_i(p_i) \right] - \sum_{i=1}^{n} \left(\frac{\partial\mathcal{L} }{\partial q_i }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} \mathrm{d}q_i + \frac{\partial\mathcal{L} }{\partial \dot{q}_i }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} \mathrm{d}\dot{q}_i(p_i) + \frac{\partial \mathcal{L} }{\partial t }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} \mathrm{d}t \right) \\
&=\sum_{i=1}^{n} \left[\dot{q}_i(p_i)\mathrm{d}p_i + p_i\mathrm{d}\dot{q}_i(p_i) \right] - \sum_{i=1}^{n} \left(\frac{\partial\mathcal{L} }{\partial q_i }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} \mathrm{d}q_i + p_i \mathrm{d}\dot{q}_i(p_i) + \frac{\partial \mathcal{L} }{\partial t }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} \mathrm{d}t \right) \\
&=\sum_{i=1}^{n}\left[\dot{q}_i(p_i)\mathrm{d}p_i - \frac{\partial\mathcal{L} }{\partial q_i }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} \mathrm{d}q_i - \frac{\partial \mathcal{L} }{\partial t }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} \mathrm{d}t \right]
\end{aligned}
$$

对比可得：

$$
\frac{\partial \mathcal{L} }{\partial t }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)}
=-\frac{\partial \mathcal{H} }{\partial t } 
$$

$$
\dot{q}_i
=\frac{\partial \mathcal{H}}{\partial p_i}
$$

$$
- \frac{\partial\mathcal{L} }{\partial q_i }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)}
=\frac{\partial\mathcal{H} }{\partial q_i }
$$

把上式代入取附加条件 $\dot{q}_i=\dot{q}_i(p_i) $ 后的E-L方程

$$
\frac{\partial\mathcal{L} }{\partial q_i }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} - \frac{\mathrm{d} }{\mathrm{d}t } \frac{\partial\mathcal{L} }{\partial\dot{q}_i }\bigg|_{\dot{q}_i=\dot{q}_i(p_i)} 
=0
$$

得到：

$$
\dot{p}_i = -\frac{\partial\mathcal{H} }{\partial q_i } 
$$

综上，哈密顿量正则运动方程为：

$$
\boxed{
\dot{q}_i=\frac{\partial\mathcal{H} }{\partial p_i } ,\quad
\dot{p}_i=-\frac{\partial\mathcal{H} }{\partial q_i }
}
$$

$H=E=T+V$

#### 泊松括号

$$
\{f,H \}
\equiv \sum_{\alpha} (\frac{\partial f}{\partial q_\alpha}\frac{\partial H}{\partial p_\alpha}-\frac{\partial f}{\partial p_\alpha}\frac{\partial H}{\partial q_\alpha})
$$

设 $f=f(q,p,t)$

$$
\begin{aligned}
\frac{\mathrm{d}f}{\mathrm{d}t}
&=\frac{\partial f}{\partial t}+\sum_{\alpha}(\frac{\partial f}{\partial q_\alpha}\dot{q}_\alpha+\frac{\partial f}{\partial p_\alpha}\dot{p}_\alpha) \\
&=\frac{\partial f}{\partial t}+\sum_{\alpha} (\frac{\partial f}{\partial q_\alpha}\frac{\partial H}{\partial p_\alpha}-\frac{\partial f}{\partial p_\alpha}\frac{\partial H}{\partial q_\alpha})
\end{aligned}
$$

利用泊松括号，可改写为：

$$
\frac{\mathrm{d}f}{\mathrm{d}t}
=\frac{\partial f}{\partial t}+\{f,H \}
$$

若 $f$ 为运动积分，则 $\frac{\mathrm{d}f}{\mathrm{d}t}=0 $；若进一步 $f$ 不显含时间，则 $\frac{\partial f}{\partial t}=0 $，于是可得到：

$$
\{f,H \}
=0
$$

注意到：

$$
\{q_\alpha,H \}
\equiv \sum_{\beta}(\frac{\partial q_\alpha}{\partial q_\beta}\frac{\partial H}{\partial p_\beta}-\frac{\partial q_\alpha}{\partial p_\beta}\frac{\partial H}{\partial q_\beta} )
=\frac{\partial H}{\partial p_\alpha}
$$

$$
\{p_\alpha,H \}
\equiv \sum_{\beta}(\frac{\partial p_\alpha}{\partial q_\beta}\frac{\partial H}{\partial p_\beta}-\frac{\partial p_\alpha}{\partial p_\beta}\frac{\partial H}{\partial q_\beta})
=-\frac{\partial H}{\partial q_\alpha}
$$

哈密顿方程用泊松括号可以表示为：

$$
\dot{q}_\alpha
=\{q_\alpha,H \}
$$

$$
\dot{p}_\alpha
=\{p_\alpha,H \}
$$

推广：

$$
\{f,g \}
\equiv \sum_{\alpha} (\frac{\partial f}{\partial q_\alpha}\frac{\partial g}{\partial p_\alpha}-\frac{\partial f}{\partial p_\alpha}\frac{\partial g}{\partial q_\alpha})
$$

泊松括号的性质：

（1）

$$
\{f,g \}
=-\{g,f \}
$$

$$
\{f,f \}
=0
$$

$$
\{f,c\}
=0
$$

$$
\{c_1f,c_2g\}
=c_1c_2\{f,g\}
$$

$$
\{f_1+f_2,g \}
=\{f_1,g\}+\{f_2,g\}
$$

$$
\begin{aligned}
\{f_1f_2,g\}
&=f_1\{f_2,g\}+\{f_1,g\}f_2 \\
&=f_1\{f_2,g\}+f_2\{f_1,g\}
\end{aligned}
$$

$$
\frac{\partial }{\partial t}\{f,g\}
=\{\frac{\partial f}{\partial t},g \}+\{f,\frac{\partial g}{\partial t} \}
$$

（2）

$$
\{f,q_\alpha\}
=-\frac{\partial f}{\partial p_\alpha}
$$

$$
\{f,p_\alpha \}
=\frac{\partial f}{\partial q_\alpha}
$$

（3）

$$
\{q_\alpha,q_\beta \}
=0
$$

$$
\{p_\alpha,p_\beta \}
=0
$$

$$
\{q_\alpha,p_\beta \}
=\delta_{\alpha\beta}
$$

（4）雅可比恒等式：

$$
\{f,\{g,h\}\}+\{g,\{h,f\}\}+\{h,\{f,g\}\}
=0
$$

**泊松定理**：若力学量 $f$ 和 $g$ 是运动积分，则它们的泊松括号 $\{f,g \} $ 也是运动积分

证明：

$$
\frac{\mathrm{d}f}{\mathrm{d}t}
=\frac{\partial f}{\partial t}+\{f,H \}
=0
$$

$$
\{f,H\}
=-\frac{\partial f}{\partial t}
$$

$$
\{g,H\}
=-\frac{\partial g}{\partial t}
$$

于是由雅可比恒等式，得：

$$
\begin{aligned}
\{H,\{f,g \}\}
&=-\{f,\{g,H \} \}-\{g,\{H,f \} \} \\
&=-\{f,-\frac{\partial g}{\partial t} \}-\{g,\frac{\partial f}{\partial t} \} \\
&=\{\frac{\partial f}{\partial t},g \}+\{f,\frac{\partial g}{\partial t} \} \\
&=\frac{\partial}{\partial t}\{f,g \}
\end{aligned}
$$

于是：

$$
\frac{\partial }{\partial t}\{f,g \}+\{\{f,g\},H \}
=0
$$

于是

$$
\frac{\mathrm{d}}{\mathrm{d}t}\{f,g\}
=\frac{\partial \{f,g\}}{\partial t}+\{\{f,g\},H \}
=0
$$

于是 $\{f,g \}$ 是运动积分

---

设力学系统的哈密顿量不显含时间，即 $H=H(p,q)$，则：

$$
\frac{\mathrm{d}H}{\mathrm{d}t}
=\frac{\partial H}{\partial t}+\{H,H \}
=0
$$

即 $H$ 是系统的一个运动积分

又设另一运动积分为 $\varphi(q,p,t)$，即 $\frac{\mathrm{d}\varphi}{\mathrm{d}t}=0$，而：

$$
\frac{\mathrm{d}\varphi}{\mathrm{d}t}
=\frac{\partial\varphi}{\partial t}+\{\varphi,H\}
$$

于是：

$$
\frac{\partial\varphi}{\partial t}
=-\{\varphi,H\}
$$

$\varphi$ 是运动积分，$H$ 是运动积分，由泊松定理，$\{\varphi,H \}$ 也是运动积分，于是 $\frac{\partial\varphi}{\partial t}
=-\{\varphi,H\}$ 也是运动积分

$\{\varphi,H\} $ 是运动积分，于是 $\frac{\mathrm{d}\{\varphi,H\}}{\mathrm{d}t}=0$，而：

$$
\begin{aligned}
\frac{\mathrm{d}\{\varphi,H\}}{\mathrm{d}t}
&=\frac{\partial {\{\varphi,H\}}}{\partial t}+\{\{\varphi,H\},H \} \\
&=-\frac{\partial^2 \varphi}{\partial t^2}+\{\{\varphi,H\},H \}
\end{aligned}
$$

$\{\varphi,H\}$ 是运动积分，$H$ 是运动积分，由泊松定理，$\{\{\varphi,H\},H \}$ 也是运动积分

于是 $\frac{\partial^2\varphi}{\partial t^2}=\{\{\varphi,H \},H \} $ 也是运动积分

以此类推，$\frac{\partial^k \varphi}{\partial t^k} $ 都是运动积分

例：

1）求直角坐标系动量各分量与角动量各分量的泊松括号

$$
\{f,p_\alpha\}
=\frac{\partial f}{\partial q_\alpha}
\Longrightarrow 
\left\{
\begin{aligned}
\{J_x,p_y \}
&=\frac{\partial J_x}{\partial y} \\
&=\frac{\partial (yp_z-zp_y)}{\partial y} \\
&=p_z \\
\{J_x,p_x\}
&=\frac{\partial J_x}{\partial x} \\
&=\frac{\partial (yp_z-zp_y)}{\partial x} \\
&=0
\end{aligned}
\right.
$$

一般地，

$$
\{J_i,p_j\}
=\sum_{k}\varepsilon_{ijk}p_k
$$

2）求直角坐标系矢径各分量与角动量各分量的泊松括号

$$
\{J_i,x_j\}
=\sum_{k}\varepsilon_{ijk}x_k
$$

3）求角动量各分量的泊松括号

$$
\{J_i,J_j\}
=\sum_{k}\varepsilon_{ijk}J_k
$$

## 正则变换

#### 正则变换

若变换 $Q=Q(q,p,t)$ 和 $P=P(q,p,t)$ 得到新哈密顿量 $H'(Q,P,t)$，它保持体系运动方程形式不变，即：

$$
\dot{Q}_\alpha
=\frac{\partial H'}{\partial P_\alpha},~~
\dot{P}_\alpha
=-\frac{\partial H'}{\partial Q_\alpha}
$$

则称该变换为正则变换

一个变换是正则变换等价于要求该变换保持泊松括号，即对于两个函数 $f,g$，有：

$$
\{f,g \}_{q,p}
=\{f,g \}_{Q,P}
$$

#### 正则变换的生成函数

$\sum p\dot{q}-H$ 和 $\sum P\dot{Q}-H'$ 对应等价的拉式量，两者相差某个函数对时间的全导数：

$$
\sum_{\alpha}p_\alpha\dot{q}_\alpha-H
=\sum_{\alpha}P_\alpha\dot{Q}_\alpha-H'+\frac{\mathrm{d}F}{\mathrm{d}t}
$$

即：

$$
\mathrm{d}F
=\sum_{\alpha}p_\alpha\mathrm{d}q_\alpha-\sum_{\alpha}P_\alpha\mathrm{d}Q_\alpha-(H-H')\mathrm{d}t \tag{1}
$$

$F$ 称为正则变换的生成函数

从微分式可以看出：

$$
\frac{\partial F}{\partial q_\alpha}
=p_\alpha,~~
\frac{\partial F}{\partial Q_\alpha}
=P_\alpha
$$

$F=F(p,q,P,Q,t)$ 有 $2s$ 个独立变量

$2s$ 个独立变量可按以下四种方式选择：

$$
F_1(q,Q,t),F_2(q,P,t),F_3(p,Q,t),F_4(p,P,t)
$$

$$
\frac{\mathrm{d}F_1}{\mathrm{d}t}
=\sum_{\alpha}(\frac{\partial F_1}{\partial q_\alpha}\dot{q}_\alpha+\frac{\partial F_1}{\partial Q_\alpha}\dot{Q}_\alpha)+\frac{\partial F_1}{\partial t}
$$

代入 $(1)$ 得：

$$
\sum_{\alpha}\bigg[\dot{q}_\alpha(p_\alpha-\frac{\partial F_1}{\partial q_\alpha})-(P_\alpha+\frac{\partial F_1}{\partial Q_\alpha})\dot{Q}_\alpha\bigg]-(H-H'+\frac{\partial F}{\partial t}) 
=0
$$

判断一个变换 $(p,q)\to(P,Q)$ 是否为正则变换得三种方法：

（1）考察对应的 $2s\times 2s$ 的雅可比矩阵 $J\equiv \frac{\partial (P,Q)}{\partial(p,q)}$。这个变换是正则变换当且仅当 $J$ 满足：

$$
J\mathbb{E}J^T
=\mathbb{E}
$$

其中，$\mathbb{E}$ 是 $2s\times 2s$ 的一个分块矩阵：

$$
\mathbb{E}
\equiv\begin{bmatrix}
0&\mathbb{I} \\
\mathbb{I} &0
\end{bmatrix}
$$

其中，$\mathbb{I}$ 是 $s\times s$ 的单位矩阵

（2）直接验证泊松括号：

$$
\{P_i,P_j \}
=0,~~
\{Q_i,Q_j \}
=0,~~ 
\{Q_i,P_j \}
=\delta_{ij}
$$

（3）验证 $\sum p\mathrm{d}q-\sum P\mathrm{d}Q $ 能否写成某个函数的全微分的形式

#### 刘维尔定理

刘维尔定理：在哈密顿系统的动力学过程中，相体积保持不变

证明：

$$
\int\cdots\int \mathrm{d}Q_1\cdots\mathrm{d}Q_s\mathrm{d}P_1\cdots\mathrm{d}P_s
=\int\cdots\int\bigg|\frac{\partial(Q_1,\cdots,Q_s,P_1,\cdots,P_s)}{\partial (q_1,\cdots,q_s,p_1,\cdots,p_s)}\bigg|\mathrm{d}q_1\cdots\mathrm{d}q_s\mathrm{d}p_q\mathrm{d}p_s
$$

注意到，在正则变换下：

$$
\begin{aligned}
\frac{\partial(Q_1,\cdots,Q_s,P_1,\cdots,P_s)}{\partial (q_1,\cdots,q_s,p_1,\cdots,p_s)}
&=\frac{\partial(Q_1,\cdots,Q_s,P_1,\cdots,P_s)}{\partial(q_1,\cdots,q_s,P_1,\cdots,P_s)}\cdot \frac{\partial(q_1,\cdots,q_s,P_1,\cdots,P_s)}{\partial(q_1,\cdots,q_s,p_1,\cdots,p_s)} \\
&=\frac{\partial (Q_1,\cdots,Q_s)}{\partial(q_1,\cdots,q_s)}\cdot\frac{\partial(P_1,\cdots,P_s)}{\partial(p_1,\cdots,p_s)}
\end{aligned}
$$

反正 $D=1$

下面推导系统在遵循经典运动方程的条件下，作用量作为终点的广义坐标和时间的函数应当满足的微分形式。考察作用量的变分 $\delta S$：

$$
\delta S
=\frac{\partial L}{\partial \dot{q}}\delta q\bigg|_{t_0}^{t_1}+\int_{t_0}^{t_1}(\frac{\partial L}{\partial q}-\frac{\mathrm{d}}{\mathrm{d}t}\frac{\partial L}{\partial \dot{q}})\delta q\mathrm{d}t
=\frac{\partial L}{\partial \dot{q}}\delta q\bigg|_{t_0}^{t_1}
$$

### 微分形式

外积与外代数

外积满足反交换律：

$$
dx\wedge dy=-dy\wedge dx
$$

反交换律的一个直接结论：

$$
dx \wedge dx = -dx \wedge dx = 0
$$

$$
dy \wedge dy = -dy \wedge dy = 0
$$

积分微元在坐标变换下有：

$$
\begin{aligned}
dx \wedge dy
&=(\frac{\partial x}{\partial x'}dx'+\frac{\partial x}{\partial y'}dy') \wedge (\frac{\partial y}{\partial x'}dx'+\frac{\partial y}{\partial y'}dy') \\
&=\frac{\partial x}{\partial x'}\frac{\partial y}{\partial y'}dx' \wedge dy'+\frac{\partial x}{\partial y'}\frac{\partial y}{\partial x'}dy' \wedge dx' \\
&=(\frac{\partial x}{\partial x'}\frac{\partial y}{\partial y'}dx'-\frac{\partial x}{\partial y'}\frac{\partial y}{\partial x'})dx' \wedge dy' \\
&=\bigg|\frac{\partial(x,y)}{\partial (x',y')} \bigg|dx' \wedge dy'
\end{aligned}
$$

推广到$n$元函数积分，只要将$n$重积分微元$dx^1dx^2\cdots dx^n$理解为外代数$dx^1 \wedge dx^2 \wedge \cdots \wedge dx^n ,$它们满足：

$$
dx^i \wedge dx^j = -dx^j \wedge dx^i
$$

我们将被积函数$f(x^1,x^2,\cdots,x^n) $和$dx^1 \wedge dx^2 \wedge \cdots \wedge dx^n$乘在一起称为一个$n$重微分形式，简称为$n$形式，记为 $\omega$

$$
\omega
=f(x^1,\cdots,x^n)dx^1\wedge \cdots \wedge dx^n
$$

则$n$元函数的$n$重积分就是对 $n$ 微分形式 $\omega$ 的积分，记为：

$$
A=\int \omega
$$

对于 $n$ 个变量的情形，可以定义 $k$-形式 $\alpha,$即 $k$ 重微分形式 $\alpha ,(0\leqslant k\leqslant n),\alpha$ 的定义是：

$$
\alpha
=\frac{1}{k!}\alpha_{i_1 i_2\cdots i_k} dx^{i_1}\wedge dx^{i_2}\cdots\wedge dx^{i_k}
$$


上面的定义式用到了爱因斯坦求和约定，即：默认对一个表达式中，同时作为上指标和下指标出现的那些指标所有可能的取值进行求和；其中，所有指标，即**虚拟变量** $i_1,i_2,\cdots,i_k$ 的取值都是从 $1$ 到 $n$ 的正整数，且所有指标都同时作为上指标和下指标出现

我们称 $\alpha_{i_1 i_2 \cdots i_k} $为 $k$ 形式 $\alpha$ 的一个分量

现在根据外代数的性质来考察 $k$ 形式 $\alpha$ 的性质：

首先，$i_1,i_2,\cdots,i_k$的取值都是从 $1 $ 到 $n$ 的正整数.根据乘法原理，有序数组$(i_1,i_2,\cdots,i_k)$共有 $n^k$ 种不同的取法.设 $i_1,i_2,\cdots,i_k$的一组特定的取值为：

$$
(i_1,i_2,\cdots,i_k)=(a_1,a_2,\cdots,a_k)
$$

其中，$a_j\in[1,n],a_j\in N^+,(j=1,\cdots,k)$

若：$a_1,a_2,\cdots,a_k$ 中至少有两个变量的取值相同，则根据外代数的反交换性，有：

$$
dx^{a_1}\wedge dx^{a_2}\wedge\cdots\wedge dx^{a_k}=0
$$

那么在最终的求和式 $\alpha$ 中，这类至少有两个虚拟变量的取值相同的取法：$(i_1,i_2,\cdots,i_k)=(a_1,a_2,\cdots,a_k)$ 所对应的 $\alpha_{a_1a_2\cdots a_k}dx^{a_1}\wedge dx^{a_2}\wedge\cdots\wedge x^{a_k} $ (注意，这里$a_1,\cdots,a_k$不是虚拟变量，而是一系列常数，因此**没有用到爱因斯坦求和约定**)的贡献为零

当 $k>n$ 时，$i_1,\cdots,i_k$ 的取值必定重复，故任何 $k>n$ 的 $k$ 形式都必定为零

规定：$k $ 形式 $\alpha$ 的分量 $\alpha_{i_1\cdots i_k} $ 关于 $k$ 个下指标两两反对称，称之为全反对称

举几个例子：

$$
\alpha_{123}=-\alpha_{213} \\
\alpha_{123}=-\alpha_{321} \\
\alpha_{123}= \alpha_{312}
$$

最终，我们可以理解 $\frac{1}{k!}$ 是怎么来的了：为了消除双重反对称性导致的对称性所带来的排列引起的不便

### 3维空间中的微分形式

0重微分形式：

$$
f(x,y,z)
$$

1重微分形式：

$$
a_1dx+a_2dy+a_3dz
$$

2重微分形式：

$$
a_{12}dx\wedge dy+a_{23}dy\wedge dz+a_{31}dz\wedge dx
$$

定义面积元矢量：

$$
d\vec{S}=(dy\wedge dz,dz\wedge dx,dx\wedge dy   )
$$

3重微分形式：

$$
f(x,y,z)dx\wedge dy\wedge dz
$$

### 外微分

3维空间1形式：$a=a_xdx+a_ydy+a_zdz=\vec{a}\cdot d\vec{x}$

定义外微分运算：

$$
da
=da_x\wedge dx+da_y\wedge dy+da_z\wedge dz
$$

记$\frac{\partial }{\partial x}=\partial_x,$表示对$x$的偏微分，例如：$\frac{\partial a_x}{\partial x}=\partial_x a_x$

于是，由链式法则，结合外代数性质，有：

$$

\begin{aligned}

da
&=da_x\wedge dx+da_y\wedge dy+da_z\wedge dz \\
&=(\partial_x a_xdx+\partial_y a_xdy+\partial_z a_xdz )\wedge dx+(\partial_x a_ydx+\partial_y a_ydy+\partial_z a_ydz )\wedge dy
+(\partial_x a_zdx+\partial_y a_zdy+\partial_z a_zdz )\wedge dz \\
&=(\partial_x a_y-\partial_y a_x) dx\wedge dy +(\partial_y a_z-\partial_z a_y) dy\wedge dz +(\partial_z a_x-\partial_x a_z) dz\wedge dx

\end{aligned}

$$

$$
\vec{a}\cdot d\vec{x}=da=(\nabla\times \vec{a})\cdot d\vec{S}
$$

3维空间斯托克斯公式：

$$
\int_{\partial D} \vec{a}\cdot d\vec{x}
=\int_D (\nabla\times \vec{a})\cdot d\vec{S}
$$

于是利用外微分的运算结果，可以把3维空间斯托克斯公式写成：

$$
\int_{\partial D} a
=\int_D da 
$$

# 罗斯函数和罗斯运动方程

## 罗斯函数

在拉格朗日力学中，拉格朗日量是广义坐标、广义速度和时间的函数：

$$
\mathcal{L}
=\mathcal{L}\left(q,\dot{q},t \right)
$$

在哈密顿力学中，哈密顿量是广义坐标、广义动量和时间的函数：

$$
\mathcal{H}
=\mathcal{H}\left(q,p,t \right)
$$

二者由勒让德变换联系：

$$
\mathcal{H}\left(q,p,t \right)
=p_i \dot{q}_i(p_i)  - \mathcal{L}\left(q,\dot{q}\left(p \right),t \right),\quad
p_i\equiv \frac{\partial\mathcal{L} }{\partial \dot{q}_i } 
$$

具体来说，拉式量关于所有广义速度的勒让德变换就是哈密顿量。拉格朗日力学中体系的运动方程是E-L方程，哈密顿力学中体系的运动方程是哈密顿正则运动方程。

拉式量关于部分广义速度的勒让德变换就是罗斯函数（Routhian）。

考虑有 $n+s $ 个自由度的体系，选取 $n $ 个广义坐标 $q_1,\cdots,q_n $ 和 $s $ 个广义坐标 $\xi_1,\cdots,\xi_s $ ，在拉格朗日力学中，对应有 $n $ 个广义速度 $\dot{q}_1,\cdots,\dot{q}_n $ 和 $s $ 个速度 $\dot{\xi}_1,\cdots,\dot{\xi}_n .$

系统的拉式量是所有广义坐标和广义速度的函数（也可能显含时间）：

$$
\mathcal{L}
=\mathcal{L}\left(q_1\cdots,q_n, \xi_1, \cdots,\xi_s; \dot{q}_1,\cdots\dot{q}_n, \dot{\xi}_1,\cdots,\dot{\xi}_s; t \right)
$$

现在对拉式量关于广义速度 $\dot{\xi}_{1},\cdots,\dot{\xi}_s $ 作勒让德变换，就得到罗斯函数：

$$
\mathcal{R}\left(q_1,\cdots,q_n,\xi_1,\cdots,\xi_s; \dot{q}_1,\cdots,\dot{q}_n,p_1,\cdots,p_s; t \right)
\equiv \sum_{i=1}^{s} p_i \dot{\xi}_i\left(p_i \right) - \mathcal{L}\left(q_1\cdots,q_n, \xi_1, \cdots,\xi_s; \dot{q}_1,\cdots\dot{q}_n, \dot{\xi}_1(p_1),\cdots,\dot{\xi}_s(p_s); t \right)
$$

其中

$$
p_i\equiv \frac{\partial\mathcal{L} }{\partial \xi_i } ,\quad i=1,2,\cdots,s
$$

## 罗斯运动方程

一方面，罗斯函数的微分在形式上可写为：

$$
\mathrm{d}\mathcal{R}
=\frac{\partial \mathcal{R} }{\partial q_i } \mathrm{d}q_i + \frac{\partial \mathcal{R} }{\partial \xi_i } \mathrm{d}\xi_i + \frac{\partial \mathcal{R} }{\partial \dot{q}_i } \mathrm{d}\dot{q}_i + \frac{\partial \mathcal{R} }{\partial p_i } \mathrm{d}p_i + \frac{\partial \mathcal{R} }{\partial t } \mathrm{d}t
$$

另一方面，由罗斯函数的定义，以及广义动量的定义 $p_i\equiv \partial\mathcal{L}/\partial\dot{\xi}_i $，有：

$$
\begin{aligned}
\mathrm{d}\mathcal{R}
&=\dot{\xi}_i(p_i)\mathrm{d}p_i + p_i \mathrm{d}\dot{\xi}_i(p_i) - \left(\frac{\partial\mathcal{L} }{\partial q_i } \mathrm{d}q_i + \frac{\partial \mathcal{L}}{\partial \xi_i }\mathrm{d}\xi_i + \frac{\partial\mathcal{L} }{\partial \dot{q}_i } \mathrm{d}\dot{q}_i + \frac{\partial\mathcal{L} }{\partial \dot{\xi}_i } \mathrm{d}\xi_i(p_i) + \frac{\partial\mathcal{L} }{\partial t } \mathrm{d}t  \right) \\
&=- \frac{\partial\mathcal{L} }{\partial q_i } \mathrm{d}q_i - \frac{\partial \mathcal{L}}{\partial \xi_i } \mathrm{d}\xi_i - \frac{\partial\mathcal{L} }{\partial \dot{q}_i } \mathrm{d}\dot{q}_i + \dot{\xi}_i(p_i)\mathrm{d}p_i - \frac{\partial\mathcal{L} }{\partial t } \mathrm{d}t \\
\end{aligned}
$$

对比可得：

$$
\frac{\partial \mathcal{R} }{\partial q_i } = - \frac{\partial\mathcal{L} }{\partial q_i },\quad
\frac{\partial \mathcal{R} }{\partial \xi_i } = - \frac{\partial \mathcal{L}}{\partial \xi_i },\quad
\frac{\partial \mathcal{R} }{\partial \dot{q}_i } = - \frac{\partial\mathcal{L} }{\partial \dot{q}_i },\quad
\frac{\partial \mathcal{R} }{\partial p_i } = \dot{\xi}_i(p_i),\quad
\frac{\partial \mathcal{R} }{\partial t } = - \frac{\partial\mathcal{L} }{\partial t }
$$

由广义动量的定义和E-L方程

$$
p_i
\equiv \frac{\partial\mathcal{L} }{\partial\dot{\xi}_i } ,\quad
\frac{\partial \mathcal{L} }{\partial q_i } - \frac{\mathrm{d} }{\mathrm{d}t } \frac{\partial\mathcal{L} }{\partial \dot{q}_i } 
=0,\quad
\frac{\partial \mathcal{L} }{\partial \xi_i } - \frac{\mathrm{d} }{\mathrm{d}t } \frac{\partial\mathcal{L} }{\partial \dot{\xi}_i } 
=0
$$

得到罗斯运动方程：

$$
\frac{\partial \mathcal{R} }{\partial q_i } - \frac{\mathrm{d} }{\mathrm{d}t } \frac{\partial \mathcal{R} }{\partial\dot{q}_i } 
=0,\quad i=1,2,\cdots,n
$$

$$
\dot{p}_i = - \frac{\partial \mathcal{R} }{\partial \xi_i } ,\quad i=1,2,\cdots,s
$$

$$
\dot{\xi}_i = \frac{\partial \mathcal{R} }{\partial p_i } ,\quad i=1,2,\cdots,s
$$

## 有效拉格朗日量



