> 最后更新于 2024/12/11
> markdown源文件请见：https://github.com/BeiHai0/Surviving-LZU-Physics/tree/master/%E5%B0%8F%E7%8F%AD%E8%AE%B2%E4%B9%89/%E6%95%B0%E5%AD%A6%E7%89%A9%E7%90%86%E6%96%B9%E6%B3%951%E5%B0%8F%E7%8F%AD%E8%AE%B2%E4%B9%89

[TOC]

# 第1章 $\R^3$ 空间的向量分析

## 向量分析基本知识

### 爱因斯坦求和约定

在同一代数项中见到两个重复指标 $i$ 就自动进行求和（除非特别指出该重复指标不求和），我们称求和指标 $i$ 为“哑标”。

比如，$\R^3 $ 空间中的向量 $\vec{A}\in \R^3 $ 在直角坐标下可表示为：

$$
\vec{A}
=A_1\vec{\mathrm{e}}_1+A_2\vec{\mathrm{e}}_2+A_3\vec{\mathrm{e}}_3
\equiv \sum_{i} A_i \vec{\mathrm{e}}_i
$$

其中，$\vec{\mathrm{e}}_1,\vec{\mathrm{e}}_2,\vec{\mathrm{e}}_3 $ 分别是 $x,y,z $ 轴正方向上的单位向量。

可利用爱因斯坦求和约定将 $\vec{A}\in \R^3 $ 简写为：

$$
\vec{A}
=\sum_{i} A_i \vec{\mathrm{e}}_i
\to
\vec{A}
=A_i \vec{\mathrm{e}}_i
$$

这样就省去了写求和符号的工作。 

### Kronecher delta 符号 $\delta_{ij} $

$$
\delta_{ij}
=\begin{cases}
1&,i=j \\
0&,i\ne j
\end{cases}
$$

### 三阶单位全反对称张量（三阶 Levi-Citita 符号）$\varepsilon_{ijk} $

$$
\varepsilon_{ijk}
=\begin{cases}
1&,ijk=123,231,312,即相邻两指标经过偶次对换能还原到123 \\
-1&,ijk=132,213,321,即相邻两指标经过奇次对换能还原到123 \\
0&,ijk中有相同指标 \\
\end{cases}
$$

可以利用 $\varepsilon_{ijk} $ 表示任何一个三阶行列式：

$$
\begin{vmatrix}
a_1 &a_2 &a_3 \\
b_1 &b_2 &b_3 \\
c_1 &c_2 &c_3
\end{vmatrix}
=\varepsilon_{ijk} a_i b_j c_k
$$

### 一些简单算例

$\vec{\mathrm{e}}_i\cdot\vec{\mathrm{e}}_j=\delta_{ij} $

$A_{i}\delta_{ij}=A_j $

$\vec{A}\cdot\vec{B}=A_i B_i $

$$
\vec{A}\cdot\vec{B}
=(A_i\vec{\mathrm{e}}_i)\cdot (B_j\vec{\mathrm{e}}_j)
=A_i B_j\vec{\mathrm{e}}_i\cdot \vec{\mathrm{e}}_j
=A_i B_j \delta_{ij}
=A_i B_i
$$

$\vec{A}\times\vec{B}=\varepsilon_{ijk}\vec{\mathrm{e}}_i A_j B_k $

$$
\vec{A}\times\vec{B}
=\begin{vmatrix}
\vec{\mathrm{e}}_1 &\vec{\mathrm{e}}_2 &\vec{\mathrm{e}}_3 \\
A_1 &A_2 &A_3 \\
B_1 &B_2 &B_3
\end{vmatrix}
=\varepsilon_{ijk} \vec{\mathrm{e}}_i A_j B_k
$$

### 梯度、散度、旋度

#### 梯度（gradient）的定义

设 $\psi(\vec{r}) $ 是标量场，$\psi(\vec{r}) $ 其梯度，记为 $\mathrm{grad}~\psi(\vec{r}) $，由下式定义：

$$
\mathrm{grad}~\psi(\vec{r})\cdot\mathrm{d}\vec{r}
=\mathrm{d}\psi(\vec{r})
$$

其中，$\mathrm{d}\vec{r} $ 是位矢 $\vec{r} $ 的微小变化，$\mathrm{d}\psi(\vec{r}) $ 是标量场 $\psi(\vec{r}) $ 因位矢 $\vec{r} $ 变化 $\mathrm{d}\vec{r} $ 而引起的相应的变化。具体来说，$\mathrm{d}\psi(\vec{r}) $ 的定义为：

$$
\mathrm{d}\psi(\vec{r})
\equiv \psi(\vec{r}+\mathrm{d}\vec{r})-\psi(\vec{r})
$$

#### 散度（divergence）的定义

向量场 $\vec{A} $ 的散度，记为 $\mathrm{div}~\vec{A} $，定义为：

$$
\mathrm{div}~\vec{A}
\equiv \lim_{V\to 0^+} \frac{1 }{V } \oint\limits_{\partial V^+} \vec{A}\cdot\mathrm{d}\vec{S}
$$

#### 旋度（curl）的定义

向量场 $\vec{A} $ 的旋度，记为 $\mathrm{curl}~\vec{A} $，由下式定义：

$$
\left(\mathrm{curl}~\vec{A} \right)\cdot \vec{n}
=\lim_{\sigma\to 0^+} \frac{1 }{\sigma } \oint\limits_{\partial \sigma^+} \vec{A}\cdot\mathrm{d}\vec{l}
$$

其中，$\sigma $ 是与 $\vec{n} $ 垂直的面元。$\vec{n} $ 与面元 $\sigma $ 的正绕行方向满足右手定则。

#### 直角坐标系下的梯度、散度、旋度

这里直接给出结论。

$$
\mathrm{grad}~\psi
=\vec{\mathrm{e}}_i\partial_i\psi
$$

$$
\mathrm{div}~\vec{A}
=\partial_i A_i
$$

$$
\mathrm{curl}~\vec{A}
=\varepsilon_{ijk}\vec{\mathrm{e}}_i \partial_j A_k
$$

#### $\nabla $ 算子

$\nabla $ 算子（nabla 算子，或 del 算子）定义为：

$$
\nabla
\equiv \vec{\mathrm{e}}_i\partial_i
$$

其中，$\partial_i $ 的定义为：

$$
\partial_i\equiv \frac{\partial }{\partial x_i} 
$$

利用 $\nabla $ 算子，可将梯度、散度、旋度表示为：

$$
\mathrm{grad}~\psi
=\vec{\mathrm{e}}_i\partial_i \psi
\equiv \nabla \psi
$$

$$
\mathrm{div}~\vec{A}
=\partial_i A_i
\equiv \nabla\cdot \vec{A}
$$

$$
\mathrm{curl}~\vec{A}
=\varepsilon_{ijk}\vec{\mathrm{e}}_i \partial_j A_k
\equiv \nabla\times \vec{A}
$$

为了书写方便，以后用 $\nabla\psi,\nabla\cdot\vec{A},\nabla\times\vec{A} $ 分别来指代梯度、散度、旋度。

### 梯度与方向导数的关系

#### 方向导数

标量场 $\psi $ 在 $\vec{r} $ 点处沿 $\vec{v} $ 方向的方向导数，记为 $\displaystyle{\frac{\partial \psi(\vec{r}) }{\partial l }\bigg|_{\vec{v}}  }$，定义为：

$$
\frac{\partial \psi(\vec{r}) }{\partial l }\bigg|_{\vec{v}}
\equiv \lim_{v\to 0^+} \frac{\psi(\vec{r} + \vec{v}) - \psi(\vec{r}) }{v } 
$$

特别地，标量场 $\psi $ 在曲面 $\Sigma $ 上的 $\vec{r} $ 点处沿曲面上 $\vec{r} $ 点的外法向的方向导数简记为：

$$
\frac{\partial\psi(\vec{r}) }{\partial n } 
$$

#### 梯度和方向导数的关系

标量场的梯度的定义：

$$
\nabla\psi\cdot\mathrm{d}\vec{r}
=\mathrm{d}\psi
$$

设 $\mathrm{d}\vec{r} = \vec{n} \mathrm{d}r $，其中 $\vec{n} $ 是与 $\mathrm{d}\vec{r} $ 同向的单位向量，则有：

$$
(\nabla\psi)\cdot\vec{n} \mathrm{d}r
=\mathrm{d}\psi
$$

即：

$$
(\nabla\psi)\cdot\vec{n}
=\frac{\mathrm{d}\psi }{\mathrm{d}r }
=\frac{\psi(\vec{r}+\mathrm{d}\vec{r}) - \psi(\vec{r}) }{\mathrm{d}r }
=\frac{\partial \psi(\vec{r}) }{\partial l }\bigg|_{\vec{n}}   
$$

这就是说，标量场 $\psi $ 的梯度 $\nabla\psi $ 在某一方向 $\vec{n} $ 的投影恰等于标量场沿这一方向 $\vec{n} $ 的方向导数 $\displaystyle{\frac{\partial \psi(\vec{r}) }{\partial l }\bigg|_{\vec{n}}  }$。

### 散度与高斯定理

从散度的定义

$$
\nabla\cdot\vec{A}
\equiv \lim_{V\to 0^+} \frac{1 }{V } \oint\limits_{\partial V^+} \vec{A}\cdot\mathrm{d}\vec{S}
$$

出发，可以导出高斯定理：

$$
\oint\limits_{\partial V^+} \vec{A}\cdot\mathrm{d}\vec{S}
=\int\limits_{V} (\nabla\cdot\vec{A})\mathrm{d}V
$$

### 旋度与斯托克斯定理

从旋度的定义

$$
\left(\nabla\times\vec{A} \right)\cdot \vec{n}
=\lim_{\sigma\to 0^+} \frac{1 }{\sigma } \oint\limits_{\partial \sigma^+} \vec{A}\cdot\mathrm{d}\vec{l}
$$

出发，可以导出斯托克斯定理：

$$
\oint\limits_{\partial\Sigma^+}\vec{A}\cdot\mathrm{d}\vec{l}
=\int\limits_{\Sigma} (\nabla\times\vec{A})\cdot\mathrm{d}\vec{S}
$$

## $\R^3 $ 空间中向量分析常用公式

### 分析工具

$$
\left\{
\begin{aligned}
&\vec{\mathrm{e}}_i\cdot\vec{\mathrm{e}}_j=\delta_{ij} \\
&\vec{A} = A_i\vec{\mathrm{e}}_i \\
&A_{i}\delta_{ij}=A_j \\
&\vec{A}\cdot\vec{B}=A_i B_i \\
&\vec{A}\times\vec{B}=\varepsilon_{ijk}\vec{\mathrm{e}}_i A_j B_k \\
&(\vec{A}\times\vec{B})_l = \varepsilon_{ljk} A_j B_k \\
&\nabla\psi = \vec{\mathrm{e}}_i\partial_i \\
&\nabla\cdot\vec{A}=\partial_i A_i \\
&\nabla\times\vec{A} = \varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j A_k \\
&\partial_i \psi = (\nabla\psi)_i \\
&\nabla^2 \equiv \nabla\cdot \nabla = \partial_i \partial_i \\
&\nabla^2\psi\equiv \nabla\cdot(\nabla\psi)=\partial_i\partial_i \psi \\
&\nabla^2\vec{A}\equiv (\nabla^2 A_i)\vec{\mathrm{e}}_i \\
&\varepsilon_{ijk} = \varepsilon_{jki} = \varepsilon_{kij} \\
&\varepsilon_{ijk}\varepsilon_{ilm} = \delta_{jl}\delta_{km} - \delta_{jm}\delta_{kl} \\
&\partial_i x_j = \delta_{ij}
\end{aligned}
\right.
$$

### $\R^3 $ 空间中重要微分恒等式

#### 与 $\vec{r} $ 有关的公式

> $\nabla\cdot\vec{r}=3 $

$$
\begin{aligned}
\nabla\cdot\vec{r}
=\partial_i x_i
=3
\end{aligned}
$$

> $\nabla\times\vec{r}=\vec{0} $

$$
\begin{aligned}
\nabla\times\vec{r}
=\varepsilon_{ijk}\vec{\mathrm{e}}_i\partial_j x_k
=\varepsilon_{ijk}\vec{\mathrm{e}}_i \delta_{jk}
=\vec{0}
\end{aligned}
$$

#### 从左往右证的公式

> $\nabla(\varphi\psi)=\varphi\nabla\psi+\psi\nabla\varphi $

$$
\begin{aligned}
\nabla(\varphi\psi)
&=\vec{\mathrm{e}}_i\partial_i(\varphi\psi) \\
&=\vec{\mathrm{e}}_i\varphi\partial_i\psi + \vec{\mathrm{e}}_i\psi\partial_i\varphi \\
&=\varphi\vec{\mathrm{e}}_i\partial_i\psi + \psi\vec{\mathrm{e}}_i\partial_i\varphi \\
&=\varphi\nabla\psi + \psi\nabla\varphi
\end{aligned}
$$

> $\nabla\cdot(\varphi\vec{A})=\vec{A}\cdot(\nabla\varphi) + \varphi\nabla\cdot\vec{A} $

$$
\begin{aligned}
\nabla\cdot(\varphi\vec{A})
&=\partial_i(\varphi \vec{A})_i \\
&=\partial_i(\varphi A_i) \\
&=\varphi\partial_i A_i + A_i\partial_i \varphi \\
&=\varphi\nabla\cdot\vec{A} + (\vec{A}\cdot\nabla)\varphi \\
&=(\vec{A}\cdot\nabla)\varphi + \varphi\nabla\cdot\vec{A}
\end{aligned}
$$

> $\nabla\times(\varphi\vec{A})=(\nabla\varphi)\times\vec{A} + \varphi \nabla\times\vec{A} $

$$
\begin{aligned}
\nabla\times(\varphi\vec{A})
&=\varepsilon_{ijk}\vec{\mathrm{e}}_i\partial_j (\varphi\vec{A})_k \\
&=\varepsilon_{ijk}\vec{\mathrm{e}}_i \partial_j(\varphi A_k) \\
&=\varepsilon_{ijk}\vec{\mathrm{e}}_i (A_k\partial_j \varphi + \varphi\partial_j A_k) \\
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i(\nabla\varphi)_j A_k + \varphi \varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j A_k \\
&=(\nabla\varphi)\times \vec{A} + \varphi \nabla\times\vec{A}
\end{aligned}
$$

> $\nabla\cdot (\vec{A}\times\vec{B} )=\vec{B}\cdot(\nabla\times\vec{A})-\vec{A}\cdot(\nabla\times\vec{B}) $

$$
\begin{aligned}
\nabla\cdot (\vec{A}\times\vec{B} )
&=\partial_i (\vec{A}\times\vec{B})_i \\
&=\partial_i (\varepsilon_{ijk} A_j B_k) \\
&=\varepsilon_{ijk}\partial_i ( A_j B_k) \\
&=\varepsilon_{ijk} B_k\partial_i A_j + \varepsilon_{ijk} A_j \partial_i B_k \\
&=B_k \varepsilon_{kij} \partial_i A_j - A_j \varepsilon_{jik} \partial_i B_k \\
&=B_k (\nabla\times \vec{A})_k - A_j (\nabla\times \vec{B})_j \\
&=\vec{B}\cdot(\nabla\times \vec{A}) - \vec{A}\cdot(\nabla\times\vec{B})
\end{aligned}
$$

> $\nabla\times(\vec{A}\times\vec{B}) = (\vec{B}\cdot\nabla)\vec{A} - (\vec{A}\cdot\nabla) \vec{B} + \vec{A}(\nabla\cdot\vec{B}) - \vec{B}(\nabla\cdot\vec{A}) $

$$
\begin{aligned}
\nabla\times(\vec{A}\times\vec{B})
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j (\vec{A}\times\vec{B})_k \\
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j \varepsilon_{klm} A_l B_m \\
&=\varepsilon_{kij} \varepsilon_{klm} \vec{\mathrm{e}}_i \partial_j (A_l B_m) \\
&=(\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}) \vec{\mathrm{e}}_i (B_m\partial_j A_l + A_l\partial_j B_m) \\
&=\vec{\mathrm{e}}_l B_j\partial_j A_l + \vec{\mathrm{e}}_l A_l \partial_m B_m - \vec{\mathrm{e}}_m B_m \partial_l A_l - \vec{\mathrm{e}}_m A_j\partial_j B_m \\
&= B_j\partial_j A_l\vec{\mathrm{e}}_l + \vec{\mathrm{e}}_l A_l \partial_m B_m - \vec{\mathrm{e}}_m B_m \partial_l A_l -  A_j\partial_j B_m \vec{\mathrm{e}}_m \\
&=(\vec{B}\cdot\nabla)\vec{A} + \vec{A}(\nabla\cdot\vec{B}) - \vec{B}(\nabla\cdot\vec{A}) - (\vec{A}\cdot\nabla) \vec{B} \\
&=(\vec{B}\cdot\nabla)\vec{A} - (\vec{A}\cdot\nabla) \vec{B} + \vec{A}(\nabla\cdot\vec{B}) - \vec{B}(\nabla\cdot\vec{A})
\end{aligned} 
$$

> $\nabla\times(\nabla\times\vec{A})=\nabla(\nabla\cdot\vec{A})-\nabla^2 \vec{A} $

$$
\begin{aligned}
\nabla\times(\nabla\times\vec{A})
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i\partial_j (\nabla\times\vec{A})_k \\
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i \partial_j \varepsilon_{klm} \partial_l A_m \\
&=\varepsilon_{kij}\varepsilon_{klm} \vec{\mathrm{e}}_i\partial_j\partial_l A_m \\
&=(\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}) \vec{\mathrm{e}}_i \partial_j \partial_l A_m \\
&=\vec{\mathrm{e}}_l\partial_m \partial_l A_m - \vec{\mathrm{e}}_m\partial_l \partial_l A_m \\
&=\vec{\mathrm{e}}_l\partial_l\partial_m A_m -\partial_l\partial_l A_m\vec{\mathrm{e}}_m \\
&=\nabla(\nabla\cdot\vec{A}) - \nabla^2\vec{A}
\end{aligned}
$$

#### 需要注意力的公式

> $\nabla\times(\nabla \varphi)=\vec{0} $

$$
\begin{aligned}
\nabla\times(\nabla \varphi)
&=\varepsilon_{ijk} \vec{\mathrm{e}}_i\partial_j (\nabla\varphi)_k \\
&=\vec{\mathrm{e}}_i\varepsilon_{ijk} \partial_j\partial_k\varphi
\end{aligned}
$$

由于我们只考虑性质比较好的函数，于是 $\partial_j \partial_k\varphi=\partial_k\partial_j\varphi $，再结合 $\varepsilon_{ijk}=-\varepsilon_{ikj} $，有：

$$
\begin{aligned}
\vec{\mathrm{e}}_i\varepsilon_{ijk}\partial_j\partial_k\varphi
&=-\vec{\mathrm{e}}_i\varepsilon_{ikj}\partial_k\partial_j\varphi \\
&=-\vec{\mathrm{e}}_i\varepsilon_{ijk}\partial_j\partial_k\varphi
\end{aligned}
$$

最后一步是因为 $j,k $ 都是用于求和的哑标，因此可以交换。

上式说明：

$$
\vec{\mathrm{e}}_i\varepsilon_{ijk}\partial_j\partial_k\varphi=\vec{0}
$$

于是：

$$
\nabla\times(\nabla \varphi)
=\vec{\mathrm{e}}_i\varepsilon_{ijk}\partial_j\partial_k\varphi
=\vec{0}
$$

> $\nabla\cdot(\nabla\times \vec{A})=0 $

$$
\begin{aligned}
\nabla\cdot(\nabla\times \vec{A})
&=\partial_i (\nabla\times\vec{A})_i \\
&=\partial_i \varepsilon_{ijk} \partial_j A_k \\
&=\varepsilon_{ijk}\partial_i\partial_j A_k
\end{aligned}
$$

注意到：

$$
\begin{aligned}
\varepsilon_{ijk}\partial_i\partial_j A_k
&=-\varepsilon_{jik}\partial_j\partial_i A_k \\
&=-\varepsilon_{ijk}\partial_i\partial_j A_k
\end{aligned}
$$

于是：

$$
\varepsilon_{ijk}\partial_i\partial_j A_k
=0
$$

这就是说：

$$
\nabla\cdot(\nabla\times \vec{A})
=\varepsilon_{ijk}\partial_i\partial_j A_k
=0
$$

#### 从右往左证的公式

> $\nabla(\vec{A}\cdot\vec{B})=(\vec{B}\cdot \nabla)\vec{A}+(\vec{A}\cdot\nabla)\vec{B}+\vec{B}\times(\nabla\times\vec{A})+\vec{A}\times(\nabla\times\vec{B}) $

$$
\begin{aligned}
&(\vec{B}\cdot \nabla)\vec{A}+(\vec{A}\cdot\nabla)\vec{B}+\vec{B}\times(\nabla\times\vec{A})+\vec{A}\times(\nabla\times\vec{B}) \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + \varepsilon_{ijk}\vec{\mathrm{e}}_iB_j(\nabla\times\vec{A})_k + \varepsilon_{ijk} \vec{\mathrm{e}}_i A_j(\nabla\times\vec{B})_k \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + \varepsilon_{ijk}\vec{\mathrm{e}}_iB_j\varepsilon_{klm}\partial_l A_m + \varepsilon_{ijk} \vec{\mathrm{e}}_i A_j\varepsilon_{klm}\partial_l B_m \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + \varepsilon_{kij}\varepsilon_{klm}\vec{\mathrm{e}}_iB_j\partial_l A_m + \varepsilon_{kij}\varepsilon_{klm} \vec{\mathrm{e}}_i A_j\partial_l B_m \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + (\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl})\vec{\mathrm{e}}_iB_j\partial_l A_m + (\delta_{il}\delta_{jm}-\delta_{im}\delta_{jl}) \vec{\mathrm{e}}_i A_j\partial_l B_m \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j + \vec{\mathrm{e}}_l B_m\partial_l A_m -\vec{\mathrm{e}}_m B_l\partial_l A_m + \vec{\mathrm{e}}_l A_m\partial_l B_m - \vec{\mathrm{e}}_m A_l\partial_l B_m \\
=&B_i\partial_i A_j \vec{\mathrm{e}}_j + A_i\partial_i B_j\vec{\mathrm{e}}_j +  B_m\vec{\mathrm{e}}_l\partial_l A_m -B_l\partial_l A_m \vec{\mathrm{e}}_m + A_m\vec{\mathrm{e}}_l \partial_l B_m -  A_l\partial_l B_m \vec{\mathrm{e}}_m \\
=&B_m\vec{\mathrm{e}}_l\partial_l A_m + A_m\vec{\mathrm{e}}_l \partial_l B_m \\
=&B_m\nabla A_m + A_m \nabla B_m \\
=&\nabla(A_m B_m) \\
=&\nabla(\vec{A}\cdot\vec{B})
\end{aligned}
$$

### $\R^3 $ 空间中重要积分恒等式

#### 高斯定理

> $\displaystyle{\oint\limits_{\partial V^+} \vec{A}\cdot\mathrm{d}\vec{S} = \int\limits_{V} (\nabla\cdot\vec{A})\mathrm{d}V}$ 

#### 斯托克斯定理

> $\displaystyle{\oint\limits_{\partial\Sigma^+}\vec{A}\cdot\mathrm{d}\vec{l} = \int\limits_{\Sigma} (\nabla\times\vec{A})\cdot\mathrm{d}\vec{S} }$ 

#### 格林第一恒等式

> $\displaystyle{\oint\limits_{\partial\Omega^+} \psi\nabla\phi\cdot\mathrm{d}\vec{S} = \int\limits_{\Omega} \left(\psi\nabla^2\phi + \nabla\phi\cdot \nabla\psi \right)\mathrm{d}V }$

注意到：

$$
\begin{aligned}
\nabla\cdot(\psi\nabla\phi)
&=\partial_i(\psi\nabla\phi)_i \\
&=\partial_i(\psi\partial_i\phi) \\
&=(\partial_i \phi)(\partial_i\psi) + \psi\partial_i\partial_i\phi \\
&=(\nabla\phi)_i(\nabla\psi)_i + \psi\nabla^2\phi \\
&=(\nabla\phi)\cdot(\nabla\psi) + \psi\nabla^2\phi
\end{aligned}
$$

于是由高斯定理，有：

$$
\begin{aligned}
\oint\limits_{\partial\Omega^+} \psi\nabla\phi\cdot\mathrm{d}\vec{S}
&=\int\limits_{\Omega} \nabla\cdot(\psi\nabla\phi)\mathrm{d}V \\
&=\int\limits_{\Omega} \left[(\nabla\phi)\cdot(\nabla\psi) + \psi\nabla^2\phi \right]\mathrm{d}V \\
&=\int\limits_{\Omega} \left[\psi\nabla^2\phi + (\nabla\phi)\cdot(\nabla\psi) \right]\mathrm{d}V \\
\end{aligned}
$$

#### 格林第二恒等式

> $\displaystyle{\oint\limits_{\partial\Omega^+}\left(\psi\nabla\phi-\phi\nabla\psi \right)\cdot\mathrm{d}\vec{S} = \int\limits_{\Omega} (\psi\nabla^2\phi-\phi\nabla^2\psi)\mathrm{d}V} $ 

利用 $\nabla\cdot(\varphi\vec{A})=\vec{A}\cdot(\nabla\varphi) + \varphi\nabla\cdot\vec{A} $ 可得：

$$
\begin{aligned}
\nabla\cdot(\psi\nabla\phi-\phi\nabla\psi)
&=\nabla\phi\cdot\nabla\psi + \psi\nabla\cdot(\nabla\phi) - \left(\nabla\psi\cdot\nabla\phi + \phi\nabla\cdot(\nabla\psi) \right) \\
&=\psi\nabla^2\phi-\phi\nabla^2\psi
\end{aligned}
$$

于是由高斯定理可得：

$$
\begin{aligned}
\oint\limits_{\partial\Omega^+}\left(\psi\nabla\phi-\phi\nabla\psi \right)\cdot\mathrm{d}\vec{S}
&=\int\limits_{\Omega} \nabla\cdot(\psi\nabla\phi-\phi\nabla\psi) \mathrm{d}V \\
&=\int\limits_{\Omega} (\psi\nabla^2\phi-\phi\nabla^2\psi) \mathrm{d}V
\end{aligned}
$$



# 第2章 $\R^3$ 空间曲线坐标系中的向量分析

## $\nabla$ 算子

### 直角坐标下的 $\nabla$

$$
\nabla
=\vec{e}_x\frac{\partial }{\partial x}+\vec{e}_y\frac{\partial}{\partial y}+\vec{e}_z\frac{\partial }{\partial z}
$$

### 球坐标下的 $\nabla$

$$
\nabla
=\vec{e}_r\frac{\partial }{\partial r}+\vec{e}_\theta\frac{1}{r}\frac{\partial}{\partial \theta} +\vec{e}_\varphi \frac{1}{r\sin\theta}\frac{\partial}{\partial \varphi}
$$

### 柱坐标下的 $\nabla$

$$
\nabla
=\vec{e}_\rho\frac{\partial}{\partial \rho}+\vec{e}_\varphi\frac{1}{\rho} \frac{\partial}{\partial \varphi}+\vec{e}_z\frac{\partial}{\partial z}
$$

## $\nabla^2$ 算子

### 直角坐标下的 $\nabla^2$

$$
\nabla^2
=\frac{\partial^2}{\partial x^2}+\frac{\partial^2}{\partial y^2}+\frac{\partial^2}{\partial z^2}
$$

### 球坐标下的 $\nabla^2$

$$
\nabla^2
=\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right)+\frac{1}{r^2\sin\theta}\frac{\partial}{\partial \theta}\left(\sin\theta\frac{\partial}{\partial\theta}\right)+\frac{1}{r^2\sin^2\theta}\frac{\partial^2}{\partial \varphi^2}
$$

### 柱坐标下的 $\nabla^2$

$$
\nabla^2
=\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2}+\frac{\partial^2}{\partial z^2}
$$

# 第3章 线性空间

# 第4章 复变函数的概念

## 欧拉公式

$$
\mathrm{e}^{\mathrm{i}\theta}
=\cos\theta + \mathrm{i}\sin\theta,~~\theta\in \mathbb{C}
$$

## 复变函数

复变函数是黎曼面到复平面的映射，即：

$$
f(z):\mathbb{C}^{\mathrm{R}}\to \mathbb{C}
$$

### 常见复变函数

#### 有理函数

$$
f(z)
=\frac{a_0 + a_1 z + \cdots + a_n z^n }{b_0 + b_1 z + \cdots +b_n z^n },~~a_i,b_i\in \mathbb{C},~~m,n\in \Z 
$$

#### 指数函数

$$
f(z)
=\mathrm{e}^{z}
$$

#### 对数函数

$$
f(z)
=\ln z
$$

#### 幂函数

$$
f(z)
=z^a,~~a\in \mathbb{C}
$$

#### 三角函数

$$
\cos z
\equiv \frac{\mathrm{e}^{\mathrm{i}z} + \mathrm{e}^{-\mathrm{i}z} }{2 } 
$$

$$
\sin z
\equiv \frac{\mathrm{e}^{\mathrm{i}z} - \mathrm{e}^{-\mathrm{i}z} }{2\mathrm{i} } 
$$

性质：

$$
\cos(-z) = \cos(z),~~
\cos(z+2\pi) = \cos(z)
$$

$$
\sin(-z) = -\sin (z),~~
\sin(z+2\pi) = \sin(z)
$$

$$
\sin^2 z + \cos^2 z = 1
$$

$|\cos z|,|\sin z| $ 可以大于 $1 $，这与实三角函数不同。

####  双曲函数

$$
\cosh z
\equiv \frac{\mathrm{e}^{z} + \mathrm{e}^{-z} }{2 } 
$$

$$
\sinh z
\equiv \frac{\mathrm{e}^{z} - \mathrm{e}^{-z} }{2 } 
$$

$$
\tanh z
\equiv \frac{\sinh z }{\cosh z }
=\frac{\mathrm{e}^{z} - \mathrm{e}^{-z} }{\mathrm{e}^{z} + \mathrm{e}^{-z} } 
$$

双曲函数与三角函数的关系：

$$
\sinh z
=-\mathrm{i}\sin(\mathrm{i}z)
$$

$$
\cosh z
=\cos(\mathrm{i}z)
$$

双曲函数的性质：

$$
\sinh (z+\mathrm{i}2\pi)
=\sinh z
$$

$$
\cosh(z+\mathrm{i}2\pi)
=\cosh z
$$

$$
\cosh(-z)
=\cosh z
$$

$$
\sinh(-z)
=-\sinh z
$$

$$
\cosh^2 z - \sinh^2 z
=1
$$

# 第5章 解析函数

## 复变函数的导数

### 复变函数的连续性

复变函数 $f(z)$ 在 $z_0$ 点及其邻域内有定义。当自变量 $z$ 以任何路径趋于 $z_0$ 时，都有：

$$
\lim_{z\to z_0} f(z)
=f(z_0)
$$

则称 $f(z)$ 在 $z_0$ 点连续。

若 $f(z)$ 在区域 $\Omega$ 内的所有点都连续，则称 $f(z)$ 在 $\Omega$ 内连续。

### 复变函数的导数

当 $z$ 以任何路径趋于 $z_0$ 时，即 $\Delta z=z-z_0$ 以任何方式趋于 $0$ 时，若极限：

$$
\lim_{\Delta z\to 0}\frac{f(z_0+\Delta z)-f(z_0)}{\Delta z}
$$

存在且唯一，则称 $f(z)$ 在 $z_0$ 点可导，$f(z)$ 在 $z_0$ 点的导数记为 $f'(z_0)$

### 柯西-黎曼条件

设复变函数 $f(z)=u(x,y)+\mathrm{i}v(x,y)$，若 $f(z)$ 在 $z$ 点可导，则必定有：

$$
\frac{\partial u}{\partial x}
=\frac{\partial v}{\partial y},
\frac{\partial u}{\partial y}
=-\frac{\partial v}{\partial x}
$$

**上面两条等式**就是**柯西-黎曼条件(C-R条件)**。

### 命题的证明

设 $z=x+\mathrm{i} y,f(z)=u(x,y)+\mathrm{i}v(x,y)$，则：

$$
\lim_{\Delta z\to 0} \frac{f(z+\Delta z)-f(z)}{\Delta z}
=\lim_{\Delta z\to 0}\frac{\Delta u+\mathrm{i}\Delta v}{\Delta x+\mathrm{i}\Delta y}
$$

由于 $f(z)$ 在 $z$ 点可导，故极限

$$
\lim_{\Delta z\to 0} \frac{f(z+\Delta z)-f(z)}{\Delta z}
$$

存在且与 $\Delta z$ 趋于 $0$ 的方式无关。

特别地，

（1）令：

$$
\mathrm{i}\Delta y=0,\Delta x\to 0
$$

此时，

$$
\lim_{\Delta z\to 0}\frac{\Delta u+\mathrm{i}\Delta v}{\Delta x+\mathrm{i}\Delta y}
=\lim_{\Delta x\to 0}\frac{\Delta u+\mathrm{i}\Delta v}{\Delta x}
=\frac{\partial u}{\partial x}+\mathrm{i}\frac{\partial v}{\partial x}
$$

（2）令：

$$
\Delta x=0,\mathrm{i}\Delta y\to0
$$

此时，

$$
\lim_{\Delta z\to 0}\frac{\Delta u+\mathrm{i}\Delta v}{\Delta x+\mathrm{i}\Delta y}
=-\mathrm{i}\frac{\partial u}{\partial y}+\frac{\partial v}{\partial y}
$$

由于 $f(z)$ 在 $z_0$ 点可导，则这两个导数值应该相等，于是：

$$
\frac{\partial u}{\partial x}
=\frac{\partial v}{\partial y}
,\frac{\partial u}{\partial y}
=-\frac{\partial v}{\partial x}
$$

C-R 条件是 $f(z) $ 在 $z $ 点可导的必要条件，但不是充分条件。也就是说，可导必定满足 C-R 条件，但满足 C-R 条件不一定可导。

## 复变函数的解析性

### 复变函数的解析性

若复变函数 $f(z)$ 在 $z_0$ 的邻域内每一点都可导，则称 $f(z)$ 在 $z_0$ 点是**解析的**。

若复变函数 $f(z)$ 在 $\Omega$ 内每一点都可导，则 $f(z)$ 在 $\Omega$ 内是**解析的**，或称为**全纯的**。

### 相关定理

#### 定理1

复变函数 $f(z) = u(x,y) + \mathrm{i} v(x,y) $ 在区域 $\Omega $ 为解析函数 $\Longleftrightarrow $ 在与复平面 $\Omega $ 相应的实平面区域内 $u(x,y),v(x,y) $ 可微，且 $u(x,y),v(x,y) $ 满足 C-R 条件。

特别地，若 $f(z) $ 为 $\Omega $ 上的连续函数，则 $f(z) $ 是 $\Omega $ 上的解析函数 $\Longleftrightarrow $ $f(z) $ 满足 C-R 条件。

#### 定理2

若 $f(z) $ 为区域 $\Omega $ 上的解析函数，且 $f(z) $ 为实函数，即 $f(z)=f^*(z) $，则 $f(z) $ 为常数。

#### 定理3

若 $f(z) $ 为区域 $\Omega $ 上的解析函数，则在 $\Omega $ 上有 $\displaystyle{\frac{\partial f(z,z^*) }{\partial z }=0 }$，即 $f(z,z^*) $ 不依赖于 $z^* $ 

#### 定理4

在复平面区域 $\Omega $ 内解析的函数 $f(z)=u(x,y)+\mathrm{i}v(x,y) $，其实部 $u(x,y) $ 和虚部 $v(x,y) $ 都是平面区域 $\Omega $ 内的调和函数（即满足二维拉普拉斯方程 $\displaystyle{\nabla^2 u(x,y)=0,\nabla^2 v(x,y)=0 }$ 的函数）。

## 例题

### 例1

> 已知解析函数的实部 $u=x^3-3xy^2 $，求该解析函数。

#### 方法1（积分法）

$$
f(z)
=u(x,y)+\mathrm{i}v(x,y)
$$

解析函数应满足柯西-黎曼条件：

$$
\frac{\partial u}{\partial x}
=\frac{\partial v}{\partial y},~~
\frac{\partial u}{\partial y}
=-\frac{\partial v}{\partial x}
$$

$$
\frac{\partial v}{\partial y}
=\frac{\partial u }{\partial x } 
=3x^2-3y^2,~~
\frac{\partial v}{\partial x}
=-\frac{\partial u }{\partial y } 
=6xy
$$

$$
\mathrm{d}v(x,y)
=\frac{\partial v }{\partial x }\mathrm{d}x + \frac{\partial v }{\partial y } \mathrm{d}y
=6xy\mathrm{d}x+(3x^2-3y^2)\mathrm{d}y \tag{1}
$$

选择积分路径为：$\underbrace{(0,0)\to(x,0)}_{C_1},\underbrace{(x,0)\to(x,y)}_{C_2}$，两边积分：

$$
\begin{aligned}
v(x,y)-v(0,0)
&=\int\limits_{C_1} 6xy\mathrm{d}x+(3x^2-3y^2)\mathrm{d}y+\int\limits_{C_2}6xy\mathrm{d}x+(3x^2-3y^2)\mathrm{d}y \\
&=0+\int_{y=0}^{y=y}(3x^2-3y^2)\mathrm{d}y \\
&=3x^2 y-y^3
\end{aligned}
$$

令 $v(0,0)=C$，则：

$$
v(x,y)
=3x^2y-y^3+v(0,0)
=3x^2y-y^3+C
$$

于是：

$$
\begin{aligned}
f(z)
&=u(x,y)+\mathrm{i}v(x,y) \\
&=x^3-3xy^2+\mathrm{i}(3x^2 y-y^3+C)
\end{aligned}
$$

### 例2

> 请证明：柱坐标系下的解析函数 $f(z)=u(\rho,\varphi) + \mathrm{i} v(\rho,\varphi) $ 满足的 C-R 方程：
>
>$$
\left\{
\begin{aligned}
&\frac{\partial u }{\partial \rho } = \frac{1 }{\rho } \frac{\partial v }{\partial \varphi } \\
&\frac{1 }{\rho } \frac{\partial u }{\partial \varphi } = -\frac{\partial v }{\partial \rho } 
\end{aligned}
\right.
>$$

直角坐标下的 C-R 条件：

$$
\frac{\partial u }{\partial x } 
=\frac{\partial v }{\partial y },~~
\frac{\partial u }{\partial y }
=-\frac{\partial v }{\partial x } 
$$

$$
\left\{
\begin{aligned}
&x=\rho\cos\varphi \\
&y=\rho\sin\varphi
\end{aligned}
\right.
\Longrightarrow
\left\{
\begin{aligned}
&\rho = \sqrt{x^2+y^2} \\
&\tan \varphi = \frac{y }{x } 
\end{aligned}
\right.
$$

注意到：

$$
\begin{aligned}
\frac{\partial u }{\partial x }
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial u }{\partial \varphi } \frac{\partial \varphi }{\partial x } \\
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial u }{\partial \varphi } \frac{\mathrm{d}\varphi }{\mathrm{d}\tan\varphi }  \frac{\partial \tan\varphi }{\partial x } \\
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial u }{\partial \varphi } \left(\frac{\mathrm{d}\tan\varphi }{\mathrm{d}\varphi }\right)^{-1}  \frac{\partial \tan\varphi }{\partial x } \\
&=\frac{\partial u }{\partial \rho }\frac{x }{\sqrt{x^2+y^2} } + \frac{\partial u }{\partial \varphi } \bigg( \frac{1 }{\cos^2\varphi }  \bigg)^{-1} \left(-\frac{y }{x^2 }  \right) \\
&=\frac{\partial u }{\partial \rho } \cos\varphi + \frac{\partial u }{\partial \varphi }\left(-\frac{\sin\varphi }{\rho }  \right)
\end{aligned}
$$

$$
\begin{aligned}
\frac{\partial u }{\partial y }
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial u }{\partial \varphi } \frac{\partial \varphi }{\partial y } \\
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial u }{\partial \varphi } \frac{\mathrm{d}\varphi }{\mathrm{d}\tan\varphi }  \frac{\partial \tan\varphi }{\partial y } \\
&=\frac{\partial u }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial u }{\partial \varphi } \left(\frac{\mathrm{d}\tan\varphi }{\mathrm{d}\varphi }\right)^{-1}  \frac{\partial \tan\varphi }{\partial y } \\
&=\frac{\partial u }{\partial \rho }\frac{y }{\sqrt{x^2+y^2} } + \frac{\partial u }{\partial \varphi } \bigg( \frac{1 }{\cos^2\varphi }  \bigg)^{-1} \left(\frac{1 }{x }   \right) \\
&=\frac{\partial u }{\partial \rho }\sin\varphi + \frac{\partial u }{\partial \varphi }\left(\frac{\cos\varphi }{\rho }  \right)
\end{aligned}
$$

$$
\begin{aligned}
\frac{\partial v }{\partial x }
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial v }{\partial \varphi } \frac{\partial \varphi }{\partial x } \\
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial v }{\partial \varphi } \frac{\mathrm{d}\varphi }{\mathrm{d}\tan\varphi }  \frac{\partial \tan\varphi }{\partial x } \\
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial x } + \frac{\partial v }{\partial \varphi } \left(\frac{\mathrm{d}\tan\varphi }{\mathrm{d}\varphi }\right)^{-1}  \frac{\partial \tan\varphi }{\partial x } \\
&=\frac{\partial v }{\partial \rho }\frac{x }{\sqrt{x^2+y^2} } + \frac{\partial v }{\partial \varphi } \bigg( \frac{1 }{\cos^2\varphi }  \bigg)^{-1} \left(-\frac{y }{x^2 }  \right) \\
&=\frac{\partial v }{\partial \rho } \cos\varphi + \frac{\partial v }{\partial \varphi }\left(-\frac{\sin\varphi }{\rho }  \right)
\end{aligned}
$$

$$
\begin{aligned}
\frac{\partial v }{\partial y }
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial v }{\partial \varphi } \frac{\partial \varphi }{\partial y } \\
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial v }{\partial \varphi } \frac{\mathrm{d}\varphi }{\mathrm{d}\tan\varphi }  \frac{\partial \tan\varphi }{\partial y } \\
&=\frac{\partial v }{\partial \rho } \frac{\partial \rho }{\partial y } + \frac{\partial v }{\partial \varphi } \left(\frac{\mathrm{d}\tan\varphi }{\mathrm{d}\varphi }\right)^{-1}  \frac{\partial \tan\varphi }{\partial y } \\
&=\frac{\partial v }{\partial \rho }\frac{y }{\sqrt{x^2+y^2} } + \frac{\partial v }{\partial \varphi } \bigg( \frac{1 }{\cos^2\varphi }  \bigg)^{-1} \left(\frac{1 }{x }   \right) \\
&=\frac{\partial v }{\partial \rho }\sin\varphi + \frac{\partial v }{\partial \varphi }\left(\frac{\cos\varphi }{\rho }  \right)
\end{aligned}
$$

全部代入直角坐标下的 C-R 方程：

$$
\frac{\partial u }{\partial \rho } \cos\varphi + \frac{\partial u }{\partial \varphi }\left(-\frac{\sin\varphi }{\rho }  \right) 
=\frac{\partial v }{\partial \rho }\sin\varphi + \frac{\partial v }{\partial \varphi }\left(\frac{\cos\varphi }{\rho }  \right) \tag{1}
$$

$$
\frac{\partial u }{\partial \rho }\sin\varphi + \frac{\partial u }{\partial \varphi }\left(\frac{\cos\varphi }{\rho }  \right)
=-\left[\frac{\partial v }{\partial \rho } \cos\varphi + \frac{\partial v }{\partial \varphi }\left(-\frac{\sin\varphi }{\rho }  \right) \right] \tag{2}
$$

$(1)\times\cos\varphi + (2)\times \sin\varphi $ 得到：

$$
\frac{\partial u }{\partial \rho }
=\frac{1 }{\rho } \frac{\partial v }{\partial \varphi } 
$$

$(2)\times \cos\varphi - (1)\times \sin\varphi $ 得到：

$$
\frac{1 }{\rho } \frac{\partial u }{\partial \varphi } 
=-\frac{\partial v }{\partial \rho } 
$$

### 例3

> 已知解析函数的虚部 $\displaystyle{v=\frac{y }{x^2+y^2 }  }$ ，求该解析函数。

$$
\frac{\partial v}{\partial x}
=\frac{-2xy}{\left(x^2+y^2\right)^2},
\frac{\partial v}{\partial y}
=\frac{x^2-y^2}{\left(x^2+y^2\right)^2}
$$

函数解析，故满足 C-R 条件，即满足：

$$
\frac{\partial u}{\partial x}
=\frac{\partial v }{\partial y } 
=\frac{x^2-y^2}{\left(x^2+y^2\right)^2}
$$

$$
\frac{\partial u}{\partial y}
=-\frac{\partial v }{\partial x } 
=\frac{2xy}{\left(x^2+y^2\right)^2}
$$

于是：

$$
\begin{aligned}
\mathrm{d}u
&=\frac{\partial u }{\partial x } \mathrm{d}x + \frac{\partial u }{\partial y } \mathrm{d}y \\
&=\frac{x^2-y^2}{\left(x^2+y^2\right)^2}\mathrm{d}x+\frac{2xy}{\left(x^2+y^2\right)^2}\mathrm{d}y \\
\end{aligned}
$$

极坐标变换：

$$
\left\{
\begin{aligned}
&x=\rho\cos\varphi \\
&y=\rho\sin\varphi
\end{aligned}
\right.
\Longrightarrow
\left\{
\begin{aligned}
&\mathrm{d}x = \frac{\partial x }{\partial \rho } \mathrm{d}\rho + \frac{\partial x }{\partial \varphi } \mathrm{d}\varphi = \cos\varphi\mathrm{d}\rho - \rho \sin\varphi \mathrm{d}\varphi \\
&\mathrm{d}y = \frac{\partial y }{\partial \rho } \mathrm{d}\rho + \frac{\partial y }{\partial \varphi } \mathrm{d}\varphi = \sin\varphi \mathrm{d}\rho + \rho\cos\varphi \mathrm{d}\varphi
\end{aligned}
\right.
$$

于是：

$$
\begin{aligned}
\mathrm{d}u
&=\frac{x^2-y^2}{\left(x^2+y^2\right)^2}\mathrm{d}x+\frac{2xy}{\left(x^2+y^2\right)^2}\mathrm{d}y \\
&=\frac{\cos\varphi }{\rho^2 } \mathrm{d}\rho + \frac{\sin\varphi }{\rho } \mathrm{d}\varphi \\
&=\mathrm{d}\left(\frac{-\cos\varphi }{\rho }  \right)
\end{aligned}
$$

于是：

$$
u
=\frac{-\cos\varphi }{\rho } + C
=-\frac{x }{x^2+y^2 } + C
$$

综上，

$$
\begin{aligned}
f(z)
&=u + \mathrm{i} v \\
&=\left(-\frac{x }{x^2+y^2 } + C \right) + \mathrm{i}\left(\frac{y }{x^2+y^2 } \right)
\end{aligned}
$$


# 第6章 复变函数积分

## 复变函数积分

### 复变函数积分的定义

复变函数的积分是指复变函数 $f(z)$ 在其有定义的区域 $\Omega$ 中，沿某一曲线 $C$ 的**有向**的**线积分**，记为 $\int\limits_{C} f(z)\mathrm{d}z$，其定义为：

$$
\int\limits\limits_C f(z)\mathrm{d}z
=\lim\limits_{\substack{n\to \infty \\ |z_j-z_{j-1}|\to 0 }}\sum\limits_{j=1}^{n} f(\xi_j) (z_j-z_{j-1})
$$

把 $C $ 分成 $n $ 段，$\xi_j $ 是 $C $ 上 $z_{j-1} $ 点到 $z_j $ 点的中的某一点。

### 复变函数积分的性质

$$
\left|\int\limits_{C} f(z)\mathrm{d}z \right|
\leqslant \int\limits_{C} \left| f(z) \right|\left|\mathrm{d}z \right|
$$

## 柯西积分定理

### 单连通区域柯西积分定理

设 $f(z)$ 在单连通区域 $\Omega$ 上解析，当积分路径为 $\Omega$ 内的任一闭合曲线 $C$ 时，有： 

$$
\oint\limits_{C^+} f(z)\mathrm{d}z
=0
$$

### 多连通区域的柯西积分定理

设 $f(z)$ 在具有 $k$ 个内边界 $C_1,C_2,\cdots,C_k$ 的回路 $C$ 内的复连通区域内解析，规定 $C;C_1,C_2,\cdots,C_k $ 的正方向为逆时针，则：

$$
\oint\limits_{C^+} f(z)\mathrm{d}z
=\oint\limits_{C_1^+} f(z)\mathrm{d}z+\oint\limits_{C_2^+} f(z)\mathrm{d}z+\cdots+\oint\limits_{C_k^+} f(z)\mathrm{d}z
$$

## 柯西积分公式

若 $f(z)$ 在闭合回路 $C$ 所包围的区域上解析，$z_0$ 是此区域中的一点，则：

$$
\oint\limits_{C^+}\frac{f(z)}{z-z_0}\mathrm{d}z
=2\pi \mathrm{i} f(z_0)
$$

## 解析函数高阶导数的积分表达式

设 $f(z)$ 在区域 $\Omega$ 内解析，$C$ 为 $\Omega$ 内的任一闭合回路，对于 $C$ 所包围的区域内的任一点 $z$，有：

$$
f^{(n)}(z)
\equiv \frac{\mathrm{d}^n }{\mathrm{d}z^n }f(z) 
=\frac{n!}{2\pi\mathrm{i}}\oint\limits_{C^+} \frac{f(\zeta)}{(\zeta-z)^{n+1}}\mathrm{d}\zeta
$$

# 第7章 复变函数的级数展开

## 解析函数的泰勒展开

设 $z_0$ 为函数 $f(z)$ 解析区域 $\Omega$ 内的一点，以 $z_0$ 为圆心的圆周 $C$ 在 $\Omega$ 内，则 $f(z)$ 可以在 $C$ 内展成泰勒级数：

$$
f(z)
=\sum_{n=0}^{\infty} a_n(z-z_0)^n
$$

其中，展开系数为：

$$
a_n
=\frac{f^{(n)}(z_0)}{n!}
=\frac{1}{2\pi \mathrm{i}}\oint\limits_{C^+} \frac{f(z)}{(z-z_0)^{n+1}}\mathrm{d}z
$$

## 解析函数的洛朗展开

### 复变函数的零点

若复变函数 $f(z) $ 在 $z_0 $ 点的函数值 $f(z_0)=0 $，则称 $z_0 $ 为 复变函数 $f(z) $ 的零点。

### 复变函数的奇点

若复变函数 $f(z) $ 在 $z_0 $ 点**不解析**，即 $f(z) $ 在 $z_0 $ 点的导数不存在或不唯一，则称 $z_0 $ 为复变函数 $f(z) $ 的奇点。

### 奇点的分类

#### 孤立奇点

若 $z_0$ 为函数 $f(z)$ 的奇点，而在 $z_0$ 点任意小的邻域内，函数 $f(z)$ 解析，则称 $z_0$ 为 $f(z)$ 的孤立奇点。

#### 非孤立奇点

若 $z_0$ 为函数 $f(z)$ 的奇点，而在 $z_0$ 点任意小的邻域内，除 $z_0 $ 点外存在 $f(z) $ 的其他奇点，则称 $z_0$ 为 $f(z)$ 的非孤立奇点。

#### 孤立奇点的分类

**极点**：设 $z_0$ 是 $f(z)$ 的孤立奇点，若存在一个正整数 $k$，使得 $(z-z_0)^kf(z)$ 为非零的解析函数，则称 $z_0$ 为 $f(z)$ 的 $k$ 阶极点。

**本性奇点**：设 $z_0$ 是 $f(z)$ 的孤立奇点，若**不存在**一个正整数 $k$，使得 $(z-z_0)^kf(z)$ 为非零的解析函数，则称 $z_0$ 为 $f(z)$ 的本性奇点。

**可去奇点**：设 $z_0$ 为函数 $f(z)$ 的孤立奇点，$f(z)$ 在 $z_0$ 点没有定义，但在 $z_0$ 的去心邻域内解析，此时可定义 $f(z_0)\equiv \lim\limits_{z\to z_0} f(z)$ 使 $f(z)$ 在 $z_0$ 点解析，则称 $z_0$ 为 $f(z)$ 的可去奇点。

### 解析函数的洛朗展开定理

若函数 $f(z)$ 在以 $z_0$ 为圆心，半径为 $R_1,R_2$ 的两个圆周 $C_1,C_2$ 所包围的环形区域 $R_2<|z-z_0|<R_1$ 上解析，则在此区域内 $f(z)$ 可展成 Laurent 级数：

$$
f(z)
=\sum_{n=-\infty}^{\infty}a_n(z-z_0)^n
$$

其中，

$$
a_n
=\frac{1}{2\pi \mathrm{i}}
\oint\limits_{C^+}\frac{f(\zeta)}{(\zeta-z_0)^{n+1}}\mathrm{d}\zeta
$$

$C$ 是任一条在环形区域内把 $C_2$ 包围在内的闭曲线。

### 例题

#### 例1

> 求 $\displaystyle{f(z)=\frac{1 }{z(z-1) }  }$ 在环形区域 $0<|z|<1 $ 和 $|z|>1 $ 内，在 $z_0=0 $ 处的展开式。

$0<|z|<1$ 区域在 $z_0=0 $ 处展开 $f(z) $：

由于 $|z|<1 $，于是有几何级数：

$$
\frac{1 }{1-z } 
=\sum_{n=0}^{\infty} z^n
$$

于是：

$$
\begin{aligned}
\frac{1}{z(z-1)}
&=\frac{1}{z-1}-\frac{1}{z} \\
&=-\frac{1}{1-z}-\frac{1}{z} \\
&=-\sum_{n=0}^{\infty} z^n-z^{-1} \\
&=-\sum_{n=-1}^{\infty} z^n \\
\end{aligned} 
$$

$|z|>1$ 区域在 $z_0=0 $ 处展开 $f(z) $：

注意到 $|z|>1 $，则 $|1/z|<1 $，于是：

$$
\begin{aligned}
\frac{1}{z(z-1)}
&=\frac{1}{z-1}-\frac{1}{z} \\
&=\frac{1}{z(1-\frac{1}{z})}-z^{-1} \\
&=\frac{1}{z}\cdot \frac{1}{1-\frac{1}{z}} -z^{-1} \\
&=\frac{1}{z}\sum_{n=0}^{\infty} \left(\frac{1}{z}\right)^{n}-z^{-1} \\
&=\sum_{n=0}^{\infty} z^{-n-1}-z^{-1} \\
&=\sum_{n=1}^{\infty} z^{-n-1}
\end{aligned}
$$

#### 例2

> 求 $\displaystyle{f(z)=\frac{1 }{z(z-1) }  }$ 在 $z_1=0 $ 和 $z_2=1 $ 附近的展开式。

$f(z) $ 在 $z_1=0$ 附近的展开式：

由于 $0<|z-0|<1 $，于是：

$$
\begin{aligned}
\frac{1}{z(z-1)}
&=\frac{1}{z-1}-\frac{1}{z} \\
&=-\frac{1}{1-z}-z^{-1} \\
&=-\sum_{n=0}^{\infty} z^n-z^{-1} \\
&=\sum_{n=-1}^{\infty} -z^n \\
\end{aligned} 
$$

$f(z) $ 在 $z_2=1$ 附近的展开式：

由于 $0<|z-1|<1 $，于是：

$$
\begin{aligned}
\frac{1}{z(z-1)}
&=\frac{1}{z-1}-\frac{1}{z} \\
&=(z-1)^{-1} - \frac{1 }{1-(1-z) } \\
&=(z-1)^{-1} - \sum_{n=0}^{\infty} (1-z)^n \\
&=(z-1)^{-1} - \sum_{n=0}^{\infty} \left(-1 \right)^n (z-1)^n \\
&=(z-1)^{-1} + \sum_{n=0}^{\infty} \left(-1 \right)^{n+1} (z-1)^n \\
&=\sum_{n=-1}^{\infty} \left(-1 \right)^{n+1} (z-1)^n
\end{aligned}
$$

# 第8章 留数定理及其在实积分中的应用

## 留数定理

### 留数的定义

设 $z_0$ 是函数 $f(z)$ 的孤立奇点，设 $f(z)$ 在其孤立奇点 $z_0$ 附近的环形区域中的洛朗展开式为：

$$
f(z)
=\sum\limits_{n=-\infty}^{\infty} a_n(z-z_0)^n
$$

$f(z)$ 在 $z_0$ 点的留数，记为 $\mathrm{Res}f(z_0)$，定义为：

$$
\mathrm{Res} f(z_0)
\equiv a_{-1}
$$

其中，$a_{-1}$ 是 $f(z)$ 在 $z_0$ 点的洛朗展开式中 $(z-z_0)^{-1}$ 项的系数

### 留数的求法

#### 定义法

直接把 $f(z)$ 在其孤立奇点 $z_0$ 点作洛朗展开，找到 $(z-z_0)^{-1}$ 前的系数 $a_{-1}$，由留数的定义可知：

$$
\mathrm{Res} f(z_0)\equiv a_{-1}
$$


#### 极限法

当 $z_0$ 为 $f(z)$ 的 $m$ 阶极点时，$f(z)$ 可在其孤立奇点 $z_0$ 点作如下的洛朗展开：

$$
f(z)
=\sum_{n=-m}^{\infty} a_n(z-z_0)^n,~~a_{-m}\ne 0
$$

则：

$$
\mathrm{Res}f(z_0)
=\frac{1}{(m-1)!}\lim_{z\to z_0}\frac{\mathrm{d}^{m-1}}{\mathrm{d}z^{m-1}}[(z-z_0)^mf(z)]
$$

#### 特殊情况

若 $f(z)=\frac{h(z)}{g(z)},z_0$ 为 $g(z)$ 的一阶极点，即 $g(z_0)=0$，且 $h(z)$ 和 $g(z)$ 在 $z_0$ 点及其邻域内解析，则：

$$
\mathrm{Res}
f(z_0)
=\frac{h(z_0)}{g'(z_0)}
$$

### 留数定理

若 $f(z)$ 在回路 $C$ 所包围的区域内除有限个孤立奇点 $z_1,z_2,\cdots,z_k$ 外解析，则 $f(z)$ 沿 $C^+$ 的回路积分值等于 $f(z)$ 在 $z_1,z_2,\cdots,z_k$ 的留数之和乘 $2\pi\mathrm{i}$，即：

$$
\oint\limits_{C^+} f(z)\mathrm{d}z
=2\pi\mathrm{i}\sum\limits_{j=1}^{k} \mathrm{Res} f(z_j)
$$

#### 例1

> 计算回路积分 $\displaystyle{I=\oint\limits_{l^+} \frac{\mathrm{d}z}{(z^2+1)(z-1)^2} }$ ，其中回路 $l$ 的方程为 $x^2+y^2-2x-2y=0$

令 $\displaystyle{f(z)=\frac{1}{(z^2+1)(z-1)^2}=\frac{1}{(z+\mathrm{i})(z-\mathrm{i})(z-1)^2}  }$ 

在回路 $\displaystyle{l:(x-1)^2+(y-1)^2=\sqrt{2} }$ 内的孤立奇点有：$z_1=\mathrm{i},z_2=1$，$z_1$ 为一阶极点，$z_2$ 为二阶极点。

计算 $f(z) $ 在回路内孤立奇点处的留数：

$$
\begin{aligned}
\mathrm{Res} f(z_1)
&=\frac{1}{0!}\lim_{z\to \mathrm{i}}\frac{\mathrm{d}^0}{\mathrm{d}z^0} (z-\mathrm{i})\cdot\frac{1}{(z+\mathrm{i})(z-\mathrm{i})(z-1)^2} \\
&=\lim_{z\to \mathrm{i}} \frac{1 }{(z+\mathrm{i})(z-1)^2 }  \\
&=\frac{1 }{2\mathrm{i}(\mathrm{i}-1)^2 }  \\
&=\frac{1}{4}
\end{aligned}
$$

$$
\begin{aligned}
\mathrm{Res}f(z_2)
&=\frac{1}{1!}\lim_{z\to 1} \frac{\mathrm{d}^1}{\mathrm{d}z^1}(z-1)^2\cdot\frac{1}{(z+\mathrm{i})(z-\mathrm{i})(z-1)^2} \\
&=\lim_{z\to 1} \frac{\mathrm{d} }{\mathrm{d}z } \left(\frac{1 }{z^2+1 } \right) \\
&=\lim_{z\to 1} \frac{-2z }{\left(z^2+1 \right)^2 }  \\
&=-\frac{1}{2}
\end{aligned}
$$

于是：

$$
\begin{aligned}
I
&=\oint\limits_{l} \frac{\mathrm{d}z}{(z^2+1)(z-1)^2} \\
&=2\pi\mathrm{i}\left[\mathrm{Res}f(z_1)+\mathrm{Res}f(z_2)\right] \\
&=2\pi\mathrm{i}\left(\frac{1 }{4 } - \frac{1 }{2 } \right) \\ 
&=-\frac{\pi\mathrm{i}}{2}
\end{aligned}
$$

## 留数定理在实积分中的应用

### 计算无穷限奇异积分的柯西主值

### 利用 Jordan 引理计算一类带有三角函数的实积分问题

### 计算一类被积函数为有理三角函数式的实积分

考虑如下形式的积分：

$$
I
=\int_{0}^{2\pi} f(\cos\theta,\sin\theta)\mathrm{d}\theta
$$

其中，$f(\cos\theta,\sin\theta) $ 为不包含有孤立奇点 $\cos\theta $ 和 $\sin\theta $ 的有理函数。

计算此类积分，利用欧拉公式换元，将实积分转换为复平面单位圆上的复积分，最后利用留数定理计算积分。

令 $z=\mathrm{e}^{\mathrm{i}\theta} $，有：

$$
z
=\cos\theta+\mathrm{i}\sin\theta,~~
z^{-1}
=\mathrm{e}^{-\mathrm{i}\theta}
=\cos\theta-\mathrm{i}\sin\theta 
$$

于是：

$$
\cos\theta = \frac{z+z^{-1} }{2 },~~
\sin\theta = \frac{z-z^{-1} }{2\mathrm{i} }  
$$

$$
\mathrm{d}z
=\mathrm{i}\mathrm{e}^{\mathrm{i}\theta}\mathrm{d}\theta
=\mathrm{i}z\mathrm{d}\theta
$$

$$
\mathrm{d}\theta
=\frac{\mathrm{d}z }{\mathrm{i}z } 
$$

于是：

$$
\begin{aligned}
I
&=\int_{0}^{2\pi} f(\cos\theta,\sin\theta)\mathrm{d}\theta \\
&=\oint\limits_{C^+} f\left(\frac{z+z^{-1} }{2 },\frac{z-z^{-1} }{2\mathrm{i} } \right) \frac{1 }{\mathrm{i}z }\mathrm{d}z 
\end{aligned}
$$

其中，$C $ 是以复平面原点为圆心的单位圆周，即 $C:|z|=1 $

#### 例1

> 计算定积分 $\displaystyle{I=\int_{0}^{2\pi} \frac{\mathrm{d}\theta }{1+\varepsilon\cos\theta }  }$，其中 $0<\varepsilon<1 $

令：

$$
z = \mathrm{e}^{\mathrm{i}\theta},~~
z^{-1} = \mathrm{e}^{-\mathrm{i}\theta},~~
\mathrm{d}z = \mathrm{i}\mathrm{e}^{\mathrm{i}\theta} \mathrm{d}\theta \Longrightarrow \mathrm{d}\theta = \frac{\mathrm{d}z }{\mathrm{i}\mathrm{e}^{\mathrm{i}\theta} } = \frac{\mathrm{d}z }{\mathrm{i}z },~~
\cos\theta = \frac{1 }{2 }\left(z+z^{-1} \right)   
$$

于是：

$$
\begin{aligned}
I
&=\int_{0}^{2\pi}\frac{\mathrm{d}\theta}{1+\varepsilon\cos\theta} \\
&=\frac{2}{\mathrm{i}}\oint\limits_{C^+} \frac{1}{\varepsilon z^2+2z+\varepsilon}\mathrm{d}z
\end{aligned}
$$

其中，$C$ 是复平面上以原点为圆心的单位圆。

令 $\displaystyle{f(z)=\frac{1}{\varepsilon z^2+2z+\varepsilon} }$ ，被积函数的两个一阶极点为：

$$
z_1
=\frac{-1+\sqrt{1-\varepsilon^2}}{\varepsilon},~~
z_2
=\frac{-1-\sqrt{1-\varepsilon^2}}{\varepsilon}
$$

被积函数 $f(z)$ 可写为：

$$
f(z)
=\frac{1}{\varepsilon(z-z_1)(z-z_2)}
$$

只有 $z_1$ 在积分回路内。

计算 $f(z) $ 在回路内孤立奇点 $z_1 $ 处的留数：

$$
\begin{aligned}
\mathrm{Res}f(z_1)
&=\frac{1}{0!}\lim_{z\to z_1} \frac{\mathrm{d}^0}{\mathrm{d}z^0} (z-z_1)f(z) \\
&=\lim_{z\to z_1} \frac{1}{\varepsilon(z-z_2)} \\
&=\frac{1}{\varepsilon(z_1-z_2)} \\
&=\frac{1}{2\sqrt{1-\varepsilon^2}}
\end{aligned}
$$

由留数定理，有：

$$
\begin{aligned}
\oint\limits_{C^+} \frac{1}{\varepsilon z^2+2z+\varepsilon}\mathrm{d}z
&=2\pi\mathrm{i}\mathrm{Res}f(z_1) \\
&=2\pi\mathrm{i}\cdot\frac{1}{2\sqrt{1-\varepsilon^2}} \\
&=\frac{\pi\mathrm{i}}{\sqrt{1-\varepsilon^2}}
\end{aligned}
$$

于是积分为：

$$
\begin{aligned}
I
&=\frac{2}{\mathrm{i}}\oint\limits_{C^+} \frac{1}{\varepsilon z^2+2z+\varepsilon}\mathrm{d}z \\
&=\frac{2}{\mathrm{i}}\cdot\frac{\pi \mathrm{i}}{\sqrt{1-\varepsilon^2}} \\
&=\frac{2\pi}{\sqrt{1-\varepsilon^2}}
\end{aligned}
$$

#### 例2

> 计算定积分：$\displaystyle{I=\int_{0}^{2\pi} \frac{1}{3-2\cos\theta+\sin\theta}\mathrm{d}\theta }$

$$
z = \mathrm{e}^{\mathrm{i}\theta},~~
z^{-1} = \mathrm{e}^{-\mathrm{i}\theta},~~
\mathrm{d}z = \mathrm{i}\mathrm{e}^{\mathrm{i}\theta} \mathrm{d}\theta \Longrightarrow \mathrm{d}\theta = \frac{\mathrm{d}z }{\mathrm{i}\mathrm{e}^{\mathrm{i}\theta} } = \frac{\mathrm{d}z }{\mathrm{i}z },~~
\cos\theta = \frac{1 }{2 }\left(z+z^{-1} \right),~~
\sin\theta = \frac{1 }{2\mathrm{i} } \left(z-z^{-1} \right)
$$

设 $C$ 是复平面上的单位圆，

$$
\begin{aligned}
I
&=\int_{0}^{2\pi} \frac{1}{3-2\cos\theta+\sin\theta}\mathrm{d}\theta \\
&=2\oint\limits_{C^+} \frac{\mathrm{d}z}{(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}} \\
\end{aligned}
$$

令 $\displaystyle{f(z)=\frac{1}{(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}} }$ ，$f(z) $ 有两个一阶极点 $z_1=2-\mathrm{i},z_2=\frac{2}{5}-\frac{1}{5}\mathrm{i} $，只有 $z_2$ 在单位圆 $C$ 内。

由于 $z_1,z_2$ 是 $(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}=0$ 的两根，于是 $f(z)$ 可表达为：

$$
f(z)
=\frac{1}{(1-2\mathrm{i})(z-z_1)(z-z_2)}
$$

$f(z)$ 在 $z_2$ 处的留数：

$$
\begin{aligned}
\mathrm{Res} f(z_2)
&=\frac{1}{0!}\lim_{z\to z_2} \frac{\mathrm{d}^0}{\mathrm{d}z^0} (z-z_2)f(z) \\
&=\lim_{z\to z_2} \frac{1 }{(1-2\mathrm{i})(z-z_1) }  \\
&=\frac{1}{(1-2\mathrm{i})(z_2-z_1)} \\
&=\frac{1}{4\mathrm{i}}
\end{aligned}
$$

于是由留数定理，有：

$$
\begin{aligned}
\oint\limits_{C^+} \frac{\mathrm{d}z}{(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}}
&=2\pi\mathrm{i}\mathrm{Res} f(z_2) \\
&=\frac{\pi}{2}
\end{aligned}
$$

于是：

$$
\begin{aligned}
I
&=2\oint\limits_{C^+} \frac{\mathrm{d}z}{(1-2\mathrm{i})z^2+6\mathrm{i}z-1-2\mathrm{i}} \\
&=2\cdot\frac{\pi}{2} \\
&=\pi
\end{aligned}
$$

# 第9章 傅里叶变换

## 傅里叶级数

设 $\mathcal{H}$ 是一个希尔伯特空间，其元素是周期为 $2l$ 的单变量函数，$\forall f_1,f_2\in \mathcal{H}$，$\mathcal{H}$ 上两个元素的内积，记为 $\braket{f_1,f_2} $，定义为：

$$
\langle f_1,f_2\rangle
\equiv \int_{x=-l}^{x=l} f_1^*(x)f_2(x)\mathrm{d}x,~~x\in\R
$$

其中，$x $ 是参数，而内积与参数无关。有时为了指明参数，也将内积写为：

$$
\braket{f_1(x),f_2(x)}
\equiv \int_{x=-l}^{x=l} f_1^*(x)f_2(x)\mathrm{d}x
$$

若 $f(x) $ 是实函数，则内积可简化为：

$$
\langle f_1,f_2\rangle
\equiv \int_{x=-l}^{x=l} f_1(x)f_2(x)\mathrm{d}x,~~x\in\R
$$

### 三角函数基的傅里叶级数

容易验证如下结论：

$$
\left\{
\begin{aligned}
&\int_{x=-l}^{x=l} \frac{1}{\sqrt{2l}}\cdot\frac{1}{\sqrt{2l}}\mathrm{d}x
=1 \\
&\int_{x=-l}^{x=l} \frac{1}{\sqrt{2l}}\cdot\frac{1}{\sqrt{l}}\sin \frac{n\pi}{l}x\mathrm{d}x
=0 \\
&\int_{x=-l}^{x=l} \frac{1}{\sqrt{2l}}\cdot\frac{1}{\sqrt{l}}\cos \frac{m\pi}{l} x\mathrm{d}x
=0 \\
&\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}} \sin\frac{n\pi}{l} x\cdot\frac{1}{\sqrt{l}} \sin\frac{m\pi}{l} x\mathrm{d}x
=\delta_{n,m},~~n=1,2,\cdots,m=0,1,2,\cdots \\
&\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}} \sin\frac{n\pi}{l} x\cdot\frac{1}{\sqrt{l}} \cos\frac{m\pi}{l} x\mathrm{d}x
=0,~~n=1,2,\cdots,m=0,1,2,\cdots \\
&\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}} \cos\frac{n\pi}{l} x\cdot\frac{1}{\sqrt{l}} \cos\frac{m\pi}{l} x\mathrm{d}x
=\delta_{n,m},~~n,m=0,1,2,\cdots
\end{aligned}
\right.
$$

函数系 $\displaystyle{\left\{\frac{1}{\sqrt{2l}},~~\frac{1}{\sqrt{l}}\sin\frac{n\pi}{l} x,~~\frac{1}{\sqrt{l}}\cos\frac{m\pi}{l} x;~~n,m=1,2,\cdots\right\} }$  是一个完备的正交归一函数族，它们可作为基矢张成 $\mathcal{H}$。

这个函数系具体写出来是：

$$
\left\{\frac{1}{\sqrt{2l}},\frac{1}{\sqrt{l}}\sin\frac{\pi}{l}x,\frac{1}{\sqrt{l}}\cos\frac{\pi}{l}x,\frac{1}{\sqrt{l}}\sin\frac{2\pi}{l}x,\frac{1}{\sqrt{l}}\cos\frac{2\pi}{l}x,\cdots  \right\}
$$

任意一个周期为 $2l$ 的，满足狄利克雷条件的函数 $f(x)$ 可写成这些基函数的线性组合，即 $f(x) $ 可展成傅里叶级数：

$$
f(x)
=a_0\cdot\frac{1}{\sqrt{2l}}+\sum_{k=1}^{\infty} \left(a_k\cdot\frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x+b_k\cdot\frac{1}{\sqrt{l}}\sin\frac{k\pi}{l} x \right)
$$

为求出线性组合的系数，只需要利用“这组基是正交归一完备的”这一性质，比如：

$$
\begin{aligned}
\Braket{\frac{1 }{\sqrt{l} } \cos\frac{k'\pi }{l } x , f(x)}
&=\Braket{\frac{1 }{\sqrt{l} } \cos\frac{k'\pi }{l } x , a_0\cdot\frac{1}{\sqrt{2l}}+\sum_{k=1}^{\infty} \left(a_k\cdot\frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x+b_k\cdot\frac{1}{\sqrt{l}}\sin\frac{k\pi}{l} x \right)} \\
&=\sum_{k=1}^{\infty} a_k\Braket{\frac{1 }{\sqrt{l} } \cos\frac{k'\pi }{l } x , \frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x} \\
&=\sum_{k=1}^{\infty} a_k \delta_{k',k} \\
&=a_{k'}
\end{aligned}
$$

总之：

$$
a_0
=\Braket{\frac{1}{\sqrt{2l}},f(x)}
=\int_{-l}^{l} \frac{1}{\sqrt{2l}}\cdot f(x)\mathrm{d}x
=\frac{1}{\sqrt{2l}}\int_{-l}^{l} f(x)\mathrm{d}x
$$

$$
a_k
=\Braket{\frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x,f(x)}
=\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}}\cos\frac{k\pi}{l} x\cdot f(x)\mathrm{d}x
=\frac{1}{\sqrt{l}}\int_{x=-l}^{x=l} f(x)\cos\frac{k\pi}{l} x\mathrm{d}x
$$

$$
b_k
=\Braket{\frac{1}{\sqrt{l}}\sin\frac{k\pi}{l} x,f(x)}
=\int_{x=-l}^{x=l}\frac{1}{\sqrt{l}}\sin\frac{k\pi}{l} x\cdot f(x)\mathrm{d}x
=\frac{1}{\sqrt{l}}\int_{x=-l}^{x=l} f(x)\sin\frac{k\pi}{l} x\mathrm{d}x
$$

### $\mathrm{e} $ 指数基的傅里叶级数

注意到：

$$
\frac{1}{2\pi}\int_{-\pi}^{\pi} \mathrm{e}^{\mathrm{i}(m-n)x}\mathrm{d}x
=\delta_{m,n}
$$

函数系 $\displaystyle{\left\{\frac{1}{\sqrt{2\pi}}\mathrm{e}^{\mathrm{i}m x},m\in \Z \right\} }$  可作为以 $2\pi$ 为周期的函数为元素的希尔伯特空间 $\mathcal{H}$ 中的一组正交完备归一基矢，以 $2\pi$ 为周期的函数 $f$ 在这组基矢上的展开式为：

$$
f(x)
=\sum_{m=-\infty}^{\infty} C_m\cdot\frac{1}{\sqrt{2\pi}}\mathrm{e}^{\mathrm{i}mx} 
$$

利用正交归一条件：

$$
\begin{aligned}
\Braket{\frac{1 }{\sqrt{2\pi} }\mathrm{e}^{\mathrm{i}n x}, \frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}m x} }
&\equiv \int_{-\infty}^{+\infty} \left(\frac{1 }{\sqrt{2\pi} }\mathrm{e}^{\mathrm{i}n x} \right)^* \cdot \left(\frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}m x} \right)\mathrm{d}x \\
&=\frac{1 }{2\pi } \int_{-\infty}^{+\infty} \mathrm{e}^{\mathrm{i}(m-n)x}\mathrm{d}x \\
&=\delta_{m,n}
\end{aligned}
$$

内积可得系数：

$$
\begin{aligned}
\Braket{\frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}n x}, f(x)}
&=\Braket{\frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}n x}, \sum_{m=-\infty}^{\infty} C_m\cdot\frac{1}{\sqrt{2\pi}}\mathrm{e}^{\mathrm{i}m x} } \\
&=\sum_{m=-\infty}^{\infty} C_m \Braket{\frac{1 }{\sqrt{2\pi} }\mathrm{e}^{\mathrm{i}n x}, \frac{1 }{\sqrt{2\pi} } \mathrm{e}^{\mathrm{i}m x} } \\
&=\sum_{m=-\infty}^{\infty} C_m\delta_{m,n} \\
&=C_n
\end{aligned}
$$

即系数 $C_m $ 可通过内积求得：

$$
C_m
=\Braket{\frac{1}{\sqrt{2\pi}} \mathrm{e}^{\mathrm{i}mx},f(x)}
=\int_{-\pi}^{\pi}\left(\frac{1}{\sqrt{2\pi}} \mathrm{e} ^{\mathrm{i}mx}\right)^*\cdot f(x)\mathrm{d}x
=\frac{1}{\sqrt{2\pi}} \int_{-\pi}^{\pi} f(x) \mathrm{e}^{-\mathrm{i}mx}\mathrm{d}x
$$

## 傅里叶变换(to be continued)

### 傅里叶分解与傅里叶变换


若 $f(x)$ 是定义在 $\R$ 上的实函数，它在任何有限的区间上满足 Dirichlet 条件，且积分 $\displaystyle{\int_{-\infty}^{+\infty} |f(x)|\mathrm{d}x }$  收敛，则 $f(x) $ 可进行**傅里叶分解**（将 $f(x) $ 分解为无穷多不同频率 $k $ 的基函数 $\mathrm{e}^{\mathrm{i}kx} $ 的线性叠加）：

$$
f(x)
=\frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k
$$

其中，系数 $C(k) $ 称为 $f(x) $ 的傅里叶变换（或频谱）。

为求出系数 $C(k) $ 的表达式，令 $\mathrm{e}^{\mathrm{i}k'x} $ 与上式两端内积，等式仍成立：

$$
\Braket{\mathrm{e}^{\mathrm{i}k'x} , f(x)}
=\Braket{\mathrm{e}^{\mathrm{i}k'x} , \frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k}
$$

根据内积的定义，分别计算内积：

$$
\begin{aligned}
\Braket{\mathrm{e}^{\mathrm{i}k'x} , f(x)}
&\equiv \int_{x=-\infty}^{x=+\infty} \left(\mathrm{e}^{\mathrm{i}k'x} \right)^* f(x)\mathrm{d}x \\
&\equiv \int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}k'x}\mathrm{d}x \\
\end{aligned}
$$

$$
\begin{aligned}
\Braket{\mathrm{e}^{\mathrm{i}k'x}, \frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k}
&\equiv\int_{x=-\infty}^{x=+\infty} \left(\mathrm{e}^{\mathrm{i}k'x} \right)^*\left(\frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k \right) \mathrm{d}x \\
&=\frac{1 }{2\pi } \int_{x=-\infty}^{x=+\infty} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}(k-k')x} \mathrm{d}k\mathrm{d}x \\
&=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} \int_{x=-\infty}^{x=+\infty} C(k) \mathrm{e}^{\mathrm{i}(k-k')x} \mathrm{d}x\mathrm{d}k \\
&=\int_{k=-\infty}^{k=+\infty} C(k) \left(\frac{1 }{2\pi } \int_{x=-\infty}^{x=+\infty} \mathrm{e}^{\mathrm{i}(k-k')x}\mathrm{d}x \right) \mathrm{d}k \\
&=\int_{k=-\infty}^{k=+\infty} C(k)\delta(k-k')\mathrm{d}k \\
&=C(k')
\end{aligned}
$$

$$
C(k')
=\int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}k'x}\mathrm{d}x
$$

将 $k' $ 替换成 $k $，即：

$$
C(k)
=\int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}kx}\mathrm{d}x
$$


这就得到了 $f(x) $ 的傅里叶分解 $\displaystyle{f(x)=\frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k }$ 中系数 $C(k) $ 的表达式。


$$
f(x)
=\frac{1}{2\pi} \int_{k=-\infty}^{k=+\infty} C(k) \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k,~~
C(k)
=\int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}kx}\mathrm{d}x
$$

其中，系数 $C(k) $ 称为 $f(x) $ 的傅里叶变换（或频谱），也记为：

$$
C(k)
\equiv \mathscr{F}\{f(x) \}(k)
$$

也就是说，函数 $f(x) $ 的傅里叶变换 $\mathscr{F}\{f(x)\}(k) $ 是一个关于 $k $ 的函数，其表达式为：

$$
\mathscr{F}\{f(x)\}(k)
=\int_{x=-\infty}^{x=+\infty} f(x)\mathrm{e}^{-\mathrm{i}kx}\mathrm{d}x
$$

### 傅里叶变换的基本性质

#### 线性定理

$$
\mathscr{F}\{\alpha_1 f_1+\alpha_2 f_2\}
=\alpha_1\mathscr{F}\{f_1\}+\alpha_2 \mathscr{F}\{f_2\}
$$

#### 延迟定理

$$
\mathscr{F}\{f(x-x_0)\}(k)
=\mathrm{e}^{-\mathrm{i}kx_0} \mathscr{F}\{f(x)\}(k)
$$

#### 位移定理

设 $\mathscr{F}\{f(x) \}(k) = C(k) $，则：

$$
\mathscr{F}\{f(x)\mathrm{e}^{\mathrm{i}k_0 x}\}(k)
=C(k-k_0)
$$

#### 标度变换定理

设 $\mathscr{F}\{f(x) \}(k) = C(k) $，则：

$$
\mathscr{F}\{f(ax)\}(k)
=\frac{1}{|a|}C\left(\frac{k}{a}\right)
$$

#### 微分定理

设当 $|x|\to\infty$ 时，$f(x)\to 0$，则有：

$$
\mathscr{F}\{f'(x)\}(k)
=\mathrm{i}k \mathscr{F}\{f(x)\}(k)
$$

$$
\mathscr{F}\{f^{(n)}(x)\}(k)
=(\mathrm{i}k)^n \mathscr{F}\{f(x)\}(k)
$$

#### 卷积定理

$$
f_1(x)*f_2(x)
\equiv \int_{-\infty}^{+\infty} f_1(x-\xi) f_2(\xi)\mathrm{d}\xi
$$

$$
\mathscr{F}\{f_1(x)*f_2(x)\}(k)
=\mathscr{F}\{f_1(x)\}(k)\mathscr{F}\{f_2(x)\}(k)
$$


# 第10章 拉普拉斯变换

## 拉普拉斯变换的定义

对于定义在实变数 $t\in[0,+\infty)$ 上的实函数或复函数 $f(t)$，定义 $f(t)$ 的拉普拉斯变换为： 

$$
\mathcal{L}\{f(t)\}(p)
\equiv F(p)
\equiv \int_{t=0}^{t=+\infty} f(t)\mathrm{e}^{-p t} \mathrm{d}t
$$

其中，$p=s+\mathrm{i}\sigma,s\in \R,\sigma\in \R$
，$\mathrm{e}^{-pt}$ 称为拉普拉斯变换核，$F(p) $ 称为像函数，也记为：

$$
F(p) \risingdotseq f(t),~~f(t) \fallingdotseq F(p)  
$$

## 拉普拉斯变换的性质（两种记号）

### 线性定理

若 $\alpha_1,\alpha_2\in \mathbb{C}$，则：

$$
\mathcal{L}\{ \alpha_1f_1(t)+\alpha_2f_2(t) \}(p)
=\alpha_1\mathcal{L}\{ f_1(t) \}(p)+\alpha_2\mathcal{L}\{ f_2(t) \}(p)
$$

---

设 $f_1(t)\fallingdotseq F_1(p),f_2(t)\fallingdotseq F_2(p)$，则：

$$
\alpha_1 f_1(t)+\alpha_2 f_2(t)
\fallingdotseq \alpha_1F_1(p)+\alpha_2F_2(p)
$$ 

### 延迟定理

设 $\tau>0 $，则：

$$
\mathcal{L}\{ f(t-\tau)H(t-\tau) \}(p)
=\mathrm{e}^{-\tau p}\mathcal{L}\{ f(t) \}(p)
$$

***

设 $f(t)\fallingdotseq F_(p),\tau>0 $，则：

$$
f(t-\tau)H(t-\tau)\fallingdotseq \mathrm{e}^{-p\tau}F(p)
$$

其中，定义了阶跃函数 $H $:

$$
H(t)
\equiv\begin{cases}
1&,t>0 \\
0&,t\leqslant 0
\end{cases}
$$ 

### 位移定理

设 $\lambda\in \mathbb{C} $，则：

$$
\mathcal{L}\left\{\mathrm{e}^{-\lambda t} f(t) \right\}(p)
=\mathcal{L}\{f(t) \} (p+\lambda)
$$

___

设 $f(t)\fallingdotseq F(p),\lambda\in\mathbb{C} $，则：

$$
\mathrm{e}^{-\lambda t}f(t)
\fallingdotseq F(p+\lambda)
$$

### 标度变换定理

设 $a>0 $，则：

$$
\mathcal{L}\{f(at) \}(p)
=\frac{1 }{a } \mathcal{L}\{f(t) \}\left(\frac{p }{a }  \right)
$$

---

设 $f(t)\fallingdotseq F(p) $，则：

$$
f(at)
\fallingdotseq \frac{1}{a}F\left(\frac{p}{a}\right),a>0
$$

### 卷积定理

$$
\mathcal{L}\{ f_1(t)*f_2(t) \}(p)
=\mathcal{L}\{ f_1(t) \}(p)\cdot\mathcal{L}\{ f_2(t) \}(p)
$$

其中，卷积的定义为：

$$
f_1(t)*f_2(t)
\equiv \int_{\tau=0}^{\tau=t} f_1(\tau)f_2(t-\tau)\mathrm{d}\tau 
$$

---

设 $f_1(t)\fallingdotseq F_1(p),f_2(t)\fallingdotseq F_2(p) $，则：

$$
f_1(t)*f_2(t)
\fallingdotseq F_1(p)F_2(p)
$$

### 微分定理

$$
\mathcal{L}\left\{ f^{(n)}(t) \right\}(p)
=p^n \mathcal{L}\{ f(t) \}(p)-p^{n-1}f^{(0)}(0)-p^{n-2}f^{(1)}(0)-\cdots-p^{1}f^{(n-2)}(0)-p^0\cdot f^{(n-1)}(0)
$$

---

设 $f(t)\fallingdotseq F(p) $，则：

$$
f^{(n)}(t)
\fallingdotseq p^n F(p)-p^{n-1}f^{(0)}(0)-p^{n-2}f^{(1)}(0)-\cdots-p^{1}f^{(n-2)}(0)-p^{0}f^{(n-1)}(0)
$$

特别地：

$$
f^{(1)}(t)
\fallingdotseq p^1 F(p)-p^0 f^{(0)}(0)
$$

$$
f^{(2)}(t)
\fallingdotseq p^2 F(p)-p^1f^{(0)}(0)-p^0f^{(1)}(0)
$$

### 积分性质

$$
\mathcal{L}\bigg\{ \underbrace{\int_{0}^{t}\mathrm{d}t\int_{0}^{t}\mathrm{d}t\cdots \int_{0}^{t}\mathrm{d}t}_{n重积分} f(t)\bigg\}(p)
=\frac{1}{p^n}\mathcal{L}\{ f(t) \}(p)
$$

---

$$
\underbrace{\int_{0}^{t}\mathrm{d}t\int_{0}^{t}\mathrm{d}t\cdots \int_{0}^{t}\mathrm{d}t}_{n重积分} f(t)
\fallingdotseq \frac{1 }{p^n } \mathcal{L}\{f(t) \}(p)
$$

### 周期函数变换定理

若 $f(t)=f(t+T)$，则：

$$
\mathcal{L}\{f(t) \}(p)
=\frac{\int_{0}^{T}f(\tau)\mathrm{e}^{-p\tau}\mathrm{d}\tau}{1-\mathrm{e}^{-pT}}
$$

---

若 $f(t)=f(t+T)$，则：

$$
f(t)
\fallingdotseq \frac{\int_{0}^{T}f(\tau)\mathrm{e}^{-p\tau}\mathrm{d}\tau}{1-\mathrm{e}^{-pT}}
$$

## 常用拉普拉斯变换及反演

$$
\mathcal{L}\{1\}(p)
=\frac{1}{p},~~\mathrm{Re}~p>0
$$

$$
\mathcal{L}\{ e^{at} \}(p)
=\frac{1}{p-a},~~\mathrm{Re}~p>a
$$

$$
\mathcal{L}\{ t^n \}(p)
=\frac{\Gamma(n+1)}{p^{n+1}}
$$

$$
\mathcal{L}\{ t^n e^{at} \}(p)
=\frac{\Gamma(n+1)}{(p-a)^{n+1}}
$$

$$
\mathcal{L}\{ \sin at \}(p)
=\frac{a}{p^2+a^2}
$$

$$
\mathcal{L}\{ \cos at \}(p)
=\frac{p}{p^2+a^2}
$$

$$
\mathcal{L}\{ \sinh at \}(p)
=\frac{a}{p^2-a^2}
$$

$$
\mathcal{L}\{ \cosh at \}(p)
=\frac{p}{p^2-a^2}
$$

$$
\mathcal{L}\{ t\sin at \}(p)
=\frac{2ap}{(p^2+a^2)^2}
$$

$$
\mathcal{L}\{ t\cos at \}(p)
=\frac{p^2-a^2}{(p^2+a^2)^2}
$$

---

$$
\frac{1}{p}
\risingdotseq 1,~~
\frac{1}{p^2}
\risingdotseq t,~~
\frac{n!}{p^{n+1}}
\risingdotseq t^n \\[1mm]
\frac{1}{p-\alpha}
\risingdotseq \mathrm{e}^{\alpha t},~~
\frac{n!}{(p-n)^{n+1}}
\risingdotseq t^n\mathrm{e}^{\alpha t} \\[1mm]
\frac{\alpha}{p^2+\alpha^2}
\risingdotseq \sin\alpha t,~~
\frac{p}{p^2+\alpha^2}
\risingdotseq \cos\alpha t \\[1mm]
\frac{\alpha}{p^2-\alpha^2}
\risingdotseq \sinh\alpha t,~~
\frac{p}{p^2-\alpha^2}
\risingdotseq \cosh\alpha t
$$

## 拉普拉斯变换的应用

### 解常微分方程

#### 例1

> 用拉普拉斯变换解下列 $RL $ 串联电路方程，其中 $L,R,E $ 为常数：
>
>$$
\left\{
\begin{aligned}
&L\frac{\mathrm{d}i(t) }{\mathrm{d}t } + R i(t) = E \\
&i(0) = 0 
\end{aligned}
\right.
>$$

设 $i(t)\fallingdotseq F(p) $

微分定理给出：

$$
\frac{\mathrm{d}i(t) }{\mathrm{d}t }
\fallingdotseq p^1 F(p) - p^0 i^{(0)}(0)
=pF(p) - i(0)
=pF(p)
$$

常用拉普拉斯变换：

$$
\mathcal{L}\{1 \}(p)
=\frac{1 }{p } ,~~\mathrm{Re}~p>0,~~\mathrm{or}~~1\fallingdotseq \frac{1 }{p } 
$$

对方程 $\displaystyle{L\frac{\mathrm{d}i(t) }{\mathrm{d}t } = +R i(t) = E }$ 两边同时作拉普拉斯变换，得：

$$
L p F(p) + R F(p) = \frac{E }{p } 
$$

解出 $F(p) $：

$$
\begin{aligned}
F(p)
&=\frac{E }{Lp^2 + Rp } \\
&=\frac{E }{R } \left(\frac{1 }{p } - \frac{p }{p+R/L }  \right) 
\end{aligned}
$$

常用拉普拉斯变换的反演：

$$
\frac{1 }{p-\alpha } \risingdotseq \mathrm{e}^{\alpha t}
$$

于是：
$$
\frac{1 }{p } \risingdotseq 1,~~\frac{1 }{p+R/L } \risingdotseq \mathrm{e}^{-\frac{R }{L } t}
$$

对方程 $\displaystyle{F(p) = \frac{E }{R } \left(\frac{1 }{p } - \frac{p }{p+R/L } \right) }$ 两边同时作拉普拉斯逆变换，得：

$$
i(t)
=\frac{E }{R } \left(1-\mathrm{e}^{-\frac{R }{L } t} \right)
$$

# 第11章 $\delta$ 函数

## $\delta$ 函数的定义

$\delta$ 函数是一个定义在 $\R$ 上的广义函数，其满足：

$$
\delta(x-x_0)
=\begin{cases}
0&,x\ne x_0 \\
+\infty&, x=x_0 
\end{cases},
且
\int_a^b\delta (x-x_0)\mathrm{d}x
=\begin{cases}
1&,x_0\in(a,b) \\
0&,x_0\notin (a,b)
\end{cases}
$$

## $\delta$ 函数的性质

（1）设 $f(x)$ 为连续函数，则：

$$
\int_{-\infty}^{+\infty} f(x)\delta(x-x_0) \mathrm{d}x
=f(x_0)
$$

（2）$\delta(x)$ 是偶函数：

$$
\delta(-x)
=\delta(x)
$$

（3）：

$$
f(x)\delta(x-x_0)
=f(x_0)\delta(x-x_0)
$$

（4）：

$$
x\delta(x)
=0
$$

（5）：

$$
\int_{-\infty}^{+\infty} \delta(x-x_2)\delta(x-x_1)\mathrm{d}x
=\delta(x_1-x_2)
$$

（6）：设 $\{x_i\}$ 为 $\varphi(x)$ 的单根，即 $\varphi(x_i)=0 $ 且 $\varphi'(x_i)\ne 0 $，则：

$$
\delta(\varphi(x))
=\sum_{i}\frac{1}{|\varphi'(x_i)|}\delta(x-x_i)
$$

简单例子：

$$
\delta(ax)
=\frac{1 }{|a| } \delta(x)
$$

$$
\delta(x^2-a^2)
=\frac{1 }{2|a| } \left[ \delta(x+a) + \delta(x-a) \right]
$$

## 三维 $\delta$ 函数

$$
\delta(\vec{r}-\vec{r}_0)
=\begin{cases}
0&,\vec{r}\ne\vec{r}_0 \\
+\infty&,\vec{r}=\vec{r}_0
\end{cases},且
\int\limits_{V}\delta(\vec{r}-\vec{r}_0)\mathrm{d}^3\vec{r}
=1,
\vec{r}_0\in V
$$

### 三维直角坐标系

$$
\mathrm{d}^3\vec{r}
=\mathrm{d}x\mathrm{d}y\mathrm{d}z
$$

$$
\delta(\vec{r}-\vec{r}_0)
\equiv \delta(x-x_0)\delta(y-y_0)\delta(z-z_0)
$$

### 三维球坐标系

$$
\mathrm{d}^3\vec{r}
=r^2\sin\theta\mathrm{d}r\mathrm{d}\theta\mathrm{d}\varphi
$$

$$
\delta(\vec{r}-\vec{r}_0)
=\frac{1}{r^2\sin\theta}\delta(r-r_0)\delta(\theta-\theta_0)\delta(\varphi-\varphi_0)
$$

### 三维柱坐标系

$$
\mathrm{d}^3\vec{r}
=\rho\mathrm{d}\rho\mathrm{d}\varphi\mathrm{d}z
$$

$$
\delta(\vec{r}-\vec{r}_0)
=\frac{1}{\rho}\delta(\rho-\rho_0)\delta(\varphi-\varphi_0)\delta(z-z_0)
$$

## 不同形式的 $\delta $ 函数

$$
\delta(x)
=\lim_{n\to\infty} \sqrt{\frac{n }{\pi } }\mathrm{e}^{-nx^2}
$$

$$
\delta(\vec{r})
=-\frac{1}{4\pi}\nabla^2\frac{1}{r}
$$

## $\delta$ 函数的傅里叶展式和傅里叶变换

### 一维

设 $\delta(x-x_0) $ 可展为：

$$
\delta(x-x_0)
=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} C(k)\mathrm{e}^{\mathrm{i}kx}\mathrm{d}k
$$

其中，系数 $C(k) $ 就是 $\delta(x-x_0) $ 的傅里叶变换 $\mathscr{F}\{\delta(x-x_0) \}(k) $，即：

$$
\begin{aligned}
C(k)
&=\mathscr{F}\{\delta(x-x_0) \}(k) \\
&=\int_{k=-\infty}^{k=+\infty}\delta(x-x_0)\mathrm{e}^{-\mathrm{i}kx}\mathrm{d}x \\
&=\mathrm{e}^{-\mathrm{i}kx_0}
\end{aligned}
$$

代回 $\delta(x-x_0) $ 的傅里叶展式，可得：

$$
\begin{aligned}
\delta(x-x_0)
&=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} C(k)\mathrm{e}^{\mathrm{i}kx}\mathrm{d}k \\
&=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} \mathrm{e}^{-\mathrm{i}kx_0} \mathrm{e}^{\mathrm{i}kx}\mathrm{d}k \\
&=\frac{1 }{2\pi } \int_{k=-\infty}^{k=+\infty} \mathrm{e}^{\mathrm{i}k(x-x_0)}\mathrm{d}k
\end{aligned}
$$

$$
\boxed{
\delta(x-x_0)
=\frac{1}{2\pi}\int_{k=-\infty}^{k=+\infty} \mathrm{e}^{\mathrm{i}(x-x_0)k}\mathrm{d}k
}
$$

### 三维
  
$$
\begin{aligned}
\delta(\vec{r}-\vec{r}_0)
&=\delta(x-x_0)\delta(y-y_0)\delta(z-z_0) \\
&=\left(\frac{1}{2\pi}\int_{k_x=-\infty}^{k_x=+\infty} \mathrm{e}^{\mathrm{i}(x-x_0)k_x}\mathrm{d}k_x \right)\left(\frac{1}{2\pi}\int_{k_y=-\infty}^{k_y=+\infty} \mathrm{e}^{\mathrm{i}(y-y_0)k_y}\mathrm{d}k_y \right)\left(\frac{1}{2\pi}\int_{k_z=-\infty}^{k_z=+\infty} \mathrm{e}^{\mathrm{i}(z-z_0)k_z}\mathrm{d}k_z \right) \\
&=\frac{1 }{\left(2\pi \right)^3 } \int_{k_x=-\infty}^{k_x=+\infty} \int_{k_y=-\infty}^{k_y=+\infty} \int_{k_z=-\infty}^{k_z=+\infty} \mathrm{e}^{\mathrm{i}(x-x_0)k_x} \mathrm{e}^{\mathrm{i}(y-y_0)k_y} \mathrm{e}^{\mathrm{i}(z-z_0)k_z} \mathrm{d}k_x \mathrm{d}k_y \mathrm{d}k_z \\
&=\frac{1 }{\left(2\pi \right)^3 } \int\limits_{\vec{k}\in\R^3} \mathrm{e}^{\mathrm{i}(\vec{r}-\vec{r}_0)\cdot\vec{k}}\mathrm{d}^3\vec{k}
\end{aligned}
$$

$$
\boxed{
\delta(\vec{r}-\vec{r}_0)
=\frac{1 }{\left(2\pi \right)^3 } \int\limits_{\vec{k}\in\R^3} \mathrm{e}^{\mathrm{i}(\vec{r}-\vec{r}_0)\cdot\vec{k}}\mathrm{d}^3\vec{k}
}
$$

## 例题

### 例1

> 证明：$\displaystyle{\delta(\vec{r})=-\frac{1}{4\pi}\nabla^2\frac{1}{r} }$ 

当 $\vec{r}\ne \vec{0} $，有：

$$
\nabla \frac{1 }{r }
=-\frac{1 }{r^2 } \nabla r
=-\frac{1 }{r^2 } \frac{\vec{r} }{r } 
=-\frac{\vec{r} }{r^3 }  
$$

$$
\begin{aligned}
\nabla^2\frac{1 }{r } 
&=\nabla\cdot\left(\nabla\frac{1 }{r }  \right) \\
&=\nabla\cdot\left(-\frac{\vec{r} }{r^3 }  \right) \\
&=-\left(\vec{r}\cdot\nabla\frac{1 }{r^3 } + \frac{1 }{r^3 } \nabla\cdot\vec{r} \right) \\
&=-\left(\vec{r}\cdot \left(-3r^{-4} \frac{\vec{r} }{r }  \right) + \frac{1 }{r^3 } \cdot 3 \right) \\
&=0
\end{aligned}
$$

$\displaystyle{\nabla^2\frac{1}{r} }$ 在 $\vec{r}=\vec{0} $ 处无定义，但可人为定义其在 $\vec{0} $ 处的函数值为 $+\infty $

取以坐标原点为球心，半径为 $R $ 的一个球体 $V $，

$$
\begin{aligned}
\int\limits_{\vec{r}\in V} -\frac{1}{4\pi}\nabla^2\frac{1}{r} \mathrm{d}^3\vec{r} 
&=-\frac{1 }{4\pi } \int\limits_{\vec{r}\in V} \nabla\cdot\left(\nabla\frac{1 }{r }  \right)\mathrm{d}^3\vec{r} \\
&=-\frac{1 }{4\pi } \oint\limits_{\partial V^+} \nabla\frac{1 }{r } \cdot\mathrm{d}\vec{S} \\
&=-\frac{1 }{4\pi } \oint\limits_{\partial V^+} -\frac{\vec{r} }{r^3 }  \cdot\mathrm{d}\vec{S} \\
&=\frac{1 }{4\pi }\cdot \frac{1 }{R^2 }  \oint\limits_{\partial V^+} \mathrm{d}S \\
&=\frac{1 }{4\pi R^2 } \cdot 4\pi R^2 \\
&=1
\end{aligned}
$$

# 第12章 小波变换初步

# 第13章 波动方程、输运方程、泊松方程及其定解问题

## 波动方程、输运方程、泊松方程的标准形式

### 波动方程（双曲方程）

$$
\begin{aligned}
u_{tt}-a^2\nabla^2 u(\vec{r},t)
=f(\vec{r},t)
\end{aligned}
$$

### 输运方程（抛物方程）

$$
\begin{aligned}
u_{t}-a^2\nabla^2 u(\vec{r},t)
=f(\vec{r},t)
\end{aligned}
$$

### 泊松方程（椭圆方程）

$$
\nabla^2 u(\vec{r})
=f(\vec{r})
$$

### 拉普拉斯方程

$$
\nabla^2 u(\vec{r})
=0
$$

## 波动方程、输运方程、泊松方程的定解条件

**定解条件**包括**初始条件**和**边界条件**。

### 初始条件

#### 波动方程初始条件

场量 $u(\vec{r},t)$ 在 $t=0$ 时刻的空间分布**和**场量对时间的一阶导 $u_t(\vec{r},t) $ 在 $t=0$ 时刻的空间分布：

$$
\left\{
\begin{aligned}
u(\vec{r},t)\bigg|_{t=0}=\varphi(\vec{r}) \\
u_t(\vec{r},t)\bigg|_{t=0}=\nu(\vec{r})
\end{aligned}
\right.
$$

#### 输运方程初始条件

场量 $u(\vec{r},t)$ 在 $t=0$ 时刻的空间分布**或**场量对时间的一阶导 $u_t(\vec{r},t)$ 在 $t=0$ 时刻的空间分布：

$$
u(\vec{r},t)\bigg|_{t=0}
=\varphi(\vec{r})
$$

**或**：

$$
u_t(\vec{r},t)\bigg|_{t=0}
=\nu(\vec{r})
$$

#### 泊松方程初始条件

泊松方程没有初始条件（稳定场，场量不随时间改变）

### 边界条件

#### 第一类边界条件

场量 $u(\vec{r},t)$ 在边界 $\partial \Omega$ 处的取值所要满足的条件

$$
u(\vec{r},t)\bigg|_{\vec{r}\in \partial \Omega}
=g(\vec{r},t)
$$

若 $g(\vec{r},t)=0$，则得到**第一类齐次边界条件**：

$$
u(\vec{r},t)\bigg|_{\vec{r}\in \partial \Omega}
=0
$$

#### 第二类边界条件

场量沿边界的外法线的梯度对时间的依赖关系

$$
\frac{\partial u(\vec{r},t)}{\partial n}\bigg|_{\vec{r}\in \partial \Omega}
=g(\vec{r},t)
$$

若 $g(\vec{r},t)=0$，则得到**第二类齐次边界条件**：

$$
\frac{\partial u(\vec{r},t)}{\partial n}\bigg|_{\vec{r}\in \partial \Omega}
=0
$$

#### 第三类边界条件

$$
\bigg( \alpha u(\vec{r},t)+\beta\frac{\partial u(\vec{r},t)}{\partial n} \bigg)\bigg|_{\vec{r}\in \Omega}
=g(\vec{r},t) 
$$

若 $g(\vec{r},t)=0 $，则得到**第三类齐次边界条件**：

$$
\bigg( \alpha u(\vec{r},t)+\beta\frac{\partial u(\vec{r},t)}{\partial n} \bigg)\bigg|_{\vec{r}\in \Omega}
=0
$$

#### 自然边界条件

所要求解的场量 $u$ 在考虑的区域 $\Omega$ 及其边界 $\partial \Omega$ 上，都是有界的，不发散的，即：

$$
|u|<+\infty
$$

#### 周期性边界条件

场函数 $u(\vec{r},t) $ 具有空间周期性。

#### 衔接条件

若研究的区域 $\Omega $ 可分成几个性质不同的子区域，则在相邻子区域的边界上要求用特殊的衔接条件。

## 波动方程、输运方程、泊松方程的定解条件

### 波动方程定解条件

$$
\left\{
\begin{aligned}
&u_{tt}(\vec{r},t)-a^2\nabla^2 u = f(\vec{r},t) \\
&u(\vec{r},t)\bigg|_{t=0} = \varphi(\vec{r}) \\
&u_t(\vec{r},t)\bigg|_{t=0} = \nu(\vec{r}) \\
&\left[\alpha u(\vec{r},t)+\beta\frac{\partial u(\vec{r},t) }{\partial n } \right]_{\vec{r}\in\partial \Omega} = g(\vec{r},t)\bigg|_{\vec{r}\in \partial \Omega}
\end{aligned}
\right.
$$

### 输运方程定解条件

$$
\left\{
\begin{aligned}
&u_{t}(\vec{r},t)-a^2\nabla^2 u = f(\vec{r},t) \\
&u(\vec{r},t)\bigg|_{t=0} = \varphi(\vec{r}) ~~\mathrm{or} ~~u_t(\vec{r},t)\bigg|_{t=0} = \nu(\vec{r}) \\
&\left[\alpha u(\vec{r},t)+\beta\frac{\partial u(\vec{r},t) }{\partial n } \right]_{\vec{r}\in\partial \Omega} = g(\vec{r},t)\bigg|_{\vec{r}\in \partial \Omega}
\end{aligned}
\right.
$$

### 泊松方程定解条件

$$
\left\{
\begin{aligned}
&\nabla^2 u(\vec{r}) = f(\vec{r}) \\
&\left[\alpha u(\vec{r})+\beta\frac{\partial u(\vec{r}) }{\partial n } \right]_{\vec{r}\in\partial \Omega} = g(\vec{r}s)\bigg|_{\vec{r}\in \partial \Omega}
\end{aligned}
\right.
$$



# 第14章 分离变量法

## 例1

> 求解四边固定，$x,y $ 方向上边长分别为 $l,d $ 的矩形薄膜的本征振动（即求本征振动频率和本征振动函数）

矩形薄膜的振动满足二维波动方程。这里采用直角坐标，结合“四周固定”这一边界条件，可得：

$$
\left\{
\begin{aligned}
&\frac{\partial^2 u(x,y,t) }{\partial t^2 } - a^2\left(\frac{\partial^2 u(x,y,t) }{\partial x^2 } + \frac{\partial^2 u(x,y,t) }{\partial y^2 }  \right) = 0 \\
&u\big|_{x=0} = u\big|_{x=l} = 0 \\
&u\big|_{y=0} = u\big|_{y=d} = 0 \\
\end{aligned}
\right.
$$

设 $u(x,y,t) $ 可分离变量：

$$
u(x,y,t) = U(x,y)T(t) = X(x)Y(y)T(t)
$$

代入波动方程可得：

$$
X(x)Y(y)T''(t) - a^2\left[Y(y)T(t)X''(x) + X(x)T(t)Y''(y) \right]
=0
$$

上式两边同时除以 $X(x)Y(y)T(t) $ 得：

$$
\frac{T''(t) }{T(t) } - a^2\left[\frac{X''(x) }{X(x) } + \frac{Y''(y) }{Y(y) }  \right] 
=0
$$

观察可知，必定有：

$$
\frac{T''(t) }{T(t) } = -\omega^2,~~
\frac{X''(x) }{X(x) } = -k_x^2,~~
\frac{Y''(y) }{Y(y) } = -k_y^2
$$

将上式代入上上式，可知 $\omega,k_x,k_y $ 满足：

$$
\omega^2 = a^2\left(k_x^2+k_y^2 \right)
$$

$$
\frac{X''(x) }{X(x) } = -k_x^2
\Longrightarrow X(x) = A\cos(k_x x) + B\sin(k_x x)
$$

结合边界条件 $\displaystyle{u\big|_{x=0} = u\big|_{x=l} = 0 }$  可得：

$$
A = 0,~~
k_x^{(n)} = \frac{n\pi }{l },~~n=1,2,\cdots
$$

因此，$X(x) $ 的本征函数为：

$$
X^{(n)}
=B^{(n)} \sin\left(\frac{n\pi }{l } x \right)
$$

$$
\frac{Y''(y) }{Y(y) } = -k_y^2
\Longrightarrow Y(y) = C\cos(k_y y)+D\sin(k_y y)
$$

结合边界条件 $\displaystyle{u\big|_{y=0} = u\big|_{y=d} = 0 }$  可得：

$$
C = 0,~~
k_y^{(m)} = \frac{m\pi }{d },~~m=1,2,\cdots
$$

因此，$Y(y) $ 的本征函数为：

$$
Y^{(m)}
=D^{(m)} \sin\left(\frac{m\pi }{d } y \right)
$$

由 $U(x,y)=X(x)Y(y) $ 可知，本征振动函数为：

$$
\begin{aligned}
U^{(nm)}(x,y)
&=X^{(n)}(x)Y^{(m)}(y) \\
&=B^{(n)}D^{(m)} \sin\left(\frac{n\pi }{l } x \right) \sin\left(\frac{m\pi }{d } y \right) \\
&\equiv E^{(nm)} \sin\left(\frac{n\pi }{l } x \right) \sin\left(\frac{m\pi }{d } y \right),~~E^{(nm)}\equiv B^{(n)}D^{(m)},~~n,m=1,2,\cdots
\end{aligned}
$$

由 $\omega^2=a^2\left(k_x^2+k_y^2 \right) $ 可知，本征振动频率为：

$$
\begin{aligned}
\omega^{(nm)}
&=a\sqrt{\left(k_x^{(n)} \right)^2 + \left(k_y^{(m)} \right)^2} \\
&=a\sqrt{\left(\frac{n\pi }{l }  \right)^2 + \left(\frac{m\pi }{d }  \right)^2},~~n,m=1,2,\cdots
\end{aligned}
$$

## 例2

> 求定解问题：
>
>$$
\left\{
\begin{aligned}
&u_{tt}-a^2u_{xx}=0 \\
&u_{x}\bigg|_{x=0}=0 \\
&u_{x}\bigg|_{x=l}=0 \\
&u\bigg|_{t=0}=\cos\left(\frac{\pi x}{l}\right)+0.3\cos\left(\frac{3\pi x }{l }  \right) \\
&u_{t}\bigg|_{t=0}=0
\end{aligned}
\right.
>$$

设：

$$
u(x,t)
=U(x)T(t)
$$

代入一维波动方程 $\displaystyle{u_{tt}-a^2u_{xx}=0 }$ 可得：

$$
\frac{T''(t) }{T(t) }
=a^2\frac{U''(x) }{U(x) }
=-\omega^2  
$$

$$
T''(t)+\omega^2 T(t) = 0
\Longrightarrow T(t) = A\cos\omega t+B\sin\omega t
$$

$$
T'(t)
=-\omega A\sin\omega t + \omega B\cos\omega t
$$

$$
u_{t}\bigg|_{t=0}=0
\Longrightarrow T'(t)\bigg|_{t=0} = 0
\Longrightarrow B = 0
$$

因此：

$$
T(t)
=A\cos\omega t
$$

令：

$$
k\equiv \frac{\omega }{a } ,~~k^2 = \frac{\omega^2 }{a^2 } 
$$

$$
U''(x) + k^2 U(x) = 0
\Longrightarrow U(x) = C\cos k x + D\sin k x
$$

$$
U'(x)
=-k C\sin k x + k D\cos k x
$$
$$
u_{x}\bigg|_{x=0} = 0
\Longrightarrow U'(x)\bigg|_{x=0} = 0
\Longrightarrow D = 0
$$

因此：

$$
U(x) = C\cos k x,~~U'(x) = -kC\sin k x
$$

$$
u_{x}\bigg|_{x=l}=0
\Longrightarrow U'(x)\bigg|_{x=l} = 0
\Longrightarrow -kC\sin k l = 0
$$

因此，$k $ 的本征值 $k_n $ 为：

$$
k_n = \frac{n\pi }{l },~~n=,1,2,\cdots
$$

> $n=0 $ 是平庸解，不考虑。

相应的本征函数 $U_n(x) $ 为：

$$
U_n(x) = \cos k_n x = \cos\left(\frac{n\pi }{l } x \right),~~n=1,2,\cdots
$$

由 $k\equiv \omega/a $，得 $\omega $ 的本征值 $\omega_n $ 为：

$$
\omega_n = a k_n
=\frac{n\pi a}{l },~~n=1,2,\cdots
$$

相应的本征函数 $T_n(x) $ 为：

$$
T_n(t) = \cos\omega_n t = \cos\left(\frac{n\pi a}{l } t \right),~~n=,1,2,\cdots
$$

本征解 $u_n(x,t) $ 为：

$$
u_n(x,t)
=U_n(t) T_n(t)
=\cos\left(\frac{n\pi }{l } x \right)\cos\left(\frac{n\pi a}{l } t \right),~~n=,1,2,\cdots
$$

定解问题的通解 $u(x,t) $ 为：

$$
u(x,t)
=\sum_{n=1}^{\infty} E_n u_n(x,t)
=\sum_{n=1}^{\infty} E_n \cos\left(\frac{n\pi }{l } x \right)\cos\left(\frac{n\pi a}{l } t \right) 
$$

最后结合初始条件

$$
u\bigg|_{t=0}=\cos\left(\frac{\pi x}{l}\right) +0.3\cos\left(\frac{3\pi x }{l }  \right)
$$

得到：

$$
E_1 = 1,E_2 = 0,E_3 = 0.3,E_4=E_5=\cdots=0
$$

最终得到定解问题的解为：

$$
u(x,t)
=\cos\left(\frac{\pi }{l}x \right)\cos\left(\frac{\pi a}{l}t \right) + 0.3\cos\left(\frac{3\pi }{l}x \right)\cos\left(\frac{3\pi a}{l}t \right)
$$

## 例3

> 求定解问题：
>
>$$
\left\{
\begin{aligned}
&u_{t}-a^2\nabla^2 u=0 \\
&u\bigg|_{x=0}=0,u\bigg|_{x=l_1}=0 \\
&u\bigg|_{y=0}=0,u\bigg|_{y=l_2}=0 \\
&u\bigg|_{z=0}=0,u\bigg|_{z=l_3}=0 \\
&u\bigg|_{t=0}=T_0 \\
\end{aligned}
\right.
>$$

设 $u(x,y,z,t) $ 可分离变量：

$$
u(x,y,z,t)=U(x,y,z)T(t)
$$

代入输运方程可得：

$$
U(x,y,z)T'(t) - a^2 T(t) \nabla^2 U(x,y,z)
=0
$$

两边同时处以 $a^2 U(x,y,z)T(t) $ 得：

$$
\frac{T'(t) }{a^2 T(t) } = \frac{\nabla^2  U(x,y,z) }{U(x,y,z) } 
$$

显然，有：

$$
\frac{T'(t) }{a^2 T(t) } = \frac{\nabla^2  U(x,y,z) }{U(x,y,z) } = -k^2 ,\quad k > 0
$$

$T(t) $ 满足方程：

$$
T'(t) + a^2 k^2 T(t) = 0
$$

$U(x,y,z) $ 满足方程：

$$
\nabla^2 U(x,y,z) + k^2 U(x,y,z) = 0
$$

设 $U(x,y,z) $ 可分离变量：

$$
U(x,y,z) = X(x)Y(y)Z(z)
$$

代入 $U(x,y,z) $ 满足的方程，得：

$$
Y(y)Z(z)X''(x) + X(x)Z(z)Y''(y) + X(x)Y(y)Z''(z) + k^2 X(x)Y(y)Z(z)
=0
$$

等号两边同时除以 $X(x)Y(y)Z(z) $ 得：

$$
\frac{X''(x) }{X(x) } + \frac{Y''(y) }{Y(y) } + \frac{Z''(z) }{Z(z) } + k^2 
=0
$$

注意到，$\displaystyle{\frac{X''(x) }{X(x) } , \frac{Y''(y) }{Y(y) } , \frac{Z''(z) }{Z(z) } }$ 分别只与 $x,y,z $ 有关。上式成立，则有：

$$
\frac{X''(x) }{X(x) } = -k_x^2,\quad k_x>0
$$

$$
\frac{Y''(y) }{Y(y) } = -k_y^2,\quad k_y>0
$$

$$
\frac{Z''(z) }{Z(z) } = -k_z^2,\quad k_z>0
$$

$$
k_x^2 + k_y^2+k_z^2 = k^2
$$

即：

$$
X''(x) + k_x^2 X(x) = 0
$$

$$
Y''(y) + k_y^2 Y(y) = 0
$$

$$
Z''(z) + k_z^2 Z(z) = 0
$$

$$
k_x^2 + k_y^2+k_z^2 = k^2
$$

方程 $\displaystyle{X''(x) + k_x^2 X(x) = 0 }$ 的通解为：

$$
X(x) = A_x \cos\left(k_x x \right) + B_x \sin\left(k_x x \right)
$$

边界条件：

$$
u\bigg|_{x=0}=0,u\bigg|_{x=l_1}=0
\Longrightarrow X(x)\bigg|_{x=0}=0,X(x)\bigg|_{x=l_1}=0
$$

由 $X(x)\bigg|_{x=0}=0 $ 可知：

$$
A_x = 0
$$

因此：

$$
X(x) = B_x \sin\left(k_x x \right)
$$

再由 $X(x)\bigg|_{x=l_1}=0 $ 可得 $k_x $ 的本征值 $k_x^{(n_x)} $ 为：

$$
k_x^{(n_x)} = \frac{n_x\pi }{l_1 } ,\quad n_x=1,2,\cdots
$$

相应的本征函数 $X_{n_x}(x) $ 为：

$$
X_{n_x}(x) = \sin\left(\frac{n_x\pi x}{l_1 } \right),\quad n_x=1,2,\cdots
$$

类似的，$k_y $ 的本征值 $k_y^{(n_y)} $ 为：

$$
k_y^{(n_y)} = \frac{n_y \pi }{l_2 } ,\quad n_y=1,2,\cdots
$$

相应的本征函数 $Y_{n_y}(y) $ 为：

$$
Y_{n_y}(y) = \sin\left(\frac{n_y\pi y}{l_2 } \right),\quad n_y=1,2,\cdots
$$

$k_z $ 的本征值 $k_z^{(n_z)} $ 为：

$$
k_z^{(n_z)} = \frac{n_z \pi }{l_3 } ,\quad n_z=1,2,\cdots
$$

相应的本征函数 $Z_{n_z}(z) $ 为：

$$
Z_{n_z}(z) = \sin\left(\frac{n_z\pi z}{l_3 } \right),\quad n_z=1,2,\cdots
$$

由 $k^2=k_x^2+k_y^2+k_z^2 $ 可知，$k $ 的本征值 $k_{n_xn_yn_z} $ 为：

$$
\begin{aligned}
k_{n_xn_yn_z}
&=\sqrt{\left(k_x^{(n_x)} \right)^2 + \left(k_y^{(n_y)} \right)^2 + \left(k_z^{(n_z)} \right)^2} \\
&=\sqrt{\left(\frac{n_x\pi }{l_1 } \right)^2 + \left(\frac{n_y\pi }{l_2 } \right)^2 + \left(\frac{n_z\pi }{l_3 } \right)^2}
\end{aligned}
$$

由 $U(x,y,z)=X(x)Y(y)Z(z) $ 可知，相应于本征值 $k_{n_xn_yn_z} $ 的本征函数 $U_{n_xn_yn_z} $ 为：

$$
U_{n_xn_yn_z}(x,y,z)
=X_{n_x}(x)Y_{n_y}(y)Z_{n_z}(z)
=\sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_y\pi y}{l_2 } \right) \sin\left(\frac{n_z\pi z}{l_3 } \right)
$$

由 $T'(t) + a^2 k^2 T(t) = 0 $ 可知，$T(t) $ 的本征函数 $T_{n_xn_yn_z}(t) $ 为：

$$
T_{n_xn_yn_z}(t)
=\mathrm{e}^{-k_{n_xn_yn_z}^2 a^2 t}
$$

由 $u(x,y,z,t)=U(x,y,z)T(t) $ 可知，$u(x,y,z,t) $ 的本征函数 $u_{n_xn_yn_z}(x,y,z,t) $ 为：

$$
\begin{aligned}
u_{n_xn_yn_z}(x,y,z,t)
&=U_{n_xn_yn_z}(x,y,z) T_{n_xn_yn_z}(t) \\
&=\mathrm{e}^{-k_{n_xn_yn_z}^2 a^2 t} \sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_y\pi y}{l_2 } \right) \sin\left(\frac{n_z\pi z}{l_3 } \right) \\
\end{aligned}
$$

因此，定解问题的形式解 $u(x,y,z,t) $ 为：

$$
\begin{aligned}
u(x,y,z,t)
&=\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} C_{n_xn_yn_z}u_{n_xn_yn_z}(x,y,z,t) \\
&=\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} C_{n_xn_yn_z}\mathrm{e}^{-k_{n_xn_yn_z}^2 a^2 t} \sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_y\pi y}{l_2 } \right) \sin\left(\frac{n_z\pi z}{l_3 } \right) \\
&=\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} C_{n_xn_yn_z}\exp\left\{-a^2 \left[\left(\frac{n_x\pi }{l_1 } \right)^2 + \left(\frac{n_y\pi }{l_2 } \right)^2 + \left(\frac{n_z\pi }{l_3 } \right)^2 \right]t  \right\}\sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_y\pi y}{l_2 } \right) \sin\left(\frac{n_z\pi z}{l_3 } \right) \\
\end{aligned}
$$

结合初始条件 $u(x,y,z,t)\bigg|_{t=0} = T_0 $，得：

$$
\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} C_{n_xn_yn_z} \sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_y\pi y}{l_2 } \right) \sin\left(\frac{n_z\pi z}{l_3 } \right) 
=T_0
$$

等号两边同乘 $\displaystyle{\sin\left(\frac{n_x'\pi x}{l_1 } \right)\sin\left(\frac{n_y'\pi y}{l_2 } \right) \sin\left(\frac{n_z'\pi z}{l_3 } \right)  }$ 并积分（$n_x',n_y',n_z'\in \left\{1,2,\cdots \right\} $）：

$$
\begin{aligned}
&\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} C_{n_xn_yn_z} \int_{x=0}^{x=l_1} \sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_x'\pi x}{l_1 } \right)\mathrm{d}x \int_{y=0}^{y=l_2} \sin\left(\frac{n_y\pi y}{l_2 } \right)\sin\left(\frac{n_y'\pi y}{l_2 } \right)\mathrm{d}y \int_{z=0}^{z=l_3} \sin\left(\frac{n_z\pi z}{l_3 } \right) \sin\left(\frac{n_z'\pi z}{l_3 } \right) \mathrm{d}z \\
=&T_0 \int_{x=0}^{x=l_1}\sin\left(\frac{n_x'\pi x}{l_1 } \right)\mathrm{d}x \int_{y=0}^{y=l_2}\sin\left(\frac{n_y'\pi y}{l_2 } \right)\mathrm{d}y\int_{z=0}^{z=l_3}\sin\left(\frac{n_z'\pi z}{l_3 } \right) \mathrm{d}z
\end{aligned}
$$

注意到：

$$
\begin{aligned}
\int_{x=0}^{x=l_1}\sin\left(\frac{n_x'\pi x}{l_1 } \right)\mathrm{d}x
&=\frac{l_1 }{n_x'\pi } \int_{x=0}^{x=l_1}\sin\left(\frac{n_x'\pi x}{l_1 } \right)\mathrm{d}\left(\frac{n_x'\pi x }{l_1 }  \right) \\
&=\frac{-l_1 }{n_x'\pi }\int_{x=0}^{x=l_1}\mathrm{d}\left[\cos\left(\frac{n_x'\pi x }{l_1 }  \right) \right] \\
&=\frac{-l_1 }{n_x'\pi }\cdot \cos\left(\frac{n_x'\pi x }{l_1 }  \right)\bigg|_{x=0}^{x=l_1} \\
&=\frac{-l_1 }{n_x'\pi }\cdot\left[\cos\left(n_x'\pi \right) - 1 \right] \\
&=\frac{l_1 }{n_x'\pi }\left[1-\left(-1 \right)^{n_x'} \right]
\end{aligned}
$$

利用积化和差公式 $\displaystyle{\sin\alpha\sin\beta=\frac{1 }{2 }\left[\cos(\alpha-\beta) - \cos(\alpha+\beta) \right] }$，有：

$$
\begin{aligned}
\int_{x=0}^{x=l_1} \sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_x'\pi x}{l_1 } \right)\mathrm{d}x
&=\frac{1 }{2 } \int_{x=0}^{x=l_1} \cos\left(\frac{\left(n_x-n_x' \right)\pi x }{l_1 } \right)\mathrm{d}x - \frac{1 }{2 } \int_{x=0}^{x=l_1} \cos\left(\frac{\left(n_x+n_x' \right)\pi x }{l_1 } \right)\mathrm{d}x
\end{aligned}
$$

注意到：

$$
\begin{aligned}
\int_{x=0}^{x=l_1} \cos\left(\frac{\left(n_x+n_x' \right)\pi x }{l_1 } \right)\mathrm{d}x
&=\frac{l_1 }{\left(n_x+n_x' \right)\pi } \int_{x=0}^{x=l_1} \mathrm{d}\left[\sin\left(\frac{\left(n_x+n_x' \right)\pi x }{l_1 } \right) \right] \\
&=\frac{l_1 }{\left(n_x+n_x' \right)\pi } \cdot \sin\left(\frac{\left(n_x+n_x' \right)\pi x }{l_1 } \right)\bigg|_{x=0}^{x=l_1} \\
&=0
\end{aligned}
$$

再注意到，当 $n_x=n_x' $ 时，

$$
\begin{aligned}
\int_{x=0}^{x=l_1} \cos\left(\frac{\left(n_x-n_x' \right)\pi x }{l_1 } \right)\mathrm{d}x
&=l_1
\end{aligned}
$$

当 $n_x\ne n_x' $ 时，

$$
\begin{aligned}
\int_{x=0}^{x=l_1} \cos\left(\frac{\left(n_x-n_x' \right)\pi x }{l_1 } \right)\mathrm{d}x
&=\frac{l_1 }{\left(n_x-n_x' \right)\pi } \int_{x=0}^{x=l_1} \mathrm{d}\left[\sin\left(\frac{\left(n_x-n_x' \right)\pi x }{l_1 } \right) \right] \\
&=\frac{l_1 }{\left(n_x-n_x' \right)\pi } \cdot \sin\left(\frac{\left(n_x-n_x' \right)\pi x }{l_1 } \right)\bigg|_{x=0}^{x=l_1} \\
&=0
\end{aligned}
$$

因此：

$$
\int_{x=0}^{x=l_1} \cos\left(\frac{\left(n_x-n_x' \right)\pi x }{l_1 } \right)\mathrm{d}x
=l_1\delta_{n_x,n_x'}
$$

终于，我们可以计算：

$$
\begin{aligned}
\int_{x=0}^{x=l_1} \sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_x'\pi x}{l_1 } \right)\mathrm{d}x
&=\frac{1 }{2 } \int_{x=0}^{x=l_1} \cos\left(\frac{\left(n_x-n_x' \right)\pi x }{l_1 } \right)\mathrm{d}x - \frac{1 }{2 } \int_{x=0}^{x=l_1} \cos\left(\frac{\left(n_x+n_x' \right)\pi x }{l_1 } \right)\mathrm{d}x \\
&=\frac{1 }{2 } l_1\delta_{n_x,n_x'} - \frac{1 }{2 } \cdot 0 \\
&=\frac{l_1 }{2 } \delta_{n_x,n_x'}
\end{aligned}
$$

于是，下面这个复杂的方程

$$
\begin{aligned}
&\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} C_{n_xn_yn_z} \int_{x=0}^{x=l_1} \sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_x'\pi x}{l_1 } \right)\mathrm{d}x \int_{y=0}^{y=l_2} \sin\left(\frac{n_y\pi y}{l_2 } \right)\sin\left(\frac{n_y'\pi y}{l_2 } \right)\mathrm{d}y \int_{z=0}^{z=l_3} \sin\left(\frac{n_z\pi z}{l_3 } \right) \sin\left(\frac{n_z'\pi z}{l_3 } \right) \mathrm{d}z \\
=&T_0 \int_{x=0}^{x=l_1}\sin\left(\frac{n_x'\pi x}{l_1 } \right)\mathrm{d}x \int_{y=0}^{y=l_2}\sin\left(\frac{n_y'\pi y}{l_2 } \right)\mathrm{d}y\int_{z=0}^{z=l_3}\sin\left(\frac{n_z'\pi z}{l_3 } \right) \mathrm{d}z
\end{aligned}
$$

可简化为：

$$
\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} C_{n_xn_yn_z} \frac{l_1l_2l_3 }{8 } \delta_{n_x,n_x'}\delta_{n_y,n_y'}\delta_{n_z,n_z'}
=T_0\frac{l_1l_2l_3 }{n_x'n_y'n_z'\pi^3 }\left[1-\left(-1 \right)^{n_x'} \right]\left[1-\left(-1 \right)^{n_y'} \right]\left[1-\left(-1 \right)^{n_z'} \right]
$$

继续化简：

$$
C_{n_x'n_y'n_z'}\cdot\frac{1 }{8 } 
=T_0\frac{1 }{n_x'n_y'n_z'\pi^3 } \left[1-\left(-1 \right)^{n_x'} \right]\left[1-\left(-1 \right)^{n_y'} \right]\left[1-\left(-1 \right)^{n_z'} \right]
$$

解得系数：

$$
C_{n_x'n_y'n_z'}
=\frac{8 }{n_x'n_y'n_z'\pi^3 } T_0\left[1-\left(-1 \right)^{n_x'} \right]\left[1-\left(-1 \right)^{n_y'} \right]\left[1-\left(-1 \right)^{n_z'} \right]
$$

把下标 $n_x',n_y,n_z' $ 替换为 $n_x,n_y,n_z $：

$$
C_{n_xn_yn_z}
=\frac{8 }{n_xn_yn_z\pi^3 } T_0\left[1-\left(-1 \right)^{n_x} \right]\left[1-\left(-1 \right)^{n_y} \right]\left[1-\left(-1 \right)^{n_z} \right]
$$

综上，定解问题的解 $u(x,y,z,t) $ 为：

$$
\begin{aligned}
u(x,y,z,t)
&=\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} C_{n_xn_yn_z}\exp\left\{-a^2 \left[\left(\frac{n_x\pi }{l_1 } \right)^2 + \left(\frac{n_y\pi }{l_2 } \right)^2 + \left(\frac{n_z\pi }{l_3 } \right)^2 \right]t  \right\}\sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_y\pi y}{l_2 } \right) \sin\left(\frac{n_z\pi z}{l_3 } \right) \\
&=\sum_{n_x=1}^{\infty} \sum_{n_y=1}^{\infty} \sum_{n_z=1}^{\infty} \frac{8 }{n_xn_yn_z\pi^3 } T_0\left[1-\left(-1 \right)^{n_x} \right]\left[1-\left(-1 \right)^{n_y} \right]\left[1-\left(-1 \right)^{n_z} \right]\exp\left\{-a^2 \left[\left(\frac{n_x\pi }{l_1 } \right)^2 + \left(\frac{n_y\pi }{l_2 } \right)^2 + \left(\frac{n_z\pi }{l_3 } \right)^2 \right]t  \right\}\times \\
&\sin\left(\frac{n_x\pi x}{l_1 } \right)\sin\left(\frac{n_y\pi y}{l_2 } \right) \sin\left(\frac{n_z\pi z}{l_3 } \right) \\
\end{aligned}
$$

# 第15章 曲线坐标系下的分离变量

## 球坐标系下方程的分离变量

### 拉普拉斯方程在球坐标系下的分量变量

在球坐标系下，拉普拉斯方程为：

$$
\nabla^2 u(r,\theta,\varphi) = 0
$$

其中，拉普拉斯算子在球坐标系下的表达式为：

$$
\nabla^2
=\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right)+\frac{1}{r^2\sin\theta}\frac{\partial}{\partial \theta}\left(\sin\theta\frac{\partial}{\partial\theta}\right)+\frac{1}{r^2\sin^2\theta}\frac{\partial^2}{\partial \varphi^2}
$$

设 $u(r,\theta,\varphi) $ 可分离变量：

$$
u(r,\theta,\varphi) = R(r)Y(\theta,\varphi) = R(r) \Theta(\theta)\Phi(\varphi)
$$

经过运算，可以得到：

#### 径向方程

径向部分 $R(r) $ 满足**径向方程**：

$$
r^2 \frac{\mathrm{d}^2 R(r) }{\mathrm{d}r^2 } + 2r\frac{\mathrm{d}R(r) }{\mathrm{d}r }-l(l+1) R(r) = 0  
$$

#### 球函数方程

角度部分 $Y(\theta,\varphi) $ 满足**球函数方程**：

$$
\frac{1 }{\sin\theta } \frac{\partial }{\partial \theta } \left(\sin\theta\frac{\partial Y(\theta,\varphi) }{\partial \theta }  \right) + \frac{1 }{\sin^2\theta } \frac{\partial^2 Y(\theta,\varphi) }{\partial \varphi^2 } + l(l+1)Y(\theta,\varphi)
=0
$$

#### 方位角满足的方程

方位角部分 $\Phi(\varphi) $ 满足：

$$
\Phi''(\varphi) + \lambda\Phi(\varphi)
=0
$$

结合周期性边界条件 $\Phi(\varphi+2\pi)=\Phi(\varphi) $ 可得：

$$
\lambda = m^2,~~m=0,\pm 1,\pm 2,\cdots
$$

因此方位角部分满足的方程可写为：

$$
\Phi''(\varphi) + m^2\Phi(\varphi)
=0
$$

#### 连带勒让德方程

极角部分 $\Theta(\theta) $ 满足：

$$
\frac{1 }{\sin\theta }\frac{\mathrm{d} }{\mathrm{d}\theta } \left(\sin\theta\frac{\mathrm{d}\Theta(\theta) }{\mathrm{d}\theta }  \right) + \left[l(l+1)-\frac{m^2 }{\sin^2\theta }  \right] \Theta(\theta)
=0
$$

令 $x=\cos\theta,\Theta(\theta)=y(x),\theta\in[0,\pi],\left|x \right|\leqslant 1,\sin\theta=\sqrt{1-x^2} $，

$$
\frac{\mathrm{d}\Theta }{\mathrm{d}\theta }
=\frac{\mathrm{d}y }{\mathrm{d}x }\frac{\mathrm{d}x }{\mathrm{d}\theta }   
=-\sin\theta\frac{\mathrm{d}y }{\mathrm{d}x } 
$$

则方程可化为**连带勒让德方程**：

$$
(1-x^2)\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } - 2x\frac{\mathrm{d}y }{\mathrm{d}x } + \left[l(l+1)-\frac{m^2 }{1-x^2 }  \right]y
=0  
$$

#### 勒让德方程

若考虑的问题具有极轴对称性，即场量与方位角 $\varphi $ 无关：

$$
u=u(r,\theta)
$$

这对应 $m=0 $，则连带勒让德方程退化为**勒让德方程**：

$$
(1-x^2)\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } - 2x\frac{\mathrm{d}y }{\mathrm{d}x } + l(l+1) y
=0  
$$

### 亥姆霍兹方程在球坐标系下的分离变量

在球坐标系下，亥姆霍兹方程为：

$$
\nabla^2 u(r,\theta,\varphi) + k^2 u(r,\theta,\varphi) = 0
$$

其中，拉普拉斯算子在球坐标系下的表达式为：

$$
\nabla^2
=\frac{1}{r^2}\frac{\partial}{\partial r}\left(r^2\frac{\partial}{\partial r}\right)+\frac{1}{r^2\sin\theta}\frac{\partial}{\partial \theta}\left(\sin\theta\frac{\partial}{\partial\theta}\right)+\frac{1}{r^2\sin^2\theta}\frac{\partial^2}{\partial \varphi^2}
$$

设 $u(r,\theta,\varphi) $ 可分离变量：

$$
u(r,\theta,\varphi) = R(r)Y(\theta,\varphi) = R(r) \Theta(\theta)\Phi(\varphi)
$$

经过运算，可以得到：

#### 球贝塞尔方程

径向部分 $R(r) $ 满足球贝塞尔方程：

$$
\frac{\mathrm{d}^2R }{\mathrm{d}r^2 } + \frac{2 }{r } \frac{\mathrm{d}R }{\mathrm{d}r } + \left[k^2-\frac{l(l+1) }{r^2 }  \right]R
=0 
$$

#### 球函数方程

角度部分 $Y(\theta,\varphi) $ 满足**球函数方程**：

$$
\frac{1 }{\sin\theta } \frac{\partial }{\partial \theta } \left(\sin\theta\frac{\partial Y(\theta,\varphi) }{\partial \theta }  \right) + \frac{1 }{\sin^2\theta } \frac{\partial^2 Y(\theta,\varphi) }{\partial \varphi^2 } + l(l+1)Y(\theta,\varphi)
=0
$$
可见，亥姆霍兹方程解的角度部分满足的方程与拉普拉斯一致。

#### 方位角满足的方程

因此方位角部分满足的方程可写为：

$$
\Phi''(\varphi) + m^2\Phi(\varphi)
=0,~~m=0,\pm 1,\pm 2,\cdots
$$

#### 连带勒让德方程

极角部分 $\Theta(\theta) $ 满足：

$$
\frac{1 }{\sin\theta }\frac{\mathrm{d} }{\mathrm{d}\theta } \left(\sin\theta\frac{\mathrm{d}\Theta(\theta) }{\mathrm{d}\theta }  \right) + \left[l(l+1)-\frac{m^2 }{\sin^2\theta }  \right] \Theta(\theta)
=0
$$

令 $x=\cos\theta,\Theta(\theta)=y(x),\theta\in[0,\pi],\left|x \right|\leqslant 1,\sin\theta=\sqrt{1-x^2} $，

$$
\frac{\mathrm{d}\Theta }{\mathrm{d}\theta }
=\frac{\mathrm{d}y }{\mathrm{d}x }\frac{\mathrm{d}x }{\mathrm{d}\theta }   
=-\sin\theta\frac{\mathrm{d}y }{\mathrm{d}x } 
$$
则方程可化为**连带勒让德方程**：

$$
(1-x^2)\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } - 2x\frac{\mathrm{d}y }{\mathrm{d}x } + \left[l(l+1)-\frac{m^2 }{1-x^2 }  \right]y
=0  
$$

#### 勒让德方程

若考虑的问题具有极轴对称性，即场量与方位角 $\varphi $ 无关：

$$
u=u(r,\theta)
$$

对应 $m=0 $，则连带勒让德方程退化为**勒让德方程**：

$$
(1-x^2)\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } - 2x\frac{\mathrm{d}y }{\mathrm{d}x } + l(l+1) y
=0  
$$

## 柱坐标系下方程的分离变量

### 柱坐标系下亥姆霍兹方程的分离变量

在柱坐标系下，亥姆霍兹方程为：

$$
\nabla^2 u(\rho,\varphi,z) + k^2 u(\rho,\varphi,z) = 0
$$

其中，拉普拉斯算子在柱坐标系下的表达式为：

$$
\nabla^2
=\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2}+\frac{\partial^2}{\partial z^2}
$$

设 $u(\rho,\varphi,z) $ 可分离变量：

$$
u(\rho,\varphi,z) = R(\rho)\Phi(\varphi)Z(z)
$$

经过运算，可以得到：

#### $\Phi(\varphi) $ 满足的方程

$\Phi(\varphi) $ 满足：

$$
\Phi''(\varphi) + \nu^2\Phi(\varphi)
=0,~~\nu\geqslant 0
$$

若不限制 $\varphi $ 的取值范围，而采用周期性边界条件 $\Phi(\varphi+2\pi)=\Phi(\varphi) $ 可得：

$$
\nu
=m,~~m=0, 1, 2,\cdots
$$

> ps：这里为了让 $\nu $ 和 $\nu^2 $ 一一对应，约定 $\nu $ 取非负实数。

#### $Z(z) $ 满足的方程

$$
Z''(z) - \lambda Z(z)
=0
$$

#### $R(\rho) $ 满足的方程及贝塞尔方程

$R(\rho) $ 满足：

$$
\frac{1 }{\rho } \frac{\mathrm{d} }{\mathrm{d}\rho }\left(\rho\frac{\mathrm{d}R(\rho) }{\mathrm{d}\rho }  \right) + \left(k^2+\lambda-\frac{\nu^2 }{\rho^2 }  \right)R(\rho)
=0 
$$

令 $x=\sqrt{k^2+\lambda} \rho,\rho=x/\sqrt{k^2+\lambda},(k^2+\lambda\ne 0),R(\rho)\bigg|_{\rho=x/\sqrt{k^2+\lambda}}\equiv y(x),~~y(x)\bigg|_{x=\sqrt{k^2+\lambda}\rho}=R(\rho) $，则上面方程可化为贝塞尔方程：

$$
\frac{\mathrm{d}^2 y(x) }{\mathrm{d}x^2 } + \frac{1 }{x } \frac{\mathrm{d}y(x) }{\mathrm{d}x } + \left(1-\frac{\nu^2 }{x^2 }  \right) y(x)
=0,~~\nu\geqslant 0
$$

或称为 $\nu $ 阶贝塞尔方程。

# 第16章 球函数

## 勒让德多项式

在球坐标系下，拉普拉斯方程为：

$$
\nabla^2 u(r,\theta,\varphi) = 0
$$

设 $u(r,\theta,\varphi) $ 可分离变量：

$$
u(r,\theta,\varphi) = R(r)\Theta(\theta)\Phi(\varphi)
$$

代入拉普拉斯方程，可得极角部分 $\Theta(\theta) $ 满足：

$$
\frac{1 }{\sin\theta }\frac{\mathrm{d} }{\mathrm{d}\theta } \left(\sin\theta\frac{\mathrm{d}\Theta(\theta) }{\mathrm{d}\theta }  \right) + \left[l(l+1)-\frac{m^2 }{\sin^2\theta }  \right] \Theta(\theta)
=0
$$

令 $x=\cos\theta,\Theta(\theta)=y(x),\theta\in[0,\pi],\left|x \right|\leqslant 1,\sin\theta=\sqrt{1-x^2} $，

$$
\frac{\mathrm{d}\Theta }{\mathrm{d}\theta }
=\frac{\mathrm{d}y }{\mathrm{d}x }\frac{\mathrm{d}x }{\mathrm{d}\theta }   
=-\sin\theta\frac{\mathrm{d}y }{\mathrm{d}x } 
$$

则方程可化为**连带勒让德方程**：

$$
(1-x^2)\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } - 2x\frac{\mathrm{d}y }{\mathrm{d}x } + \left[l(l+1)-\frac{m^2 }{1-x^2 }  \right]y
=0  
$$

若考虑的问题具有极轴对称性，即场量与方位角 $\varphi $ 无关：

$$
u=u(r,\theta)~\mathrm{or}~\Phi(\varphi)=\mathrm{const}
$$

对应 $m=0 $，则连带勒让德方程退化为**勒让德方程**：

$$
(1-x^2)\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } - 2x\frac{\mathrm{d}y }{\mathrm{d}x } + l(l+1) y
=0,~~l=0,1,2,\cdots
$$

利用级数法可以求得，勒让德方程在自变量 $\left|x \right|\leqslant 1 $ 范围内，在自然边界条件 $\left|y(x) \right|<+\infty $ 下，对应于本征值 $l(l+1),~~l=0,1,2,\cdots $ 的本征解为勒让德多项式 $\mathrm{P}_l(x) $：

$$
\mathrm{P}_l(x)
\equiv \sum_{n=0}^{N} \frac{(-1)^n(2l-2n)!}{2^ln!(l-n)!(l-2n)!}x^{l-2n},~~
N
=\left\{
\begin{aligned}
&\frac{l}{2}&,l为偶数 \\
&\frac{l-1}{2}&,l为奇数
\end{aligned}
\right.
$$

即：

$$
\left\{
\begin{aligned}
&\left|x \right|\leqslant 1 \\
&(1-x^2)\frac{\mathrm{d}^2 y_l(x) }{\mathrm{d}x^2 } - 2x\frac{\mathrm{d}y_l(x) }{\mathrm{d}x } + l(l+1) y_l(x)
=0,~~l=0,1,2,\cdots \\
&\left|y_l(x) \right|<1
\end{aligned}
\right.
$$

$$
\Longrightarrow
y_l(x) = \mathrm{P}_l(x),~~
\mathrm{P}_l(x)
\equiv \sum_{n=0}^{N} \frac{(-1)^n(2l-2n)!}{2^ln!(l-n)!(l-2n)!}x^{l-2n},~~
N
=\left\{
\begin{aligned}
&\frac{l}{2}&,l为偶数 \\
&\frac{l-1}{2}&,l为奇数
\end{aligned}
\right.
$$

### 前几个勒让德多项式

$$
\mathrm{P}_0(x)
=1
$$

$$
\mathrm{P}_1(x)
=x
$$

$$
\mathrm{P}_2(x)
=\frac{1}{2}\left(3x^2-1 \right)
$$

$$
\mathrm{P}_3(x)
=\frac{1}{2}\left(5x^3-3x \right)
$$

$$
\mathrm{P}_4(x)
=\frac{1}{8}\left(35x^4-30x^2+3 \right)
$$

$$
\mathrm{P}_5(x)
=\frac{1}{8}\left(63x^5-70x^3+15x \right)
$$

### 勒让德多项式的性质

$$
\mathrm{P}_l(x)
\equiv \sum_{n=0}^{N} \frac{(-1)^n(2l-2n)!}{2^ln!(l-n)!(l-2n)!}x^{l-2n},~~
N
=\left\{
\begin{aligned}
&\frac{l}{2}&,l为偶数 \\
&\frac{l-1}{2}&,l为奇数
\end{aligned}
\right.
$$

$$
\mathrm{P}_l(1)
=1
$$

$$
\mathrm{P}_l(-x)
=(-1)^l \mathrm{P}(x)
$$

#### 罗德里格斯公式（勒让德多项式的微分表达式）

$$
\mathrm{P}_l(x)
=\frac{1}{2^l l! }\frac{\mathrm{d}^l}{\mathrm{d} x^l}\left(x^2-1 \right)^l
$$

#### 勒让德多项式的生成函数（母函数）

定义勒让德多项式的生成函数 $f(r) $ 为：

$$
f(r)
\equiv \frac{1 }{\sqrt{1+r^2-2r\cos\theta} } 
=\frac{1}{\sqrt{1+r^2-2rx}}
$$

其中，$x=\cos\theta,\left|x \right|\leqslant 1 $

当 $r<1 $，可将 $f(r) $ 在 $r=0 $ 处进行泰勒展开，可得：

$$
f(r)
\equiv\frac{1}{\sqrt{1+r^2-2rx}}
=\sum_{l=0}^{\infty} \mathrm{P}_l(x) r^l,~~r<1
$$

或者：

$$
\boxed{
f(r)
\equiv\frac{1}{\sqrt{1+r^2-2r\cos\theta}}
=\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta) r^l,~~r<1
}
$$

当 $r>1,\frac{1 }{r } <1 $，有：

$$
\begin{aligned}
f(r)
&=\frac{1 }{\sqrt{1+r^2-2rx} } \\
&=\frac{1 }{r\sqrt{1+\left(1/r \right)^2 - 2\left(1/r \right)x} } \\
&=\frac{1 }{r }  \sum_{l=0}^{\infty} \mathrm{P}_l(x)\left(\frac{1 }{r }  \right)^l \\
&=\sum_{l=0}^{\infty}\mathrm{P}_l(x)r^{-(l+1)},~~r>1
\end{aligned}
$$

或者：

$$
\boxed{
f(r)
=\frac{1 }{\sqrt{1+r^2-2r\cos\theta} }
=\sum_{l=0}^{\infty}\mathrm{P}_l(\cos\theta)r^{-(l+1)},~~r>1
}
$$

#### 勒让德多项式的递推公式

$$
x(1+2l)\mathrm{P}_l(x)-(l+1)\mathrm{P}_{l+1}(x)-l\mathrm{P}_{l-1}(x)
=0
$$

$$
\mathrm{P}_l(x)
=\mathrm{P}_{l+1}'(x)+\mathrm{P}_{l-1}'(x)-2x\mathrm{P}_l'(x)
$$

$$
(2l+1)\mathrm{P}_l(x)
=\mathrm{P}_{l+1}'(x)-\mathrm{P}_{l-1}'(x)
$$

$$
(l+1)\mathrm{P}_l(x)
=\mathrm{P}_{l+1}'(x)-x\mathrm{P}_{l}'(x)
$$

$$
l\mathrm{P}_{l}(x)
=x\mathrm{P}_{l}'(x)-\mathrm{P}_{l-1}'(x)
$$

$$
\left(x^2-1 \right)\mathrm{P}_{l}'(x)
=lx\mathrm{P}_{l}(x)-l\mathrm{P}_{l-1}(x)
$$

#### 勒让德函数的正交归一性

$\displaystyle{\left\{\sqrt{\frac{2l+1}{2}}\mathrm{P}_l(x),~~l=0,1,2,\cdots \right\} }$ 构成 $[-1,1]$ 上的正交归一函数系，基函数的正交归一性可表达为：

$$
\int_{-1}^{1}\sqrt{\frac{2k+1}{2}}\mathrm{P}_k(x)\cdot\sqrt{\frac{2l+1}{2}}\mathrm{P}_l(x)\mathrm{d}x
=\delta_{kl},~~k,l=0,1,2,c\dots
$$

## 具有轴对称的拉普拉斯方程的求解

拉普拉斯方程：

$$
\nabla^2 u(r,\theta,\varphi) = 0
$$

若求解的问题具有极轴对称性，即场分布与方位角 $\varphi $ 无关：

$$
u=u(r,\theta)
$$

则拉普拉斯方程简化为：

$$
\nabla^2 u(r,\theta) = 0
$$

可以证明，在自然边界条件的要求下，方程的通解为：

$$
u(r,\theta)
=\sum_{l=0}^{\infty} \left(C_l r^l + D_l r^{-(l+1)} \right)\mathrm{P}_l(\cos\theta)
$$

### 例1

> 在单位球的北极点上放置一电荷量为 $4\pi \varepsilon_0$ 的点电荷，求单位球内任一点 $\vec{r} $ 的电势，并用勒让德多项式表示。

由余弦定理知，单位球内 $\vec{r}$ 点离单位球上北极点的距离为：

$$
r'
=\sqrt{1+r^2-2r\cos\theta},~~r<1
$$

单位球内 $\vec{r}$ 点的电势为：

$$
\begin{aligned}
u(\vec{r})
&=\frac{1}{4\pi\varepsilon_0}\frac{q}{r'} \\
&=\frac{1}{4\pi\varepsilon_0}\frac{4\pi\varepsilon_0}{\sqrt{1+r^2-2r\cos\theta}} \\
&=\frac{1}{\sqrt{1+r^2-2r\cos\theta}},~~r<1
\end{aligned}
$$

这恰好是勒让德多项式的生成函数，其可在 $r=0$ 点展开为：

$$
\begin{aligned}
u(\vec{r})
&=\sum_{l=0}^{\infty}\mathrm{P}_l(\cos\theta)r^{l},~~r<1 \\
\end{aligned}
$$

### 例2

> 在半径 $r=r_0$ 的球内求解 $\nabla^2 u=0$，使满足边界条件 $u\bigg|_{r=r_0}=\sin^2\theta$

边界条件与方位角 $\varphi $ 无关，因此所求应也与 $\varphi $ 无关：

$$
\nabla^2 u(r,\theta) = 0
$$

套用结论，轴对称问题的拉普拉斯方程在自然边界条件约束下的形式解为：

$$
u(r,\theta)
=\sum_{l=0}^{\infty}\left(A_l r^l+B_l r^{-(l+1)} \right)\mathrm{P}_l(\cos\theta)
$$

由自然边界条件，球心 $r=0 $ 处场量不应发散：

$$
\left|u(r,\theta) \right|\bigg|_{r=0}<+\infty
$$

因此 $-r^{(l+1)} $ 项必须舍弃，即、：

$$
B_l = 0,~~l=0,1,2,\cdots
$$

于是：

$$
u(r,\theta)
=\sum_{l=0}^{\infty} A_l r^l\mathrm{P}_l(\cos\theta)
$$

考虑边界条件 $u\bigg|_{r=r_0}=\sin^2\theta=1-\cos^2\theta$，注意到：

$$
\left\{
\begin{aligned}
&\mathrm{P}_0(\cos\theta) = 1 \\
&\mathrm{P}_1(\cos\theta) = \cos\theta \\
&\mathrm{P}_2(\cos\theta)= \frac{1 }{2 } \left(3\cos^2\theta-1 \right)
\end{aligned}
\right.
\Longrightarrow 1-\cos^2\theta = \frac{2 }{3 } \left[\mathrm{P}_0(\cos\theta) -\mathrm{P}_2(\cos\theta)\right]
$$

因此：

$$
\sum_{l=0}^{\infty} A_l r_0^l\mathrm{P}_l(\cos\theta)
=\frac{2 }{3 } \left[\mathrm{P}_0(\cos\theta) -\mathrm{P}_2(\cos\theta)\right]
$$

把边界条件整理成各阶勒让德多项式的线性叠加的形式：

$$
\left(A_0-\frac{2 }{3 }  \right)\mathrm{P}_0(\cos\theta) + A_1r_0\mathrm{P}_1(\cos\theta) + \left(A_2r_0^2 + \frac{2 }{3 }  \right)\mathrm{P}_2(\cos\theta) + \sum_{l=3}^{\infty} A_l r_0^l\mathrm{P}_l(\cos\theta)
=0
$$

由各阶勒让德多项式的正交性，它们的线性叠加为零，当且仅当所有线性叠加系数为零，即：

$$
A_0-\frac{2 }{3 } = 0,
A_1 = 0,
A_2 r_0^2 + \frac{2 }{3 }  = 0,
A_3 = A_4 = \cdots = 0
$$

即：

$$
A_0 = \frac{2 }{3 },
A_1 = 0,
A_2 = -\frac{2 }{3r_0^2 },
A_3 = A_4 = \cdots =0  
$$

于是：

$$
\begin{aligned}
u(r,\theta)
&=\sum_{l=0}^{\infty} A_l r^l\mathrm{P}_l(\cos\theta) \\
&=\frac{2 }{3 } - \frac{2 }{3r_0^2 } r^2\mathrm{P}_2(\cos\theta) \\
&=\frac{2 }{3 } - \frac{r^2 }{3r_0^2 } \left(3\cos^2\theta-1 \right)
\end{aligned}
$$

### 例3

> 在均匀电场 $\vec{E}_0 $ 中放一半径为 $a$ 的接地导体球，求球外电势、电场、导体球表面面电荷密度分布。

以球心 $O$ 为坐标原点，选取 $\vec{E}_0 $ 方向为 $z$ 轴正方向，则电势 $u$ 关于 $z$ 轴轴对称。

球外无自由电荷，于是球外电势分布 $u(\vec{r}) $ 满足拉普拉斯方程：

$$
\nabla^2 u(\vec{r}) = 0,~~r>a
$$

特别地，这里电势 $u$ 关于 $z$ 轴对称，$u$ 与 $\varphi$ 无关，拉普拉斯方程可简化为：

$$
\nabla^2 u(r,\theta)
=0,~~r>a
$$

导体球接地，得到一个边界条件：

$$
u(r,\theta)\bigg|_{r=a}
=0
$$

由电势的叠加原理，实际电势 $u(r,\theta)$ 是导体球面上的感应电荷产生的电势和匀强电场 $\vec{E}_0 $ 导致的电势的代数和。把感应电荷在无穷远处产生的电势设为零，则当 $r\to +\infty$，电势只由匀强电场贡献。设匀强电场单独存在时在坐标原点产生的电势为 $u_0$，则：

$$
u_0-u(r,\theta)
=E_0 r\cos\theta,~~r\to +\infty
$$

定解问题为：

$$
\left\{
\begin{aligned}
&\nabla^2 u(r,\theta)
=0 \\
&u(r,\theta)\bigg|_{r=a}
=0 \\
&u(r,\theta)
=u_0-E_0r\cos\theta ,~~r\to +\infty
\end{aligned}
\right.
$$

套用结论，轴对称问题的拉普拉斯方程在自然边界条件约束下的形式解为：

$$
u(r,\theta)
=\sum_{l=0}^{\infty}\left(A_l r^l+B_l r^{-(l+1)} \right)\mathrm{P}_l(\cos\theta)
$$

考虑边界条件 $\displaystyle{u(r,\theta)\bigg|_{r\to +\infty}=u_0-E_0r\cos\theta  }$，当 $r\to+\infty$， 有 $r^{-(l+1)}\to 0$，于是：

$$
\begin{aligned}
u_0-E_0r\cos\theta
&=\sum_{l=0}^{\infty} A_l r^l \mathrm{P}_l(\cos\theta) \\
&=A_0 +A_1r\cos\theta + \cdots
\end{aligned}
$$

左右两边都看作关于 $r $ 的多项式，对比系数得：

$$
A_0
=u_0,~~
A_1=-E_0,~~
A_2=A_3=\cdots=0
$$

于是形式解可写为：

$$
\begin{aligned}
u(r,\theta)
&=\sum_{l=0}^{\infty}\left(A_l r^l+B_l r^{-(l+1)} \right)\mathrm{P}_l(\cos\theta) \\
&=u_0-E_0r\cos\theta+\sum_{l=0}^{\infty}B_l r^{-(l+1)}\mathrm{P}_l(\cos\theta)
\end{aligned}
$$

再考虑边界条件 $\displaystyle{u(r,\theta)\bigg|_{r=a}=0 }$，将形式解代入边界条件，得：

$$
u_0-E_0a\cos\theta+\sum_{l=0}^{\infty}B_l a^{-(l+1)}\mathrm{P}_l(\cos\theta)
=0
$$

即：

$$
u_0\mathrm{P}_0(\cos\theta) - E_0 a\mathrm{P}_1(\cos\theta)+\sum_{l=0}^{\infty}B_l a^{-(l+1)}\mathrm{P}_l(\cos\theta)
=0
$$

整理成各阶勒让德多项式的线性叠加的形式：

$$
\left(u_0+B_0a^{-1} \right)\mathrm{P}_0(\cos\theta) + \left(-E_0 a + B_1a^{-2} \right)\mathrm{P}_1(\cos\theta) + \sum_{l=2}^{\infty} B_la^{-(l+1)}\mathrm{P}_l(\cos\theta)
=0
$$

由各阶勒让德多项式的正交性，它们的线性叠加为零，当且仅当所有线性叠加系数为零，即：

$$
B_0
=-a u_0,~~
B_1
=a^3 E_0,~~
B_2=B_3=\cdots=0
$$

综上，导体球外电势分布为：

$$
\begin{aligned}
u(r,\theta)
&=u_0-E_0r\cos\theta+\sum_{l=0}^{\infty}B_l r^{-(l+1)}\mathrm{P}_l(\cos\theta) \\
&=u_0-E_0r\cos\theta-\frac{u_0 a}{r}+E_0a^3\frac{\cos\theta}{r^2},~~r\geqslant a
\end{aligned}
$$

其中，$u_0$ 为匀强电场单独存在时在坐标原点产生的电势。

取 $u_0=0 $，则导体球外电势分布为：

$$
\boxed{
u(r,\theta)
=-E_0r\cos\theta+E_0a^3\frac{\cos\theta}{r^2}
},~~r\geqslant a
$$

球外电场与电势的关系为：

$$
\begin{aligned}
\vec{E}(\vec{r})
&=-\nabla u(\vec{r}) \\
&=-\left[\frac{\partial u }{\partial r } \vec{\mathrm{e}}_r  + \frac{1 }{r } \frac{\partial u }{\partial \theta } \vec{\mathrm{e}}_\theta + \frac{1 }{r\sin\theta } \frac{\partial u }{\partial \varphi } \vec{\mathrm{e}}_\varphi \right] \\
&=E_0\cos\theta\left(1+\frac{2a^3 }{r^3 } \right) \vec{\mathrm{e}}_r  + E_0\sin\theta\left(\frac{a^3 }{r^3 } - 1 \right)\vec{\mathrm{e}}_\theta,~~r\geqslant a
\end{aligned}
$$

导体表面电场为：

$$
\vec{E}(\vec{r})\bigg|_{r=a}
=3E_0\cos\theta\vec{\mathrm{e}}_r
$$

利用高斯定理，导体球表面面电荷密度分布为：

$$
\sigma(\vec{r})\bigg|_{r=a}
=\varepsilon_0 \vec{E}(\vec{r})\bigg|_{r=a}\cdot \vec{\mathrm{e}}_r
=3\varepsilon_0 E_0\cos\theta 
$$

### 例4

> 半径为 $a$ 的导体球接地，在距球心为 $b$ 的地方放置一点电荷，$b>a$，电荷量为 $q$，求导体球外的电势分布。

选取 $z $ 轴使得点电荷的位矢为 $b\vec{\mathrm{e}}_z $，则球外电势 $u $ 具有 $z $ 轴对称性，即 $u=u(r,\theta) $

点电荷会在接地导体球表面激发出感应电荷。根据电势叠加原理，导体球外的电势 $u $ 是感应电荷单独存在时产生的电势 $u_r $ 与 点电荷单独存在时的电势 $u_q $ 之和：

$$
u = u_r + u_q
$$

考虑点电荷单独存在时在球外产生的电势 $u_q $，由余弦定理，场点 $\vec{r} $ 到点电荷 $q $ 的距离 $r' $ 满足：

$$
r'
=\sqrt{b^2+r^2-2br\cos\theta}
$$

点电荷 $q $ 在 $\vec{r} $ 处产生的电势 $u_q $ 满足：

$$
\begin{aligned}
u_q
&=\frac{1 }{4\pi \varepsilon_0 } \frac{q }{r' } \\
&=\frac{1 }{4\pi\varepsilon_0 } \frac{q }{\sqrt{b^2+r^2-2br\cos\theta} } \\
&=\frac{1 }{4\pi\varepsilon_0 b} \frac{q }{\sqrt{1+\left(r/b \right)^2 - 2 \left(r/b \right)\cos\theta} } ,~~r>a
\end{aligned}
$$

根据勒让德多项式的母函数的相关知识，

$$
\frac{1 }{\sqrt{1+\left(r/b \right)^2 - 2 \left(r/b \right)\cos\theta} }
=\left\{
\begin{aligned}
&\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta)\left(\frac{r }{b }  \right)^l&,~~r/b<1,~~r<b \\
&\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta)\left(\frac{r }{b }  \right)^{-(l+1)}&,~~r/b>1,~~r>b
\end{aligned}
\right.
$$

因此点电荷产生的电势分布 $u_q $ 可展为：

$$
\boxed{
\begin{aligned}
u_q
&=\frac{1 }{4\pi\varepsilon_0 } \frac{q }{\sqrt{b^2+r^2-2br\cos\theta} } \\
&=\frac{q }{4\pi\varepsilon_0 b } \frac{1 }{\sqrt{1+\left(r/b \right)^2 - 2 \left(r/b \right)\cos\theta} } \\
&=\left\{
\begin{aligned}
&\frac{q }{4\pi\varepsilon_0 b }\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta)\left(\frac{r }{b }  \right)^l&&,~~a<r<b \\
&\frac{q }{4\pi\varepsilon_0 b }\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta)\left(\frac{r }{b }  \right)^{-(l+1)}&&,~~r>b
\end{aligned}
\right.
\end{aligned}
}
$$

再考虑感应电荷单独存在时在球外产生的电势 $u_r $，此时球外没有电荷，因此球外的电势分布 $u_r $ 满足拉普拉斯方程：

$$
\nabla^2 u_r(r,\theta)
=0,~~r>a
$$

套用结论，轴对称问题的拉普拉斯方程在自然边界条件约束下的形式解为：

$$
u_r(r,\theta)
=\sum_{l=0}^{\infty}\left(A_l r^l+B_l r^{-(l+1)} \right)\mathrm{P}_l(\cos\theta)
$$

在无穷远处，电势 $u_r $ 应趋于零：

$$
u_r\bigg|_{r\to +\infty} = 0
$$

可得：

$$
A_l = 0,~~l=0,1,2,\cdots
$$

因此：

$$
u_r(r,\theta)
=\sum_{l=0}^{\infty} B_l r^{-(l+1)}\mathrm{P}_l(\cos\theta)
$$

考虑点电荷和感应电荷产生的总电势 $u(r,\theta) $，形式上可写为：

$$
\begin{aligned}
u(r,\theta)
&=u_q(r,\theta) + u_r(r,\theta) \\
&=\left\{
\begin{aligned}
&\frac{q }{4\pi\varepsilon_0 b }\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta)\left(\frac{r }{b }  \right)^l + \sum_{l=0}^{\infty} B_l r^{-(l+1)}\mathrm{P}_l(\cos\theta) &,~~a<r<b \\
&\frac{q }{4\pi\varepsilon_0 b }\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta)\left(\frac{r }{b }  \right)^{-(l+1)} + \sum_{l=0}^{\infty} B_l r^{-(l+1)}\mathrm{P}_l(\cos\theta) &,~~r>b
\end{aligned}
\right.
\end{aligned}
$$

导体球接地给出边界条件：

$$
u(r,\theta)\bigg|_{r=a}
=0
$$

即：

$$
\frac{q }{4\pi\varepsilon_0 b }\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta)\left(\frac{a }{b }  \right)^l + \sum_{l=0}^{\infty} B_l a^{-(l+1)}\mathrm{P}_l(\cos\theta)
=0
$$

整理成以 $\cos\theta $ 为自变量的各阶勒让德多项式 $\mathrm{P}_l(\cos\theta) $ 的线性叠加的形式：

$$
\sum_{l=0}^{\infty} \left(\frac{q a^l}{4\pi\varepsilon_0 b^{l+1} } + B_l a^{-(l+1)} \right) \mathrm{P}_l(\cos\theta)
=0
$$

由各阶勒让德多项式的正交性，可得：

$$
\frac{q a^l}{4\pi\varepsilon_0 b^{l+1} } + B_l a^{-(l+1)}
=0,~~l=0,1,2,\cdots
$$

解得：

$$
B_l
=-\frac{q a^{2l+1}}{4\pi\varepsilon_0 b^{l+1} },~~l=0,1,2,\cdots
$$

因此：

$$
\begin{aligned}
u_r(r,\theta)
&=\sum_{l=0}^{\infty} B_l r^{-(l+1)}\mathrm{P}_l(\cos\theta) \\
&=-\frac{q }{4\pi\varepsilon_0 } \sum_{l=0}^{\infty} \frac{a^{2l+1} }{b^{l+1} }  r^{-(l+1)} \mathrm{P}_l(\cos\theta) \\
&=-\frac{q}{4\pi\varepsilon_0 a} \sum_{l=0}^{\infty} \left(\frac{b r}{a^2 } \right)^{-(l+1)}\mathrm{P}_l(\cos\theta)
\end{aligned}
$$

注意到，$r>a,b>a $，于是有：

$$
\frac{b r }{a^2 } > 1,\quad \frac{1 }{\sqrt{1+\left(br/a^2 \right)^2 - 2\left(br/a^2 \right)\cos\theta} } 
=\sum_{l=0}^{\infty} \mathrm{P}_l(\cos\theta) \left(\frac{br }{a^2 }  \right)^{-(l+1)},\quad \frac{b r }{a^2 } > 1
$$

> ps：注意不到也没事，只不过最终答案可能看起来复杂点。

因此，感应电荷在导体球外产生的电势 $u_r(r,\theta) $ 实际上可写为：

$$
\boxed{
\begin{aligned}
u_r(r,\theta)
&=-\frac{q}{4\pi\varepsilon_0 a} \sum_{l=0}^{\infty} \left(\frac{b r}{a^2 } \right)^{-(l+1)}\mathrm{P}_l(\cos\theta) \\
&=-\frac{q}{4\pi\varepsilon_0 a} \frac{1 }{\sqrt{1+\left(br/a^2 \right)^2 - 2\left(br/a^2 \right)\cos\theta} } ,\quad r>a
\end{aligned}
}
$$

最终得到导体球外的电势分布 $u(r,\theta) $：

$$
\begin{aligned}
u(r,\theta)
&=u_q(r,\theta) + u_r(r,\theta) \\
&=\frac{1 }{4\pi\varepsilon_0 } \frac{q }{\sqrt{b^2+r^2-2br\cos\theta} } - \frac{q}{4\pi\varepsilon_0 a} \frac{1 }{\sqrt{1+\left(br/a^2 \right)^2 - 2\left(br/a^2 \right)\cos\theta} } \\
&=\frac{1 }{4\pi\varepsilon_0 } \frac{q }{\sqrt{b^2+r^2-2br\cos\theta} } + \frac{1}{4\pi\varepsilon_0 } \frac{-aq/b }{\sqrt{\left(a^2/b \right)^2 + r^2 - 2\left(a^2/b \right)r\cos\theta} } \\
\end{aligned}
$$

可以看到，感应电荷在导体球外产生的电势与一个处于 $z $ 轴正半轴距球心 $b'=a^2/b $ 处电荷量为 $Q'=-aq/b $ 的点电荷相同。

# 第17章 柱函数

## 贝塞尔函数

在柱坐标系下，亥姆霍兹方程为：

$$
\nabla^2 u(\rho,\varphi,z) + k^2 u(\rho,\varphi,z) = 0
$$

其中，拉普拉斯算子在柱坐标系下的表达式为：

$$
\nabla^2
=\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2}+\frac{\partial^2}{\partial z^2}
$$

设 $u(\rho,\varphi,z) $ 可分离变量：

$$
u(\rho,\varphi,z) = R(\rho)\Phi(\varphi)Z(z)
$$

经过运算，可以得到：

$\Phi(\varphi) $ 满足：

$$
\Phi''(\varphi) + \nu^2\Phi(\varphi)
=0,~~\nu\geqslant 0
$$

> ps：这里 $\nu\geqslant 0 $ 是约定好的。

若不限制 $\varphi $ 的取值范围，而采用周期性边界条件 $\Phi(\varphi+2\pi)=\Phi(\varphi) $ 可得：

$$
\nu
=m,~~m=0, 1, 2,\cdots
$$

$Z(z) $ 满足：

$$
Z''(z) - \lambda Z(z)
=0
$$

$R(\rho) $ 满足：

$$
\frac{1 }{\rho } \frac{\mathrm{d} }{\mathrm{d}\rho }\left(\rho\frac{\mathrm{d}R(\rho) }{\mathrm{d}\rho }  \right) + \left(k^2+\lambda-\frac{\nu^2 }{\rho^2 }  \right)R(\rho)
=0 
$$

令 $x=\sqrt{k^2+\lambda} \rho,(k^2+\lambda\ne 0),R(\rho)=y(x) $，则上面方程化为贝塞尔方程：

$$
\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } + \frac{1 }{x } \frac{\mathrm{d}y }{\mathrm{d}x } + \left(1-\frac{\nu^2 }{x^2 }  \right) y 
=0
$$

或称为 $\nu $ 阶贝塞尔方程。

### 贝塞尔函数（第一类贝塞尔函数）和诺伊曼函数（第二类贝塞尔函数）

$\nu $ 阶贝塞尔函数，记为 $\mathrm{J}_\nu(x) $，定义为：

$$
\mathrm{J}_\nu(x)
\equiv \sum_{k=0}^{\infty} \frac{\left(-1 \right)^k }{k!\Gamma\left(k+\nu+1 \right) }\left(\frac{x }{2 }  \right)^{2k+\nu} 
$$

> ps：这里的 $\nu\geqslant 0 $ 

将 $\nu $ 替换为 $-\nu $，就得到 $-\nu $ 阶贝塞尔函数：

$$
\mathrm{J}_{-\nu}(x)
\equiv \sum_{k=0}^{\infty} \frac{\left(-1 \right)^k }{k!\Gamma\left(k-\nu+1 \right) }\left(\frac{x }{2 }  \right)^{2k-\nu} 
$$

对 $\mathrm{J}_\nu(x) $ 和 $\mathrm{J}_{-\nu}(x) $ 进行如下的线性组合就得到诺伊曼函数 $\mathrm{N}_\nu(x) $：

$$
\mathrm{N}_\nu(x)
=\frac{\cos\left(\nu\pi \right)\mathrm{J}_\nu(x)-\mathrm{J}_{-\nu}(x) }{\sin(\nu\pi) }
$$

可以看到，若 $\nu $ 为整数 $m $，诺伊曼函数是 $0/0 $ 型的函数，此时其定义由洛必达法则给出：

$$
\begin{aligned}
\mathrm{N}_m(x)
&\equiv \lim_{\nu\to m}\mathrm{N}_\nu(x) \\
&=\lim_{\nu \to m}\frac{\frac{\partial \mathrm{J}_\nu(x) }{\partial \nu }\cos(\nu\pi)  - \pi\sin(\nu\pi)\mathrm{J}_\nu(x) - \frac{\partial \mathrm{J}_{-\nu}(x) }{\partial \nu }  }{\pi\cos\nu\pi } \\
&=\frac{1 }{\pi } \left[\frac{\partial \mathrm{J}_\nu(x) }{\partial \nu }\bigg|_{\nu=m} -\left(-1 \right)^m\frac{\partial \mathrm{J}_{-\nu}(x) }{\partial \nu }\bigg|_{\nu=m}  \right] \\
&=太复杂了不写了
\end{aligned}
$$

其中 $m=0,1,2,\cdots $

$\mathrm{J}_\nu(x) $ 也称第一类贝塞尔函数，$\mathrm{N}_\nu(x) $ 也称第二类贝塞尔函数。

### 贝塞尔方程的通解

#### 非整数阶贝塞尔方程的通解

（非整数）$\nu $ 阶贝塞尔方程

$$
\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } + \frac{1 }{x } \frac{\mathrm{d}y }{\mathrm{d}x } + \left(1-\frac{\nu^2 }{x^2 }  \right) y 
=0,~~\nu>0,~~\nu非整数
$$

的通解为：

$$
y(x)
=C_1\mathrm{J}_\nu(x) + C_2\mathrm{J}_{-\nu}(x)
$$

其中，$C_1,C_2 $ 是非零实数，$\mathrm{J}_\nu(x) $ 和 $\mathrm{J}_{-\nu}(x) $ 分别是（非整数）$\nu $ 阶贝塞尔函数：

$$
\mathrm{J}_{-\nu}(x)
\equiv \sum_{k=0}^{\infty} \frac{\left(-1 \right)^k }{k!\Gamma\left(k-\nu+1 \right) }\left(\frac{x }{2 }  \right)^{2k-\nu} 
$$

$$
\mathrm{J}_\nu(x)
\equiv \sum_{k=0}^{\infty} \frac{\left(-1 \right)^k }{k!\Gamma\left(k+\nu+1 \right) }\left(\frac{x }{2 }  \right)^{2k+\nu} 
$$

#### 整数阶贝塞尔方程的通解

若不限制 $\varphi $ 的取值范围，而采用周期性边界条件 $\Phi(\varphi+2\pi)=\Phi(\varphi) $，可得：

$$
\nu
=m,~~m=0, 1, 2,\cdots
$$

此时贝塞尔方程是（正整数）$m $ 阶贝塞尔方程：

$$
\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } + \frac{1 }{x } \frac{\mathrm{d}y }{\mathrm{d}x } + \left(1-\frac{m^2 }{x^2 }  \right) y 
=0,~~m=0,1,2,\cdots
$$

此时，$m $ 阶贝塞尔方程的通解为：

$$
y(x) = C_1 \mathrm{J}_m(x) + C_2\mathrm{N}_{m}(x)
$$

其中，$C_1,C_2 $ 是任意非零常数，$\mathrm{J}_m(x) $ 称为（正整数）$m $ 阶贝塞尔函数，其定义为：

$$
\mathrm{J}_m(x)
\equiv \sum_{k=0}^{\infty} \frac{\left(-1 \right)^k }{k!\Gamma\left(k+\nu+1 \right) }\left(\frac{x }{2 }  \right)^{2k+\nu}
=\sum_{k=0}^{\infty} \frac{\left(-1 \right)^k }{k!(m+k)! }\left(\frac{x }{2 }  \right)^{2k+\nu}
$$

$\mathrm{N}_m(x) $ 是（正整数）$m $ 阶诺伊曼函数，其表达式就不写了。

## 整数阶贝塞尔函数的简单性质

$$
\mathrm{J}_m(-x) = \left(-1 \right)^m\mathrm{J}_m(x)
$$

$$
\mathrm{J}_0(0) = 1
$$

$$
\mathrm{J}_m(0) = 0,~~m=1,2,\cdots
$$

$$
\mathrm{N}_{-m}(x) = \left(-1 \right)^m \mathrm{N}_m(x)
$$

## 贝塞尔函数的递推关系

$$
\mathrm{J}_{\nu-1}(x) + \mathrm{J}_{\nu+1}(x) = \frac{2\nu }{x } \mathrm{J}_\nu(x)
$$

$$
\mathrm{J}_{\nu-1}(x) - \mathrm{J}_{\nu+1}(x) = 2\mathrm{J}_\nu'(x)
$$

$$
\mathrm{N}_{\nu-1}(x) + \mathrm{N}_{\nu+1}(x) = \frac{2\nu }{x } \mathrm{N}_\nu(x)
$$

$$
\mathrm{N}_{\nu-1}(x) - \mathrm{N}_{\nu+1}(x) = 2\mathrm{N}_\nu'(x)
$$

$$
\mathrm{J}_0'(x) = -\mathrm{J}_1(x)
$$

## 柱函数

若函数 $y_\nu(x) $ 满足：

$$
\left\{
\begin{aligned}
&y_{\nu-1}(x)+y_{\nu+1}(x)
=\frac{2\nu}{x} y_\nu(x) \\
&y_{\nu-1}(x)-y_{\nu+1}(x)
=2y_\nu'(x)
\end{aligned}
\right.
$$

或满足与上两式等价的关系：

$$
\left\{
\begin{aligned}
&\frac{\mathrm{d} }{\mathrm{d}x }\left[x^\nu y_\nu(x) \right]
=x^\nu y_{\nu-1}(x) \\
&\frac{\mathrm{d} }{\mathrm{d}x }\left[x^{-\nu}y_{\nu+1}(x) \right]=x^{-\nu} y_{\nu+1}(x)
\end{aligned}
\right.
$$

则这类函数统称为柱函数。

- 柱函数必定满足贝塞尔方程。

## 例题

### 例1

> 求边缘固定半径为 $b $ 的圆形膜的本征振动频率及本征振动模式。

以圆形膜的圆心为原点建立极坐标，设 $u(\rho,\varphi,t) $ 是 $t $ 时刻 $\rho,\varphi $ 处质点偏离平衡位置的位移，则 $u(\rho,\varphi,t) $ 满足二维波动方程：

$$
u_{tt}(\rho,\varphi,t) - a^2 \nabla^2_{(2)} u(\rho,\varphi,t)
=0
$$

其中，$\nabla^2_{(2)} $ 是二维拉普拉斯算子：

$$
\nabla^2_{(2)}
\equiv \frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2}
$$

设 $u(\rho,\varphi,t) $ 可分离变量为：

$$
u(\rho,\varphi,t)
=U(\rho,\varphi) T(t)
$$

代入二维波动方程可得：

$$
U(\rho,\varphi) T''(t) - a^2 T(t)\left[\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2} \right]U(\rho,\varphi)
=0
$$

上式两边同时除以 $U(\rho,\varphi) T(t) $，再移项，得：

$$
\frac{T''(t) }{T(t) }
=\frac{a^2 }{U(\rho,\varphi) } \left[\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2} \right]U(\rho,\varphi)
$$

注意到，$\displaystyle{\frac{T''(t) }{T(t) } }$ 只与 $t $ 有关，而 $\displaystyle{\frac{a^2 }{U(\rho,\varphi) } \left[\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2} \right]U(\rho,\varphi) }$ 只与 $\rho,\varphi $ 有关，二者相等，因此二者均等于同一常数 $-\omega^2 $ ：

$$
\frac{T''(t) }{T(t) }
=-\omega^2,~~
\frac{a^2 }{U(\rho,\varphi) } \left[\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial }{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2}{\partial \varphi^2} \right]U(\rho,\varphi)
=-\omega^2
$$

由于要求本征振动频率和本征振动模式，因此只需要关注空间部分 $U(\rho,\varphi) $ 满足的方程和边界条件。

对上式空间部分 $U(\rho,\varphi) $ 满足的方程等号两边同乘 $\displaystyle{\frac{U(\rho,\varphi) }{a^2 }  }$ 并移项，得：

$$
\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial U(\rho,\varphi)}{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2 U(\rho,\varphi)}{\partial \varphi^2} + \frac{\omega^2 }{a^2 } U(\rho,\varphi)
=0
$$

令：

$$
k
\equiv \frac{\omega }{a } ,~~k^2=\frac{\omega^2 }{a^2 } 
$$

则 $U(\rho,\varphi) $ 满足的方程为：

$$
\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial U(\rho,\varphi)}{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2 U(\rho,\varphi)}{\partial \varphi^2} + k^2 U(\rho,\varphi)
=0
$$

由于圆形膜边界固定，因此得到一个边界条件：

$$
U(\rho,\varphi)\bigg|_{\rho=b}
=0
$$

且圆心处质点偏离平衡位置的位移应有限，因此得到一个自然边界条件：

$$
\left|U(\rho,\varphi)\right|\bigg|_{\rho=0} 
<+\infty
$$

再结合 $\varphi $ 作为角度这一物理量应使得 $U(\rho,\varphi) $ 满足周期性边界条件：

$$
U(\rho,\varphi+2\pi)
=U(\rho,\varphi)
$$

综上，空间部分 $U(\rho,\varphi) $ 要满足的所有条件为：

$$
\left\{
\begin{aligned}
&\frac{1}{\rho}\frac{\partial}{\partial \rho}\left(\rho\frac{\partial U(\rho,\varphi)}{\partial \rho}\right)+\frac{1}{\rho^2}\frac{\partial^2 U(\rho,\varphi)}{\partial \varphi^2} + k^2 U(\rho,\varphi)
=0 \\
&U(\rho,\varphi)\bigg|_{\rho=b}
=0 \\
&\left|U(\rho,\varphi)\right|\bigg|_{\rho=0} 
<+\infty \\
&U(\rho,\varphi+2\pi)
=U(\rho,\varphi)
\end{aligned}
\right.
$$

设 $U(\rho,\varphi) $ 可分离变量为：

$$
U(\rho,\varphi)
=R(\rho)\Phi(\varphi)
$$

代入空间部分 $U(\rho,\varphi) $ 要满足的方程，得：

$$
\frac{\Phi(\varphi) }{\rho } \frac{\mathrm{d} }{\mathrm{d}\rho }\left(\rho \frac{\mathrm{d}R(\rho) }{\mathrm{d}\rho } \right) + \frac{R(\rho) }{\rho^2 } \frac{\mathrm{d}^2 \Phi(\varphi) }{\mathrm{d}\varphi^2 } + k^2 R(\rho)\Phi(\varphi)
=0
$$

上式等号两边同乘 $\displaystyle{\frac{\rho^2 }{R(\rho)\Phi(\varphi) }  }$，整理得：

$$
\frac{1 }{\Phi(\varphi) } \frac{\mathrm{d}^2\Phi(\varphi) }{\mathrm{d}\varphi^2 }
=-\left[\frac{\rho }{R(\rho) } \frac{\mathrm{d} }{\mathrm{d}\rho }\left(\rho\frac{\mathrm{d}R(\rho) }{\mathrm{d}\rho }  \right) +k^2\rho^2  \right]
$$

上式等号左边只与 $\varphi $ 有关，等号右边只与 $\rho $ 有关，因此二者均等于一个常数 $-m^2 $：

$$
\frac{1 }{\Phi(\varphi) } \frac{\mathrm{d}^2\Phi(\varphi) }{\mathrm{d}\varphi^2 }
=-\left[\frac{\rho }{R(\rho) } \frac{\mathrm{d} }{\mathrm{d}\rho }\left(\rho\frac{\mathrm{d}R(\rho) }{\mathrm{d}\rho }  \right) +k^2\rho^2  \right]
=-m^2
$$

---

因此，角度部分满足方程：

$$
\Phi''(\varphi) + m^2\Phi(\varphi)
=0
$$

周期性边界条件：

$$
U(\rho,\varphi+2\pi)
=U(\rho,\varphi)
\Longrightarrow R(\rho)\Phi(\varphi+2\pi)=R(\rho)\Phi(\varphi)
\Longrightarrow \Phi(\varphi+2\pi)=\Phi(\varphi)
$$

$$
\left\{
\begin{aligned}
&\Phi''(\varphi) + m^2\Phi(\varphi)=0 \\
&\Phi(\varphi+2\pi)=\Phi(\varphi)
\end{aligned}
\right.
$$

从

$$
\Phi''(\varphi) + m^2\Phi(\varphi)
=0
$$

可以解得：

$$
\Phi(\varphi)
=A\cos(m\varphi) + B\sin(m\varphi)
$$

结合周期性边界条件

$$
\Phi(\varphi+2\pi)=\Phi(\varphi)
$$

可得：

$$
m=0,1,2,\cdots
$$

---

径向部分 $R(\rho) $ 满足：

$$
-\left[\frac{\rho }{R(\rho) } \frac{\mathrm{d} }{\mathrm{d}\rho }\left(\rho\frac{\mathrm{d}R(\rho) }{\mathrm{d}\rho }  \right) +k^2\rho^2  \right]
=-m^2
$$

可以整理成：

$$
\frac{1 }{\rho } \frac{\mathrm{d} }{\mathrm{d}\rho }\left(\rho \frac{\mathrm{d}R(\rho) }{\mathrm{d}\rho } \right) + \left(k^2 - \frac{m^2 }{\rho^2 }  \right)R(\rho)
=0
$$

令 $x=k\rho,\rho=x/k,R(\rho)\bigg|_{\rho=x/k}=R(x/k)\equiv y(x) $，则上面可方程化为 $m $ 阶贝塞尔方程：

$$
\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } + \frac{1 }{x } \frac{\mathrm{d}y }{\mathrm{d}x } + \left(1-\frac{m^2 }{x^2 }  \right)y
=0 
$$

$$
U(\rho,\varphi)\bigg|_{\rho=b}
=0
\Longrightarrow R(\rho)\Phi(\varphi) \bigg|_{\rho=b} = 0
\Longrightarrow R(\rho)\bigg|_{\rho=b} = 0
$$

$$
\left|U(\rho,\varphi)\right|\bigg|_{\rho=0} 
<+\infty
\Longrightarrow \left|R(\rho)\Phi(\varphi) \right|\bigg|_{\rho=0}<+\infty
\Longrightarrow \left|R(\rho) \right|\bigg|_{\rho=0}<+\infty
$$

$$
\left\{
\begin{aligned}
&\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } + \frac{1 }{x } \frac{\mathrm{d}y }{\mathrm{d}x } + \left(1-\frac{m^2 }{x^2 }  \right)y
=0 \\
&y(x)\equiv R(\rho)\bigg|_{\rho=x/k}=R(x/k),~~R(\rho)=y(x)\bigg|_{x=k\rho}=y(k\rho)\\
&R(\rho)\bigg|_{\rho=b} = 0 \\
&\left|R(\rho) \right|\bigg|_{\rho=0}<+\infty
\end{aligned}
\right.
$$

对于 $m $ 阶贝塞尔方程

$$
\frac{\mathrm{d}^2 y }{\mathrm{d}x^2 } + \frac{1 }{x } \frac{\mathrm{d}y }{\mathrm{d}x } + \left(1-\frac{m^2 }{x^2 }  \right)y
=0
$$

其通解为：

$$
y^{(m)}(x)
=C_m \mathrm{J}_m(x) + D_m\mathrm{N}_m(x)
$$

考虑自然边界条件 $\displaystyle{\left|R(\rho) \right|\bigg|_{\rho=0}<+\infty }$，可得：

$$
D_m=0
$$

因此：

$$
y^{(m)}(x)
=C_m\mathrm{J}_m(x)
$$

对上面等式两边同取附加条件：

$$
y^{(m)}(x)\bigg|_{x=k\rho}
=C_m\mathrm{J}_m(x)\bigg|_{x=k\rho}
$$

结合 $x=k\rho,R(\rho)=y(x)\bigg|_{x=k\rho}=y(k\rho) $ 可得：

$$
R^{(m)}(\rho)
=C_m\mathrm{J}_m(k\rho)
$$

设 $m $ 阶贝塞尔函数 $\mathrm{J}_m(x) $ 的第 $n $ 个正零点为 $x_n^{(m)} $，即：

$$
\mathrm{J}_m\left(x_n^{(m)} \right)
=0,~~m=0,1,2,\cdots;~~n=,1,2,\cdots
$$

结合边界条件 $\displaystyle{R(\rho)\bigg|_{\rho=b} = 0 }$，即：

$$
C_m\mathrm{J}_m\left(k b \right)
=0
$$

因此 $k $ 的本征值 $k_n^{(m)} $ 为：

$$
k_n^{(m)}
=\frac{x_n^{(m)} }{b } ,~~m=0,1,2,\cdots;~~n=1,2,\cdots
$$

相应的本征振动模式 $R_n^{(m)}(\rho) $ 为：

$$
R_n^{(m)}(\rho)
=\mathrm{J}_m\left(k_n^{(m)}\rho \right)
=\mathrm{J}_m\left(\frac{x_n^{(m)} }{b } \rho \right),~~m=0,1,2,\cdots;~~n=1,2,\cdots
$$

再根据 $k\equiv \omega/a $，得到 $\omega $ 的本征值，即圆形膜的本征频率 $\omega_n^{(m)} $ 为：

$$
\omega_n^{(m)}
=ak_n^{(m)}
=\frac{x_n^{(m)} }{b }\cdot a,~~m=0,1,2,\cdots;~~n=1,2,\cdots
$$

综上所述，边缘固定半径为 $b $ 的圆形膜的本征振动频率 $\omega_n^{(m)} $ 及本征振动模式 $R_n^{(m)}(\rho) $ 为：

$$
\boxed{
\omega_n^{(m)} = \frac{x_n^{(m)} }{b }\cdot a
},~~m=0,1,2,\cdots;~~n=1,2,\cdots
$$

$$
\boxed{
R_n^{(m)}(\rho)
=\mathrm{J}_m\left(\frac{x_n^{(m)} }{b } \rho \right)
},~~m=0,1,2,\cdots;~~n=1,2,\cdots
$$

其中，$x_n^{(m)} $ 是 $m $ 阶贝塞尔函数 $\mathrm{J}_m(x) $ 的第 $n $ 个正零点。

# 第18章 格林函数法

# 第19章 其他方程求解

# 第20章 非线性数学物理方程初步

# 第21章 泛函的变分

# 第22章 变分原理